(self.webpackChunkskyline_console=self.webpackChunkskyline_console||[]).push([[217],{529:(e,t,a)=>{"use strict";var r=a(33950),l=a(48924);r(t,"__esModule",{value:!0}),t.default=void 0;var i=l(a(72097)),n=l(a(31400)),o=l(a(87361)),u=l(a(3161)),s={rowActions:{firstAction:o.default,moreActions:[{action:u.default},{action:n.default}]},batchActions:[n.default],primaryActions:[i.default]};t.default=s},3161:(e,a,r)=>{"use strict";var l=r(18565),i=r(13696),n=r(3787),o=r(10732),u=r(32462),s=r(10819),d=r(22338),c=r(33950),f=r(48924);c(a,"__esModule",{value:!0}),a.default=a.ManageUser=void 0;var m=f(r(32462)),p=f(r(60147)),h=f(r(24836)),v=f(r(89195)),g=f(r(1839)),b=f(r(77879)),y=r(87067),j=r(61362),_=r(53884),D=r(60615),C=r(64562);function S(e,t){var a=l(e);if(i){var r=i(e);t&&(r=n(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?u(a=S(Object(l),!0)).call(a,(function(t){(0,b.default)(e,t,l[t])})):s?d(e,s(l)):u(r=S(Object(l))).call(r,(function(t){c(e,t,o(l,t))}))}return e}class R extends D.ModalAction{constructor(){var e;super(...arguments),e=this,(0,b.default)(this,"onSubmit",function(){var t=(0,g.default)((function*(t){var a,{select_user:r}=t,{id:l}=e.item,i=[];return(0,m.default)(a=e.groupUsers).call(a,(t=>{-1===(0,p.default)(r).call(r,t)&&i.push(e.store.deleteGroupUsers({id:l,userId:t}))})),(0,m.default)(r).call(r,(t=>{var a;-1===(0,p.default)(a=e.groupUsers).call(a,t)&&i.push(e.store.addGroupUsers({id:l,userId:t}))})),yield h.default.all(i)}));return function(e){return t.apply(this,arguments)}}())}get name(){return t("Manage user")}static get modalSize(){return"large"}getModalSize(){return"large"}init(){var e=this;return(0,g.default)((function*(){e.state.groupUsers=[],e.store=new _.GroupStore,e.userStore=new j.UserStore,e.getGroupUsers(),e.getAllUser()}))()}getAllUser(){this.userStore.fetchList({withProjectRole:!1,withSystemRole:!1})}getGroupUsers(){var e=this;return(0,g.default)((function*(){yield e.store.fetchGroupUsers(e.item),e.setState({groupUsers:e.groupUsers}),e.updateDefaultValue()}))()}get userList(){var e=this.userStore.list.data||[];return(0,v.default)(e).call(e,(e=>x(x({},e),{},{key:e.id})))}get groupUsers(){var e;return(0,v.default)(e=this.store.groupUsers||[]).call(e,(e=>e.id))}get leftUserTable(){return C.userDomainColumns}get rightUserTable(){return C.userDomainColumns}get defaultValue(){var{name:e,domainName:t}=this.item;return{name:e,domain:t,select_user:this.groupUsers}}get formItems(){return[{name:"name",type:"label",label:t("Name"),iconType:"group"},{name:"domain",type:"label",label:t("Domain")},{name:"select_user",type:"transfer",label:t("User"),leftTableColumns:this.leftUserTable,rightTableColumns:this.rightUserTable,dataSource:this.userList,disabled:!1,showSearch:!0,filterOption:C.transferFilterOption,loading:this.userStore.list.isLoading}]}}a.ManageUser=R,(0,b.default)(R,"id","manage-user"),(0,b.default)(R,"title",t("Manage User")),(0,b.default)(R,"policy",["identity:list_users_in_group","identity:list_users_in_group","identity:add_user_to_group"]),(0,b.default)(R,"allowed",(()=>h.default.resolve(!0)));a.default=(0,y.inject)("rootStore")((0,y.observer)(R))},3292:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.Detail=void 0;var n=r(87067),o=r(52740),u=i(r(19585)),s=r(64562),d=i(r(12578)),c=i(r(47104)),f=i(r(43087)),m=i(r(94092));class p extends u.default{get name(){return t("project")}get policy(){return"identity:list_projects"}get listUrl(){return this.getRoutePath("project")}get actionConfigs(){return m.default}init(){this.store=new o.ProjectStore}get forceLoadingTabs(){return["quota"]}get detailInfos(){return[{title:t("Project Name"),dataIndex:"name"},s.enabledColumn,{title:t("Affiliated Domain"),dataIndex:"domainName"},{title:t("User Num"),dataIndex:"userCount"},{title:t("User Group Num"),dataIndex:"groupCount"},{title:t("Tags"),dataIndex:"tags",render:e=>e.join(",")},{title:t("Description"),dataIndex:"description"}]}get tabs(){return[{title:t("Project Users"),key:"user",component:c.default},{title:t("Project User Groups"),key:"userGroup",component:d.default},{title:t("Project Quota"),key:"quota",component:f.default}]}}a.Detail=p;a.default=(0,n.inject)("rootStore")((0,n.observer)(p))},4418:(e,a,r)=>{"use strict";var l=r(18565),i=r(13696),n=r(3787),o=r(10732),u=r(32462),s=r(10819),d=r(22338),c=r(33950),f=r(48924);c(a,"__esModule",{value:!0}),a.default=a.ManageUser=void 0;var m=f(r(89195)),p=f(r(32462)),h=f(r(18565)),v=f(r(29672)),g=f(r(24836)),b=f(r(58239)),y=f(r(1839));r(23153);var j=f(r(47983)),_=f(r(77879)),D=f(r(23872)),C=r(87067),S=(r(77800),f(r(52740))),x=r(61362),R=r(77969),I=r(60615),w=r(64562),P=r(80726);function U(e,t){var a=l(e);if(i){var r=i(e);t&&(r=n(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?u(a=U(Object(l),!0)).call(a,(function(t){(0,_.default)(e,t,l[t])})):s?d(e,s(l)):u(r=U(Object(l))).call(r,(function(t){c(e,t,o(l,t))}))}return e}class k extends I.ModalAction{constructor(){var e;super(...arguments),e=this,(0,_.default)(this,"userRolesList",(e=>{var t;return(0,m.default)(t=this.projectRoleList).call(t,(t=>({label:t.name,value:t.id,key:t.id,user_id:e})))})),(0,_.default)(this,"defaultRoles",(e=>{var t,{users:a}=this.item;return a[e]?(0,m.default)(t=a[e]).call(t,(e=>e.id)):[this.projectRoleList[0].id]})),(0,_.default)(this,"onClickSelect",(e=>{e&&e.stopPropagation&&e.stopPropagation()})),(0,_.default)(this,"renderSelect",(e=>D.default.createElement(j.default,{size:"small",mode:"multiple",options:this.userRolesList(e),defaultValue:this.defaultRoles(e),filterOption:P.roleFilterOption,onChange:(t,a)=>{this.onSelectChange(t,a,e)},onClick:this.onClickSelect}))),(0,_.default)(this,"onSelectChange",((e,t,a)=>{var{userRoles:r}=this.state;e.length&&t.length?r[a]=e:r[a]=[],this.setState({userRoles:r})})),(0,_.default)(this,"onChangeUser",(e=>{var t,a,{userRoles:r}=this.state;(0,p.default)(t=e||[]).call(t,(e=>{r[e]||(r[e]=this.defaultRoles(e))})),(0,p.default)(a=(0,h.default)(r)).call(a,(t=>{var a;(0,v.default)(a=e||[]).call(a,t)||delete r[t]})),this.setState(r)})),(0,_.default)(this,"onSubmit",(0,y.default)((function*(){var t,a,{userRoles:r}=e.state,{id:l}=e.item,i=e.getInitRoleMap(),n=[];return(0,p.default)(t=(0,h.default)(i)).call(t,(e=>{var t;(0,p.default)(t=i[e]||[]).call(t,(t=>{var a=r[e]||[];(0,v.default)(a).call(a,t)||n.push(S.default.removeUserRole({id:l,userId:e,roleId:t}))}))})),(0,p.default)(a=(0,h.default)(r)).call(a,(e=>{var t,a=i[e]||[];(0,p.default)(t=r[e]).call(t,(t=>{(0,v.default)(a).call(a,t)||n.push(S.default.assignUserRole({id:l,userId:e,roleId:t}))}))})),yield g.default.all(n)})))}get name(){return t("Manage user")}init(){var e=this;return(0,y.default)((function*(){e.state.userRoles=e.getInitRoleMap(),e.store=new R.RoleStore,e.userStore=new x.UserStore,e.getRoleList(),e.getUser()}))()}getRoleList(){return this.store.fetchList()}getUser(){this.userStore.fetchList({withProjectRole:!1,withSystemRole:!1})}getInitRoleMap(){var e,{users:t={}}=this.item;return(0,b.default)(e=(0,h.default)(t)).call(e,((e,a)=>{var r;return e[a]=(0,m.default)(r=t[a]).call(r,(e=>e.id)),e}),{})}static get modalSize(){return"large"}getModalSize(){return"large"}get labelCol(){return{xs:{span:4},sm:{span:2}}}get wrapperCol(){return{xs:{span:20},sm:{span:20}}}get userList(){var e=this.userStore.list.data||[];return(0,m.default)(e).call(e,(e=>N(N({},e),{},{key:e.id})))}get projectRoleList(){return this.store.list.data||[]}get leftUserTable(){return w.userDomainColumns}get rightUserTable(){return[...w.userDomainColumns,{title:t("Select Project Role"),dataIndex:"id",render:e=>this.renderSelect(e)}]}get defaultValue(){var{name:e,domainName:t}=this.item;return{name:e,domain:t}}get formItems(){var{users:e}=this.item;return[{name:"name",type:"label",label:t("Name"),iconType:"project"},{name:"domain",type:"label",label:t("Domain")},{name:"select_user",type:"transfer",label:t("User"),leftTableColumns:this.leftUserTable,rightTableColumns:this.rightUserTable,dataSource:this.userList,showSearch:!0,oriTargetKeys:e?(0,h.default)(e):[],onChange:this.onChangeUser,filterOption:w.transferFilterOption,wrapperCol:this.wrapperCol,loading:this.userStore.list.isLoading}]}}a.ManageUser=k,(0,_.default)(k,"id","management-user"),(0,_.default)(k,"title",t("Manage User")),(0,_.default)(k,"policy",["identity:create_grant","identity:revoke_grant"]),(0,_.default)(k,"allowed",(()=>g.default.resolve(!0)));a.default=(0,C.inject)("rootStore")((0,C.observer)(k))},5143:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=void 0;var n=i(r(77879)),o=r(60615),u=i(r(61362));class s extends o.ConfirmAction{constructor(){super(...arguments),(0,n.default)(this,"policy","identity:update_user"),(0,n.default)(this,"allowedCheckFunc",(e=>!e||this.isEnable(e))),(0,n.default)(this,"onSubmit",(()=>{var{id:e}=this.item;return u.default.enable({id:e})}))}get id(){return"Enable"}get title(){return t("Enable User")}get buttonText(){return t("Enable")}get actionName(){return t("Enable User")}isEnable(e){return!e.enabled}}a.default=s},7221:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.Create=void 0;var n=i(r(24836)),o=i(r(77879)),u=r(87067),s=i(r(77969)),d=r(60615);class c extends d.ModalAction{constructor(){super(...arguments),(0,o.default)(this,"onSubmit",(e=>this.store.create(e)))}init(){this.store=s.default}static allowed(){return n.default.resolve(!0)}get name(){return t("Create Role")}get formItems(){return[{name:"name",label:t("Name"),type:"input",placeholder:t("Please input name"),required:!0},{name:"description",label:t("Description"),type:"textarea"}]}}a.Create=c,(0,o.default)(c,"id","role-create"),(0,o.default)(c,"title",t("Create Role")),(0,o.default)(c,"policy","identity:create_role");a.default=(0,u.inject)("rootStore")((0,u.observer)(c))},9817:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.Domains=void 0;var n=i(r(77879)),o=r(87067),u=i(r(54017)),s=i(r(35613)),d=r(64562),c=i(r(74117));class f extends u.default{constructor(){super(...arguments),(0,n.default)(this,"getColumns",(()=>[{title:t("Domain ID/Name"),dataIndex:"name",routeName:"domainDetailAdmin"},{title:t("Project Num"),dataIndex:"projectCount",isHideable:!0},{title:t("User Num"),dataIndex:"userCount",isHideable:!0},{title:t("User Group Num"),dataIndex:"groupCount",isHideable:!0},d.enabledColumn,{title:t("Description"),dataIndex:"description",isHideable:!0}]))}init(){this.store=s.default}get policy(){return"identity:list_domains"}get name(){return t("domains")}get isFilterByBackend(){return!1}get actionConfigs(){return c.default}get searchFilters(){return[{label:t("Domain Name"),name:"name"}]}}a.Domains=f;a.default=(0,o.inject)("rootStore")((0,o.observer)(f))},10922:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.EditForm=void 0;var n=i(r(24836)),o=i(r(68982)),u=i(r(19989)),s=i(r(77879)),d=r(87067),c=r(60615),f=i(r(52740));class m extends c.ModalAction{constructor(){super(...arguments),(0,s.default)(this,"checkName",((e,a)=>{if(!a)return n.default.reject(t("Please input"));var{list:{data:r}}=this.store;return(0,o.default)(r).call(r,(e=>e.name===a&&e.id!==this.item.id&&e.domain_id===this.item.domain_id))?n.default.reject(t("Invalid: Project names in the domain can not be repeated")):n.default.resolve()})),(0,s.default)(this,"onSubmit",(e=>{var{description:t,name:a}=e,{id:r}=this.item;return f.default.edit({id:r,description:t,name:a})}))}init(){this.store=f.default,this.store.fetchList()}static allowed(){return n.default.resolve(!0)}get name(){var e,{name:a}=this.item;return(0,u.default)(e="".concat(t("Edit")," ")).call(e,a)}get defaultValue(){var{name:e,description:t,enabled:a}=this.item;return{name:e,description:t,enabled:a}}get formItems(){return[{name:"name",label:t("Name"),type:"input",value:this.item.name,validator:this.checkName,extra:t("Project")+t("Name can not be duplicated")},{name:"description",label:t("Description"),type:"textarea"}]}}a.EditForm=m,(0,s.default)(m,"id","project-edit"),(0,s.default)(m,"title",t("Edit")),(0,s.default)(m,"policy","identity:update_project");a.default=(0,d.inject)("rootStore")((0,d.observer)(m))},12551:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.Detail=void 0;var n=r(87067),o=r(53884),u=i(r(19585)),s=i(r(47104)),d=i(r(18672)),c=i(r(529));class f extends u.default{get name(){return t("user group")}get policy(){return"identity:get_group"}get listUrl(){return this.getRoutePath("userGroup")}get actionConfigs(){return c.default}init(){this.store=new o.GroupStore}get detailInfos(){return[{title:t("User Group Name"),dataIndex:"name"},{title:t("Affiliated Domain"),dataIndex:"domain",render:(e,t)=>(e||{}).name||t.domain_id},{title:t("User Num"),dataIndex:"userCount"},{title:t("Description"),dataIndex:"description"}]}get tabs(){return[{title:t("Subordinate Projects"),key:"project",component:d.default},{title:t("Sub Users"),key:"user",component:s.default}]}}a.Detail=f;a.default=(0,n.inject)("rootStore")((0,n.observer)(f))},12578:(e,a,r)=>{"use strict";var l=r(18565),i=r(13696),n=r(3787),o=r(10732),u=r(32462),s=r(10819),d=r(22338),c=r(33950),f=r(71742),m=r(48924);c(a,"__esModule",{value:!0}),a.default=a.UserGroups=void 0;var p=m(r(29672)),h=m(r(89195)),v=m(r(18565)),g=m(r(19989)),b=m(r(3787));r(88260);var y=m(r(86482)),j=m(r(77879)),_=m(r(71573)),D=m(r(23872)),C=r(87067),S=m(r(54017)),x=function(e,t){if("function"==typeof f)var a=new f,r=new f;return function(e,t){if(!t&&e&&e.__esModule)return e;var l,i,n={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return n;if(l=t?r:a){if(l.has(e))return l.get(e);l.set(e,n)}for(var u in e)"default"!==u&&{}.hasOwnProperty.call(e,u)&&((i=(l=c)&&o(e,u))&&(i.get||i.set)?l(n,u,i):n[u]=e[u]);return n}(e,t)}(r(53884)),R=(r(77800),r(53434)),I=m(r(529));function w(e,t){var a=l(e);if(i){var r=i(e);t&&(r=n(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}class P extends S.default{constructor(){super(...arguments),(0,j.default)(this,"updateFetchParams",(e=>{var{match:t}=this.props,{id:a}=t.params||{},r=function(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?u(a=w(Object(l),!0)).call(a,(function(t){(0,j.default)(e,t,l[t])})):s?d(e,s(l)):u(r=w(Object(l))).call(r,(function(t){c(e,t,o(l,t))}))}return e}({},e);return this.inUserDetail?r.userId=a:this.inProjectDetail?r.projectId=a:this.inRoleDetail?r.roleId=a:this.inDomainDetail&&(r.domainId=a),r}))}init(){this.store=this.inDetailPage?new x.GroupStore:x.default}get policy(){return"identity:list_groups"}get name(){return t("user groups")}get isFilterByBackend(){return!1}get inUserDetail(){var e;return this.inDetailPage&&(0,p.default)(e=this.path).call(e,"user-admin/detail")}get inDomainDetail(){var e;return this.inDetailPage&&(0,p.default)(e=this.path).call(e,"domain-admin/detail")}get inProjectDetail(){var e;return this.inDetailPage&&(0,p.default)(e=this.path).call(e,"project-admin/detail")}get inRoleDetail(){var e;return this.inDetailPage&&(0,p.default)(e=this.path).call(e,"role-admin/detail")}getBaseColumns(){return[{title:t("User Group ID/Name"),dataIndex:"name",routeName:"userGroupDetailAdmin"},{title:t("Project Scope (Project Name: Role Names)"),dataIndex:"projects",isHideable:!0,width:500,render:e=>{var t;return(0,_.default)(e)?"-":(0,h.default)(t=(0,v.default)(e)).call(t,(t=>{var{project:a,roles:r}=e[t],l=(0,h.default)(r).call(r,(e=>e.name)).join(", "),{id:i,name:n}=a,o=this.getLinkRender("projectDetail",n,{id:i},{tab:"userGroup"});return D.default.createElement("div",{key:t},D.default.createElement(y.default.Text,{strong:!0},o),": ",l)}))},stringify:e=>{var t;return(0,_.default)(e)?"-":(0,h.default)(t=(0,v.default)(e)).call(t,(t=>{var a,{project:r,roles:l}=e[t],i=(0,h.default)(l).call(l,(e=>e.name)).join("|");return(0,g.default)(a="".concat(r.name,": ")).call(a,i)})).join(";")}},{title:t("Roles"),dataIndex:"rolesInProjectDetailPage",isHideable:!0,render:(e,t)=>{var a,{projects:r={}}=t;return(0,_.default)(r)?"-":(0,h.default)(a=(0,v.default)(r)).call(a,(e=>{var{roles:t}=r[e];return(0,h.default)(t).call(t,(e=>{var{id:t,name:a}=e,r=this.getLinkRender("roleDetail",a,{id:t},{tab:"group"});return D.default.createElement("div",{key:t},r)}))}))},stringify:(e,t)=>{var a,{projects:r={}}=t;return(0,_.default)(r)?"-":(0,h.default)(a=(0,v.default)(r)).call(a,(e=>{var{roles:t}=r[e];return(0,h.default)(t).call(t,(e=>e.name)).join(";")}))}},{title:t("Project Scope"),dataIndex:"projectsInRoleDetailPage",isHideable:!0,render:(e,t)=>{var a,{projects:r={}}=t;return(0,_.default)(r)?"-":(0,h.default)(a=(0,v.default)(r)).call(a,(e=>{var{project:t}=r[e],{id:a,name:l}=t,i=this.getLinkRender("projectDetail",l,{id:a},{tab:"userGroup"});return D.default.createElement("div",{key:a},i)}))},stringify:(e,t)=>{var a,{projects:r={}}=t;return(0,_.default)(r)?"-":(0,h.default)(a=(0,v.default)(r)).call(a,(e=>{var{project:t}=r[e];return t.name})).join(";")}},{title:t("Affiliated Domain"),dataIndex:"domainName",isHideable:!0},{title:t("Description"),dataIndex:"description",isHideable:!0}]}getColumns(){var e=this.getBaseColumns();return!this.inDetailPage||this.inUserDetail?(0,b.default)(e).call(e,(e=>{var t;return!(0,p.default)(t=["rolesInProjectDetailPage","projectsInRoleDetailPage"]).call(t,e.dataIndex)})):this.inDomainDetail?(0,b.default)(e).call(e,(e=>{var t;return!(0,p.default)(t=["domainName","rolesInProjectDetailPage","projectsInRoleDetailPage"]).call(t,e.dataIndex)})):this.inProjectDetail?(0,b.default)(e).call(e,(e=>{var t;return!(0,p.default)(t=["projects","projectsInRoleDetailPage"]).call(t,e.dataIndex)})):this.inRoleDetail?(0,b.default)(e).call(e,(e=>{var t;return!(0,p.default)(t=["projects","rolesInProjectDetailPage"]).call(t,e.dataIndex)})):e}get actionConfigs(){return this.inDetailPage?R.emptyActionConfig:I.default}get searchFilters(){var e=this.inDomainDetail?[]:[{label:t("Domain Name"),name:"domainName"}];return[{label:t("User Group Name"),name:"name"},...e]}}a.UserGroups=P;a.default=(0,C.inject)("rootStore")((0,C.observer)(P))},15228:(e,t,a)=>{"use strict";var r=a(33950),l=a(48924);r(t,"__esModule",{value:!0}),t.default=void 0;var i=l(a(35910)),n=l(a(36979)),o=l(a(23290)),u=l(a(5143)),s=l(a(51355)),d=l(a(64893)),c=l(a(21697)),f=l(a(92322)),m={rowActions:{firstAction:o.default,moreActions:[{action:d.default},{action:f.default},{action:c.default},{action:n.default},{action:u.default},{action:s.default}]},batchActions:[n.default],primaryActions:[i.default]};t.default=m},15523:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.BaseDetail=void 0;var n=i(r(89195)),o=i(r(23872)),u=r(87067),s=i(r(42181));class d extends s.default{get leftCards(){return[this.roleCard]}get roleCard(){var e=[{label:t("Roles"),dataIndex:"implies",render:e=>e&&e.length?(0,n.default)(e).call(e,(e=>{var{id:t,name:a}=e,r=this.getLinkRender("roleDetail",a,{id:t});return o.default.createElement("div",{key:t},r)})):"-"}];return{title:t("Implied Roles"),options:e}}}a.BaseDetail=d;a.default=(0,u.inject)("rootStore")((0,u.observer)(d))},17987:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=void 0;var n=i(r(77879)),o=i(r(23872)),u=r(60615),s=i(r(52740));class d extends u.ConfirmAction{constructor(){super(...arguments),(0,n.default)(this,"policy","identity:delete_project"),(0,n.default)(this,"submitErrorMsg",((e,a)=>{var r=this.getName(e);return 400===a.status&&a.reason&&403===a.reason.code&&/^Resource(.*?)exists$/.test(a.reason.message)?t("There are resources under the project and cannot be deleted."):t("Unable to {action} {name}.",{action:this.actionName||this.title,name:r})})),(0,n.default)(this,"confirmContext",(e=>{var a=this.getName(e);return o.default.createElement("div",null,o.default.createElement("div",null,t("Are you sure to {action} (instance: {name})?",{action:this.actionNameDisplay||this.title,name:a})),o.default.createElement("div",null,t("Before deleting the project, it is recommended to clean up the resources under the project.")))})),(0,n.default)(this,"onSubmit",(e=>{var{id:t}=e;return s.default.delete({id:t})}))}get id(){return"delete"}get title(){return t("Delete Project")}get isDanger(){return!0}get buttonText(){return t("Delete")}get actionName(){return t("delete project")}}a.default=d},18672:(e,a,r)=>{"use strict";var l=r(18565),i=r(13696),n=r(3787),o=r(10732),u=r(32462),s=r(10819),d=r(22338),c=r(33950),f=r(71742),m=r(48924);c(a,"__esModule",{value:!0}),a.default=a.Projects=void 0;var p=m(r(32462)),h=m(r(18565)),v=m(r(3787)),g=m(r(29672)),b=m(r(68982)),y=m(r(89195)),j=m(r(19989)),_=m(r(75613));r(49986);var D=m(r(28328)),C=m(r(77879)),S=m(r(23872)),x=r(87067),R=(r(77800),m(r(54017))),I=M(r(52740)),w=r(53434),P=r(92325),U=r(64562),N=M(r(94092)),k=m(r(84939));function M(e,t){if("function"==typeof f)var a=new f,r=new f;return(M=function(e,t){if(!t&&e&&e.__esModule)return e;var l,i,n={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return n;if(l=t?r:a){if(l.has(e))return l.get(e);l.set(e,n)}for(var u in e)"default"!==u&&{}.hasOwnProperty.call(e,u)&&((i=(l=c)&&o(e,u))&&(i.get||i.set)?l(n,u,i):n[u]=e[u]);return n})(e,t)}function E(e,t){var a=l(e);if(i){var r=i(e);t&&(r=n(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}class T extends R.default{constructor(){super(...arguments),(0,C.default)(this,"getUserProjectRole",(e=>{var t,a,{users:r={},groups:l={}}=e||{},i=[],n=[];return(0,p.default)(t=(0,h.default)(r)).call(t,(e=>{var t=r[e];(0,p.default)(t).call(t,(e=>{n.push({role:e}),i.push(e.id)}))})),(0,p.default)(a=(0,h.default)(l)).call(a,(e=>{var{roles:t,group:a}=l[e],r=(0,v.default)(t).call(t,(e=>!(0,g.default)(i).call(i,e.id)));(0,p.default)(r).call(r,(e=>{var t=(0,b.default)(n).call(n,(t=>t.role.id===e.id));t?t.groups.push(a):n.push({role:e,groups:[a]})}))})),n})),(0,C.default)(this,"updateFetchParams",(e=>{var{match:t}=this.props,{id:a}=t.params||{},r=function(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?u(a=E(Object(l),!0)).call(a,(function(t){(0,C.default)(e,t,l[t])})):s?d(e,s(l)):u(r=E(Object(l))).call(r,(function(t){c(e,t,o(l,t))}))}return e}({},e);return this.inUserDetail?r.userId=a:this.inUserGroupDetail?r.groupId=a:this.inDomainDetail&&(r.domain_id=a),r}))}init(){this.store=this.inDetailPage?new I.ProjectStore:I.default}get policy(){return"identity:list_projects"}get name(){return t("projects")}get isFilterByBackend(){return!1}get inProject(){var e;return(0,g.default)(e=this.path).call(e,"project-admin")}get inUserDetail(){var e;return this.inDetailPage&&(0,g.default)(e=this.path).call(e,"user-admin/detail")}get inUserGroupDetail(){var e;return this.inDetailPage&&(0,g.default)(e=this.path).call(e,"user-group-admin/detail")}get inDomainDetail(){var e;return this.inDetailPage&&(0,g.default)(e=this.path).call(e,"domain-admin/detail")}get forceRefreshTopDetailWhenListRefresh(){return this.inUserDetail}get refreshDetailDataWithSilence(){return!this.inUserDetail}getBaseColumns(){var e={title:t("Role"),dataIndex:"userProjectRole",render:(e,a)=>{var r=this.getUserProjectRole(a),l=(0,y.default)(r).call(r,(e=>{var{role:{id:a,name:r},groups:l=[]}=e;if(!l.length){var i=this.getLinkRender("roleDetail",r,{id:a},{tab:"user"});return S.default.createElement("div",{key:"user-role-".concat(a)},i)}var n=this.getLinkRender("roleDetail",r,{id:a},{tab:"groups"}),o=(0,y.default)(l).call(l,(e=>{var t=this.getLinkRender("groupDetail",e.name,{id:e.id});return S.default.createElement("span",{style:{marginRight:"8px"}},t)}));return S.default.createElement("div",{key:"group-role-".concat(a)},n," (",t("authorized by group "),o,")")}));return S.default.createElement("div",null,l)},stringify:(e,a)=>{var r=this.getUserProjectRole(a);return(0,y.default)(r).call(r,(e=>{var a,r,{role:{name:l},groups:i=[]}=e;if(!i.length)return l;var n=(0,y.default)(i).call(i,(e=>e.name)).join("; ");return(0,j.default)(a=(0,j.default)(r="".concat(l," (")).call(r,t("authorized by group "))).call(a,n,")")})).join("; ")}},a={title:t("Role"),dataIndex:"groupProjectRole",render:(e,t)=>{var a,{groups:r={}}=t;return(0,y.default)(a=(0,h.default)(r)).call(a,(e=>{var t=r[e];return(0,y.default)(t).call(t,(t=>{var a,{id:r,name:l}=t,i=this.getLinkRender("roleDetail",l,{id:r},{tab:"group"});return S.default.createElement("div",{key:(0,j.default)(a="".concat(e,"-")).call(a,r)},i)}))}))},stringify:(e,t)=>{var a,{groups:r={}}=t;return(0,y.default)(a=(0,h.default)(r)).call(a,(e=>{var t=r[e];return(0,y.default)(t).call(t,(e=>e.name)).join(" ; ")}))}};return[{title:t("Project ID/Name"),dataIndex:"name",routeName:"projectDetailAdmin"},e,a,{title:t("Member Num"),dataIndex:"num",isHideable:!0,render:(e,a)=>{var{userCount:r,groupCount:l}=a;return S.default.createElement("div",null,S.default.createElement("span",null,t("User Num: "),r),S.default.createElement(D.default,{type:"vertical",className:k.default["header-divider"]}),S.default.createElement("span",null,t("User Group Num: "),l))},stringify:(e,a)=>{var r,l,i,{userCount:n,groupCount:o}=a;return(0,j.default)(r=(0,j.default)(l=(0,j.default)(i="".concat(t("User Num: "))).call(i,n," | ")).call(l,t("User Group Num: "))).call(r,o)}},{title:t("Affiliated Domain ID/Name"),dataIndex:"domainName",isHideable:!0,routeName:"domainDetailAdmin",isLink:!0,idKey:"domain_id"},U.enabledColumn,{title:t("Tags"),dataIndex:"tags",render:e=>(0,y.default)(e).call(e,((e,t)=>(0,P.SimpleTag)({tag:e,index:t}))),isHideable:!0},{title:t("Description"),dataIndex:"description",isHideable:!0}]}getColumns(){var e=this.getBaseColumns();return this.inProject?(0,v.default)(e).call(e,(e=>{var t;return!(0,g.default)(t=["userProjectRole","groupProjectRole"]).call(t,e.dataIndex)})):this.inDomainDetail?(0,v.default)(e).call(e,(e=>{var t;return!(0,g.default)(t=["domainName","userProjectRole","groupProjectRole"]).call(t,e.dataIndex)})):this.inUserDetail?(0,v.default)(e).call(e,(e=>{var t;return!(0,g.default)(t=["num","groupProjectRole"]).call(t,e.dataIndex)})):this.inUserGroupDetail?(0,v.default)(e).call(e,(e=>{var t;return!(0,g.default)(t=["num","userProjectRole"]).call(t,e.dataIndex)})):e}get actionConfigs(){return this.inDetailPage?this.inUserDetail?N.actionConfigsInUserDetail:w.emptyActionConfig:N.default}get searchFilters(){var e=this.inDomainDetail?[]:[{label:t("Domain Name"),name:"domainName"}];return[{label:t("Project Name"),name:"name"},{label:t("Project ID"),name:"id"},{label:t("Enabled"),name:"enabled",options:w.yesNoOptions},...e,{label:t("Tags"),name:"tags",filterFunc:(e,t)=>{var a=t.toLowerCase();return(0,_.default)(e).call(e,(e=>{var t;return(0,g.default)(t=e.toLowerCase()).call(t,a)}))}}]}}a.Projects=T;a.default=(0,x.inject)("rootStore")((0,x.observer)(T))},20156:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=void 0;var n=i(r(77879)),o=i(r(23872)),u=r(60615),s=i(r(35613));class d extends u.ConfirmAction{constructor(){super(...arguments),(0,n.default)(this,"policy","identity:delete_domain"),(0,n.default)(this,"allowedCheckFunc",(e=>!e.enabled)),(0,n.default)(this,"confirmContext",(e=>{var a=this.getName(e);return o.default.createElement("div",null,o.default.createElement("div",null,t("Are you sure to {action} (instance: {name})?",{action:this.actionNameDisplay||this.title,name:a})),o.default.createElement("div",null,t("Please note that when deleting a domain, all projects, users, and user groups under the domain will be deleted directly!")))})),(0,n.default)(this,"onSubmit",(e=>{var{id:t}=e;return s.default.delete({id:t})}))}get id(){return"delete"}get title(){return t("Delete Domain")}get isDanger(){return!0}get buttonText(){return t("Delete")}get actionName(){return t("delete domain")}}a.default=d},21697:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.Password=void 0;var n=i(r(24836)),o=i(r(77879)),u=r(87067),s=r(60615),d=r(46197),c=i(r(61362));class f extends s.ModalAction{constructor(){super(...arguments),(0,o.default)(this,"onSubmit",(e=>{var{id:t}=this.item,{password:a}=e;return c.default.changePassword({id:t,password:a})}))}get name(){return t("Update user password")}get defaultValue(){var{name:e}=this.item;return{name:e,password:"",confirmPassword:""}}get formItems(){return[{name:"name",label:t("User"),type:"label",iconType:"user"},{name:"password",label:t("Password"),type:"input-password",required:!0,otherRule:(0,d.getPasswordOtherRule)("password")},{name:"confirmPassword",label:t("Confirm Password"),dependencies:["password"],type:"input-password",required:!0,otherRule:(0,d.getPasswordOtherRule)("confirmPassword")}]}}a.Password=f,(0,o.default)(f,"id","update-user-password"),(0,o.default)(f,"title",t("Update User Password")),(0,o.default)(f,"policy","identity:update_user"),(0,o.default)(f,"allowed",(()=>n.default.resolve(!0)));a.default=(0,u.inject)("rootStore")((0,u.observer)(f))},21841:(e,t,a)=>{var r=a(33385);"string"==typeof r&&(r=[[e.id,r,""]]);var l={hmr:!0,transform:undefined,insertInto:void 0};a(53027)(r,l);r.locals&&(e.exports=r.locals)},22185:(e,t,a)=>{"use strict";var r=a(33950),l=a(48924);r(t,"__esModule",{value:!0}),t.default=t.TagStore=void 0;var i,n=l(a(10732)),o=l(a(33301)),u=a(27567),s=l(a(92621)),d=l(a(81891)),c=new(t.TagStore=(i=class extends d.default{get client(){return s.default.keystone.projects.tags}get projectClient(){return s.default.keystone.projects}listFetchByClient(e,t){var{project_id:a}=t;return this.client.list(a,e)}get paramsFunc(){return()=>null}update(e,t){var{project_id:a}=e;return this.submitting(this.projectClient.updateTags(a,t))}},(0,o.default)(i.prototype,"update",[u.action],(0,n.default)(i.prototype,"update"),i.prototype),i));t.default=c},23032:(e,t,a)=>{"use strict";var r=a(33950),l=a(48924);r(t,"__esModule",{value:!0}),t.default=void 0;var i=l(a(21888)),n=l(a(30916)),o=l(a(9817)),u=l(a(42315)),s=l(a(18672)),d=l(a(33846)),c=l(a(10922)),f=l(a(3292)),m=l(a(47104)),p=l(a(35910)),h=l(a(23290)),v=l(a(26444)),g=l(a(12578)),b=l(a(72097)),y=l(a(87361)),j=l(a(12551)),_=l(a(87777)),D=l(a(52083)),C="/identity";t.default=[{path:C,component:i.default,routes:[{path:"".concat(C,"/domain-admin"),component:o.default,exact:!0},{path:"".concat(C,"/domain-admin/detail/:id"),component:u.default,exact:!0},{path:"".concat(C,"/project"),component:s.default,exact:!0},{path:"".concat(C,"/project-admin"),component:s.default,exact:!0},{path:"".concat(C,"/project/create"),component:d.default,exact:!0},{path:"".concat(C,"/project-admin/create"),component:d.default,exact:!0},{path:"".concat(C,"/project/edit/:id"),component:c.default,exact:!0},{path:"".concat(C,"/project-admin/edit/:id"),component:c.default,exact:!0},{path:"".concat(C,"/user"),component:m.default,exact:!0},{path:"".concat(C,"/user-admin"),component:m.default,exact:!0},{path:"".concat(C,"/user-admin/create"),component:p.default,exact:!0},{path:"".concat(C,"/user-admin/edit/:id"),component:h.default,exact:!0},{path:"".concat(C,"/user-admin/detail/:id"),component:v.default,exact:!0},{path:"".concat(C,"/user-group-admin"),component:g.default,exact:!0},{path:"".concat(C,"/user-group-admin/detail/:id"),component:j.default,exact:!0},{path:"".concat(C,"/user-group-admin/create"),component:b.default,exact:!0},{path:"".concat(C,"/user-group-admin/edit/:id"),component:y.default,exact:!0},{path:"".concat(C,"/role-admin"),component:_.default,exact:!0},{path:"".concat(C,"/role-admin/detail/:id"),component:D.default,exact:!0},{path:"".concat(C,"/project/detail/:id"),component:f.default,exact:!0},{path:"".concat(C,"/project-admin/detail/:id"),component:f.default,exact:!0},{path:"*",component:n.default}]}]},23290:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.EditForm=void 0;var n=i(r(24836)),o=i(r(68982)),u=i(r(19989)),s=i(r(77879)),d=r(87067),c=r(60615),f=i(r(61362)),m=r(46197),p=i(r(7519));class h extends c.ModalAction{constructor(){super(...arguments),(0,s.default)(this,"checkName",((e,a)=>{if(!a)return n.default.reject(t("Please input"));var{list:{data:r}}=this.store,{id:l}=this.item;return(0,o.default)(r).call(r,(e=>e.name===a&&e.id!==l&&e.domain_id===this.item.domain_id))?n.default.reject(t("Invalid: User names in the domain can not be repeated")):n.default.resolve()})),(0,s.default)(this,"onSubmit",(e=>{var{email:t,phone:a,real_name:r,description:l,name:i}=e,{id:n}=this.item;return f.default.edit(n,{email:t,phone:a,real_name:r,description:l,name:i})}))}init(){this.store=f.default;var{list:{data:e}}=this.store;0===e.length&&this.store.fetchList()}static allowed(){return n.default.resolve(!0)}get actionName(){return t("Edit User")}get defaultValue(){var e,{name:t,email:a,phone:r,real_name:l,description:i,domain:n,domain_id:o}=this.item,s=(0,p.default)(r||"","CN")||{countryCallingCode:"86",nationalNumber:""},{countryCallingCode:d,nationalNumber:c}=s;return{name:t,domainName:(n||{}).name||o,email:a,phone:(0,u.default)(e="+".concat(d," ")).call(e,c),real_name:l,description:i}}get formItems(){return[{name:"name",label:t("User Name"),type:"input",placeholder:t("Please input user name"),validator:this.checkName,extra:t("User")+t("Name can not be duplicated"),required:!0},{name:"email",label:t("Email"),type:"input",validator:m.emailValidate,required:!0},{name:"phone",label:t("Phone"),type:"phone",required:!0,validator:m.phoneNumberValidate},{name:"real_name",label:t("Real Name"),type:"input",required:!0},{name:"domainName",label:t("Affiliated Domain"),type:"input",disabled:!0},{name:"description",label:t("Description"),type:"textarea"}]}}a.EditForm=h,(0,s.default)(h,"id","user-edit"),(0,s.default)(h,"title",t("Edit")),(0,s.default)(h,"policy","identity:update_user");a.default=(0,d.inject)("rootStore")((0,d.observer)(h))},26444:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.UserDetail=void 0;var n=i(r(89195)),o=i(r(23872)),u=r(87067),s=r(61362),d=i(r(19585)),c=i(r(90806)),f=r(53434),m=r(64562),p=i(r(12578)),h=i(r(18672)),v=i(r(15228));class g extends d.default{get name(){return t("user")}get policy(){return"identity:get_user"}get listUrl(){return this.getRoutePath("user")}get actionConfigs(){return this.isAdminPage?v.default:f.emptyActionConfig}init(){this.store=new s.UserStore}get detailInfos(){return[{title:t("User Name"),dataIndex:"name"},m.enabledColumn,{title:t("System Roles"),dataIndex:"systemRoles",render:e=>{var t;return e&&e.length?(0,n.default)(t=e||[]).call(t,(e=>o.default.createElement("div",{key:e.id},e.name))):"-"}},{title:t("Real Name"),dataIndex:"real_name"},{title:t("Affiliated Domain"),dataIndex:"domainName"},{title:t("Default Project"),dataIndex:"default_project_id",render:e=>this.detailData.defaultProject||e||"-"},{title:t("Email"),dataIndex:"email",render:e=>e||"-"},{title:t("phone"),dataIndex:"phone"},{title:t("Description"),dataIndex:"description"}]}get tabs(){return[{title:t("Subordinate Projects"),key:"project",component:h.default},{title:t("Subordinate User Groups"),key:"userGroup",component:p.default},{title:t("Application Credentials"),key:"applicationCredentials",component:c.default}]}}a.UserDetail=g;a.default=(0,u.inject)("rootStore")((0,u.observer)(g))},28237:(e,t,a)=>{"use strict";var r=a(33950),l=a(48924);r(t,"__esModule",{value:!0}),t.default=void 0;var i=l(a(7221)),n=l(a(94042)),o={rowActions:{firstAction:l(a(80357)).default,moreActions:[{action:n.default}]},batchActions:[n.default],primaryActions:[i.default]};t.default=o},29031:(e,a,r)=>{"use strict";var l=r(71742),i=r(33950),n=r(10732),o=r(48924);i(a,"__esModule",{value:!0}),a.default=a.ManageQuota=void 0;var u=o(r(49849)),s=o(r(24836)),d=o(r(32462)),c=o(r(18565)),f=o(r(68982)),m=o(r(89195));r(87213);var p=o(r(31595)),h=o(r(1839)),v=o(r(77879)),g=r(87067),b=function(e,t){if("function"==typeof l)var a=new l,r=new l;return function(e,t){if(!t&&e&&e.__esModule)return e;var l,o,u={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return u;if(l=t?r:a){if(l.has(e))return l.get(e);l.set(e,u)}for(var s in e)"default"!==s&&{}.hasOwnProperty.call(e,s)&&((o=(l=i)&&n(e,s))&&(o.get||o.set)?l(u,s,o):u[s]=e[s]);return u}(e,t)}(r(52740)),y=o(r(23872)),j=(r(77800),r(60615)),_=r(12941),D=r(23653),C=["more","compute","storage","networks","volumeTypes","share","zun","magnum"];class S extends j.ModalAction{constructor(){var e;super(...arguments),e=this,(0,v.default)(this,"checkMin",((e,a)=>{var{quota:r}=this.projectStore,{field:l}=e,{used:i}=r[l];return a<i&&-1!==a||!/^-?\d+$/.test(a)?s.default.reject(t("Invalid: Quota value(s) cannot be less than the current usage value(s): { used } used.",{used:i})):s.default.resolve()})),(0,v.default)(this,"getTitleLabel",((e,t,a)=>({name:e,label:"",type:"label",content:y.default.createElement("div",{style:{textAlign:"center",fontWeight:"bolder"}},t),wrapperCol:{span:24},hidden:a}))),(0,v.default)(this,"onSubmit",function(){var t=(0,h.default)((function*(t){return e.store.updateProjectQuota(t)}));return function(e){return t.apply(this,arguments)}}())}init(){this.store=b.default,this.projectStore=new b.ProjectStore,this.volumeTypeStore=new _.VolumeTypeStore,this.getData()}get name(){return t("Edit quota")}get enableCinder(){return this.props.rootStore.checkEndpoint("cinder")}get enableShare(){return this.props.rootStore.checkEndpoint("manilav2")}get enableZun(){return this.props.rootStore.checkEndpoint("zun")}get enableMagnum(){return this.props.rootStore.checkEndpoint("magnum")}get enableTrove(){return this.props.rootStore.checkEndpoint("trove")&&this.props.rootStore.hasAdminOnlyRole}getData(){var e=this;return(0,h.default)((function*(){var{id:t}=e.item,a=[e.projectStore.fetchProjectQuota({project_id:t})];e.enableCinder&&a.push(e.volumeTypeStore.fetchProjectVolumeTypes(t)),yield s.default.all(a),e.updateDefaultValue()}))()}get tips(){return t("quota set to -1 means there is no quota limit on the current resource")}get defaultValue(){var e,{quota:t={}}=this.projectStore,a={};return(0,d.default)(e=(0,c.default)(t)).call(e,(e=>{var r;if((0,f.default)(r=this.formItems).call(r,(t=>t.name===e))){var{limit:l}=t[e]||{};a[e]=l}})),a}getInputItem(e,t,a){return{name:e,label:t,type:"input-number",labelCol:{span:14},colNum:2,validator:this.checkMin,hidden:a}}get quotaCardList(){var e=[...D.quotaCardList];return this.enableShare&&e.push(D.shareQuotaCard),this.enableZun&&e.push(D.zunQuotaCard),this.enableMagnum&&e.push(D.magnumQuotaCard),this.enableTrove&&e.push(D.troveQuotaCard),e}getFormItemsByCards(e){var t,a=(0,f.default)(t=this.quotaCardList).call(t,(t=>t.type===e));if(!a)return[];var{type:r,text:l,value:i}=a;return[this.getTitleLabel(r,l),...(0,m.default)(i).call(i,(e=>{var{key:t,text:a}=e;return this.getInputItem(t,a)}))]}getComputeFormItems(){return[...this.getFormItemsByCards("compute"),this.getInputItem("server_group_members",t("Members of Each Server Group"))]}get volumeTypeData(){var{projectVolumeTypes:e=[]}=this.volumeTypeStore;return e}getVolumeTypeFormItems(){var{more:e}=this.state,t=(0,D.getVolumeTypeCards)(this.volumeTypeData),{type:a,text:r,value:l}=t,i=[];return(0,d.default)(l).call(l,(e=>i.push(...e.value))),[this.getTitleLabel(a,r,!e),...(0,m.default)(i).call(i,(t=>this.getInputItem(t.key,t.text,!e)))]}getMagnumFormItems(){var e=this.getFormItemsByCards("magnum");return(0,m.default)(e).call(e,(e=>("magnum_cluster"===e.name&&(e.min=1,e.tip=t("The limit of cluster instance greater than or equal to 1.")),e)))}get formItems(){if(this.projectStore.quotaLoading)return[{name:"loading",label:"",component:y.default.createElement(p.default,null)}];var e=[...this.getComputeFormItems(),...this.getFormItemsByCards("networks")];if(this.enableShare&&e.push(...this.getFormItemsByCards("share")),this.enableZun&&e.push(...this.getFormItemsByCards("zun")),this.enableMagnum&&e.push(...this.getMagnumFormItems()),this.enableTrove&&e.push(...this.getFormItemsByCards("trove")),this.enableCinder){var a=this.getFormItemsByCards("storage"),r=this.getVolumeTypeFormItems();e.push(...a),e.push({name:"more",label:t("Advanced Options"),type:"more"},...r)}return e}getSubmitData(e){var{id:t}=this.item,{more:a,compute:r,storage:l,networks:i,volumeTypes:n,share:o,zun:s,magnum:d}=e;return{project_id:t,data:(0,u.default)(e,C),current_quota:this.projectStore.quota}}}a.ManageQuota=S,(0,v.default)(S,"id","quota-management"),(0,v.default)(S,"title",t("Edit Quota")),(0,v.default)(S,"policy",["os_compute_api:os-quota-sets:update","os_compute_api:os-quota-sets:defaults"]),(0,v.default)(S,"allowed",(()=>s.default.resolve(!0)));a.default=(0,g.inject)("rootStore")((0,g.observer)(S))},29891:(e,t,a)=>{(t=e.exports=a(40049)(!1)).push([e.id,"/* init */\n/* specific color */\n/*  border */\n/*  input */\n/*  background */\n/* button */\n/*  shadow */\n/*  font */\n/*  animation */\n/*  size */\n/*  sider */\n.index__layout-header-menu-search-border--OWkZF {\n  border: none;\n}\n.index__vertical-center--1ZfRx {\n  position: absolute;\n  top: 50%;\n  -webkit-transform: translateY(-50%);\n          transform: translateY(-50%);\n}\n/* login */\n.index__header-divider--1YGJP {\n  width: 2px;\n  margin: 0 5px;\n  background-color: rgba(0, 0, 0, 0.45);\n}\n",""]),t.locals={primaryColor:"#a33e3e",normalColor:"rgba(34, 117, 74, 0.78)",successColor:"#57e39b",warnColor:"#fedf40",warnDarkColor:"#fa8c16",warnLightColor:"#f6b23d",errorColor:"#eb354d",dangerColor:"#c4233e",moneyColor:"#f50",infoColor:"rgba(0, 104, 255, 0.65)",headerHeight:"50px",productsColumnWidth:"220px","layout-header-menu-search-border":"index__layout-header-menu-search-border--OWkZF","vertical-center":"index__vertical-center--1ZfRx","header-divider":"index__header-divider--1YGJP"}},30200:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.RemoveDefaultProject=void 0;var n=i(r(24836)),o=i(r(77879)),u=r(87067),s=r(60615),d=i(r(61362));class c extends s.ModalAction{constructor(){super(...arguments),(0,o.default)(this,"onSubmit",((e,t)=>{var{detail:{id:a}}=t;return d.default.setDefaultProject(a,null)}))}get name(){return t("Remove default project for user")}get formItems(){return[{name:"name",type:"label",content:t("Are you sure to remove the default project?")}]}}a.RemoveDefaultProject=c,(0,o.default)(c,"id","remove-default-project"),(0,o.default)(c,"title",t("Remove Default Project")),(0,o.default)(c,"policy","identity:update_user"),(0,o.default)(c,"policy","identity:update_user"),(0,o.default)(c,"allowed",((e,t)=>{var{detail:a}=t||{},{default_project_id:r}=a;return n.default.resolve(!!r)}));a.default=(0,u.inject)("rootStore")((0,u.observer)(c))},30667:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=void 0;var n=i(r(89195)),o=i(r(77879)),u=i(r(20173)),s=r(60615),d=i(r(52740));class c extends s.ConfirmAction{constructor(){super(...arguments),(0,o.default)(this,"policy","identity:update_project"),(0,o.default)(this,"allowedCheckFunc",(e=>!e||this.isForbidden(e))),(0,o.default)(this,"confirmContext",(e=>{var a=(0,u.default)(e)?(0,n.default)(e).call(e,(e=>e.name)).join(","):e.name;return t("Are you sure to forbidden project { name }? Forbidden the project will have negative effect, and users associated with the project will not be able to log in if they are only assigned to the project",{name:a})})),(0,o.default)(this,"onSubmit",(()=>{var{id:e}=this.item;return d.default.forbidden({id:e})}))}get id(){return"Forbidden"}get title(){return t("Forbidden Project")}get buttonText(){return t("Forbidden")}get actionName(){return t("Forbidden Project")}get isDanger(){return!0}isForbidden(e){return!1!==e.enabled}}a.default=c},31400:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=void 0;var n=i(r(77879)),o=r(60615),u=i(r(53884));class s extends o.ConfirmAction{constructor(){super(...arguments),(0,n.default)(this,"policy","identity:delete_group"),(0,n.default)(this,"onSubmit",(e=>{var{id:t}=e;return u.default.delete({id:t})}))}get id(){return"delete"}get title(){return t("Delete Group")}get isDanger(){return!0}get buttonText(){return t("Delete")}get actionName(){return t("delete group")}}a.default=s},33385:(e,t,a)=>{(t=e.exports=a(40049)(!1)).push([e.id,"/* init */\n/* specific color */\n/*  border */\n/*  input */\n/*  background */\n/* button */\n/*  shadow */\n/*  font */\n/*  animation */\n/*  size */\n/*  sider */\n.index__layout-header-menu-search-border--2AwQS {\n  border: none;\n}\n.index__vertical-center--1qEBp {\n  position: absolute;\n  top: 50%;\n  -webkit-transform: translateY(-50%);\n          transform: translateY(-50%);\n}\n/* login */\n.index__wrapper--14spR {\n  min-height: calc(100vh - 108px);\n  padding: 0 16px 16px 16px;\n}\n",""]),t.locals={primaryColor:"#a33e3e",normalColor:"rgba(34, 117, 74, 0.78)",successColor:"#57e39b",warnColor:"#fedf40",warnDarkColor:"#fa8c16",warnLightColor:"#f6b23d",errorColor:"#eb354d",dangerColor:"#c4233e",moneyColor:"#f50",infoColor:"rgba(0, 104, 255, 0.65)",headerHeight:"50px",productsColumnWidth:"220px","layout-header-menu-search-border":"index__layout-header-menu-search-border--2AwQS","vertical-center":"index__vertical-center--1qEBp",wrapper:"index__wrapper--14spR"}},33846:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.Create=void 0;var n=i(r(24836)),o=i(r(3787)),u=i(r(77879)),s=r(87067),d=r(60615),c=i(r(35613)),f=i(r(52740)),m=r(46197),p=r(64562);class h extends d.ModalAction{constructor(e){super(e),(0,u.default)(this,"checkName",((e,a)=>{if(!a)return n.default.reject(t("Please input"));var{nameRegexWithoutChinese:r}=m.regex;if(!r.test(a))return n.default.reject(t("Invalid: Project name can not be chinese"));var l=this.formRef.current.getFieldValue("domain_id");if(!l)return n.default.resolve();var{list:{data:i}}=this.projectStore;return(0,o.default)(i).call(i,(e=>e.name===a&&e.domain_id===l))[0]?n.default.reject(t("Invalid: Project names in the domain can not be repeated")):n.default.resolve()})),(0,u.default)(this,"onSubmit",(e=>(e.enabled=e.enabled.value,this.projectStore.create(e)))),this.state={domain:null,newUserRoles:{},newGroupRoles:{}}}init(){this.domainStore=c.default,this.projectStore=f.default,this.getDomains()}getDomains(){this.domainStore.fetchDomain()}static allowed(){return n.default.resolve(!0)}get name(){return t("Create Project")}get defaultValue(){return{domain_id:"default",enabled:p.statusTypes[0]}}get formItems(){var e=(0,p.getDomainFormItem)(this);return[{name:"name",label:t("Name"),type:"input",required:!0,placeholder:t("Please input name"),validator:this.checkName,extra:t("Project")+t("Name can not be duplicated"),maxLength:30,dependencies:["domain_id"]},e,{name:"enabled",label:t("Status"),type:"radio",optionType:"default",options:p.statusTypes,required:!0,isWrappedValue:!0,tip:t("Disabling the project will have a negative impact. If the users associated with the project are only assigned to the project, they will not be able to log in")},{name:"description",label:t("Description"),type:"textarea"}]}}a.Create=h,(0,u.default)(h,"id","project-create"),(0,u.default)(h,"title",t("Create Project")),(0,u.default)(h,"policy",["identity:create_project","identity:list_domains","identity:list_roles","identity:list_users"]);a.default=(0,s.inject)("rootStore")((0,s.observer)(h))},35373:(e,a,r)=>{"use strict";var l=r(18565),i=r(13696),n=r(3787),o=r(10732),u=r(32462),s=r(10819),d=r(22338),c=r(33950),f=r(48924);c(a,"__esModule",{value:!0}),a.default=a.Edit=void 0;var m=f(r(68982)),p=f(r(24836)),h=f(r(1839)),v=f(r(77879)),g=r(87067),b=r(60615),y=f(r(35613)),j=r(27567);function _(e,t){var a=l(e);if(i){var r=i(e);t&&(r=n(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}class D extends b.ModalAction{constructor(){var e;super(...arguments),e=this,(0,v.default)(this,"nameValidator",((e,a)=>{var r=(0,j.toJS)(this.currentList);return(0,m.default)(r).call(r,(e=>e.name===a&&e.id!==this.item.id))?p.default.reject(new Error(t("Invalid: Domain name cannot be duplicated"))):p.default.resolve(!0)})),(0,v.default)(this,"onSubmit",function(){var t=(0,h.default)((function*(t){var{id:a}=e.item;return e.store.edit(function(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?u(a=_(Object(l),!0)).call(a,(function(t){(0,v.default)(e,t,l[t])})):s?d(e,s(l)):u(r=_(Object(l))).call(r,(function(t){c(e,t,o(l,t))}))}return e}({id:a},t))}));return function(e){return t.apply(this,arguments)}}())}init(){this.store=y.default,this.store.fetchList()}static allowed(){return p.default.resolve(!0)}get defaultValue(){var{name:e,description:t}=this.item;return{name:e,description:t}}get currentList(){var{list:{data:e=[]}={}}=this.store;return e}get formItems(){return[{name:"name",label:t("Name"),type:"input",placeholder:t("Please input name"),required:!0,validator:this.nameValidator},{name:"description",label:t("Description"),type:"textarea"}]}}a.Edit=D,(0,v.default)(D,"id","domain-edit"),(0,v.default)(D,"title",t("Edit Domain")),(0,v.default)(D,"buttonText",t("Edit")),(0,v.default)(D,"policy","identity:update_domain");a.default=(0,g.inject)("rootStore")((0,g.observer)(D))},35613:(e,t,a)=>{"use strict";var r=a(18565),l=a(13696),i=a(3787),n=a(10732),o=a(32462),u=a(10819),s=a(22338),d=a(33950),c=a(48924);d(t,"__esModule",{value:!0}),t.default=t.DomainStore=void 0;var f,m,p=c(a(24836)),h=c(a(89195)),v=c(a(3787)),g=c(a(10732)),b=c(a(1839)),y=c(a(37187)),j=c(a(77879)),_=c(a(33301)),D=(c(a(55041)),a(27567)),C=c(a(92621)),S=c(a(81891));function x(e,t){var a=r(e);if(l){var o=l(e);t&&(o=i(o).call(o,(function(t){return n(e,t).enumerable}))),a.push.apply(a,o)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?o(a=x(Object(l),!0)).call(a,(function(t){(0,j.default)(e,t,l[t])})):u?s(e,u(l)):o(r=x(Object(l))).call(r,(function(t){d(e,t,n(l,t))}))}return e}var I=new(t.DomainStore=(f=class extends S.default{constructor(){super(...arguments),(0,y.default)(this,"domains",m,this)}get client(){return C.default.keystone.domains}get userClient(){return C.default.keystone.users}get userGroupClient(){return C.default.keystone.groups}get projectClient(){return C.default.keystone.projects}listDidFetch(e){var t=this;return(0,b.default)((function*(){if(!e.length)return e;var[a,r,l]=yield p.default.all([t.userClient.list(),t.projectClient.list(),t.userGroupClient.list()]);return(0,h.default)(e).call(e,(e=>{var t,i,n,o=(0,v.default)(t=a.users||[]).call(t,(t=>t.domain_id===e.id)),u=(0,v.default)(i=r.projects||[]).call(i,(t=>t.domain_id===e.id)),s=(0,v.default)(n=l.groups||[]).call(n,(t=>t.domain_id===e.id));return R(R({},e),{},{users:o,userCount:o.length,projects:u,projectCount:u.length,groups:s,groupCount:s.length})}))}))()}detailDidFetch(e){var t=this;return(0,b.default)((function*(){var{id:a}=e,[r,l,i]=yield p.default.all([t.userClient.list({domain_id:a}),t.projectClient.list({domain_id:a}),t.userGroupClient.list({domain_id:a})]),{users:n=[]}=r||{},{projects:o=[]}=l||{},{groups:u=[]}=i||{};return R(R({},e),{},{users:n,userCount:n.length,projects:o,projectCount:o.length,groups:u,groupCount:u.length})}))()}fetchDomain(){var e=this;return(0,b.default)((function*(){var t=yield e.client.list();e.domains=t.domains}))()}edit(e){var t=this;return(0,b.default)((function*(){var{id:a,description:r,name:l}=e,i={domain:{description:r,name:l}};return t.submitting(t.client.patch(a,i))}))()}forbidden(e){var t=this;return(0,b.default)((function*(){var{id:a}=e;return t.submitting(t.client.patch(a,{domain:{enabled:!1}}))}))()}enable(e){var t=this;return(0,b.default)((function*(){var{id:a}=e;return t.submitting(t.client.patch(a,{domain:{enabled:!0}}))}))()}},m=(0,_.default)(f.prototype,"domains",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),(0,_.default)(f.prototype,"fetchDomain",[D.action],(0,g.default)(f.prototype,"fetchDomain"),f.prototype),(0,_.default)(f.prototype,"edit",[D.action],(0,g.default)(f.prototype,"edit"),f.prototype),(0,_.default)(f.prototype,"forbidden",[D.action],(0,g.default)(f.prototype,"forbidden"),f.prototype),(0,_.default)(f.prototype,"enable",[D.action],(0,g.default)(f.prototype,"enable"),f.prototype),f));t.default=I},35910:(e,a,r)=>{"use strict";var l=r(18565),i=r(13696),n=r(3787),o=r(10732),u=r(32462),s=r(10819),d=r(22338),c=r(33950),f=r(48924);c(a,"__esModule",{value:!0}),a.default=a.Create=void 0;var m=f(r(49849)),p=f(r(89195)),h=f(r(32462)),v=f(r(18565)),g=f(r(29672)),b=f(r(24836)),y=f(r(3787)),j=f(r(60147)),_=f(r(1839));r(23153);var D=f(r(47983)),C=f(r(77879)),S=f(r(23872)),x=r(87067),R=r(53884),I=f(r(61362)),w=r(60615),P=(r(77800),r(52740)),U=f(r(77969)),N=f(r(35613)),k=r(46197),M=r(64562),E=r(80726),T=["confirmPassword","more"];function F(e,t){var a=l(e);if(i){var r=i(e);t&&(r=n(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?u(a=F(Object(l),!0)).call(a,(function(t){(0,C.default)(e,t,l[t])})):s?d(e,s(l)):u(r=F(Object(l))).call(r,(function(t){c(e,t,o(l,t))}))}return e}class G extends w.FormAction{constructor(e){var a;super(e),a=this,(0,C.default)(this,"projectRolesList",(e=>{var t;return(0,p.default)(t=this.projectRoleList||[]).call(t,(t=>({label:t.name,value:t.id,projectId:e})))})),(0,C.default)(this,"defaultRoles",(()=>[(this.projectRoleList[0]||{}).id])),(0,C.default)(this,"onSelectChange",((e,t,a)=>{var{projectRoles:r}=this.state;e.length&&t.length?r[a]=e:r[a]=[],this.setState({projectRoles:r})})),(0,C.default)(this,"onClickSelect",(e=>{e&&e.stopPropagation&&e.stopPropagation()})),(0,C.default)(this,"renderSelect",(e=>S.default.createElement(D.default,{size:"small",mode:"multiple",options:this.projectRolesList(e),defaultValue:this.defaultRoles(),filterOption:E.roleFilterOption,onChange:(t,a)=>{this.onSelectChange(t,a,e)},onClick:this.onClickSelect}))),(0,C.default)(this,"onChangeProject",(e=>{var t,a,{projectRoles:r}=this.state;(0,h.default)(t=e||[]).call(t,(e=>{r[e]||(r[e]=this.defaultRoles())})),(0,h.default)(a=(0,v.default)(r)).call(a,(t=>{var a;(0,g.default)(a=e||[]).call(a,t)||delete r[t]})),this.setState(r)})),(0,C.default)(this,"checkName",((e,a)=>{if(!a)return b.default.reject(t("Please input"));var r=this.formRef.current.getFieldValue("domain_id");if(!r)return b.default.resolve();var{list:{data:l}}=this.store;return(0,y.default)(l).call(l,(e=>e.name===a&&e.domain_id===r))[0]?b.default.reject(t("Invalid: User names in the domain can not be repeated")):b.default.resolve()})),(0,C.default)(this,"onSubmit",function(){var e=(0,_.default)((function*(e){var{projectRoles:t}=a.state;e.defaultRole=a.projectRoleList[0].id,e.projectRoles=t;var{confirmPassword:r,more:l}=e,i=(0,m.default)(e,T);return a.store.create(i)}));return function(t){return e.apply(this,arguments)}}()),this.state={domain:"default",more:!1,projectRoles:{}}}init(){this.store=I.default,this.userGroupStore=new R.GroupStore,this.projectStore=new P.ProjectStore,this.roleStore=U.default,this.getUserGroups(),this.getProjects(),this.getRoles(),this.getDomains()}getDomains(){N.default.fetchDomain()}getUserGroups(){this.userGroupStore.fetchList({withRole:!1})}getProjects(){this.projectStore.fetchList({withRole:!1})}getRoles(){this.roleStore.fetchList()}static allowed(e,t){var{match:{path:a}}=t;return(0,j.default)(a).call(a,"domain-admin/detail")>=0?b.default.resolve(!1):b.default.resolve(!0)}get name(){return t("Create User")}get listUrl(){return this.getRoutePath("user")}get defaultValue(){return{more:!1,enabled:M.statusTypes[0].value,domain_id:"default"}}get projectList(){var e;return(0,p.default)(e=this.projectStore.list.data||[]).call(e,(e=>({label:e.name,value:e.id})))}get userGroupList(){var e;return(0,p.default)(e=this.userGroupStore.list.data||[]).call(e,(e=>A(A({},e),{},{key:e.id})))}get projects(){var e;return(0,p.default)(e=this.projectStore.list.data||[]).call(e,(e=>A(A({},e),{},{key:e.id})))}get leftProjectTable(){return M.projectDomainColumns}get projectRoleList(){return this.roleStore.list.data||[]}get rightProjectTable(){return[...M.projectDomainColumns,{title:t("Select Project Role"),dataIndex:"id",render:e=>this.renderSelect(e)}]}get leftUserGroupTable(){return M.groupDomainColumns}get rightUserGroupTable(){return M.groupDomainColumns}get formItems(){var{more:e}=this.state,a={labelCol:{xs:{span:4},sm:{span:5}},wrapperCol:{xs:{span:16},sm:{span:15}},colNum:2},r=A(A({},(0,M.getDomainFormItem)(this)),a);return[A(A({name:"name",label:t("User Name"),type:"input",validator:this.checkName,extra:t("User name can not be duplicated"),required:!0},a),{},{maxLength:30,dependencies:["domain_id"]}),A({name:"email",label:t("Email"),type:"input",required:!0,validator:k.emailValidate},a),A({name:"password",label:t("Password"),type:"input-password",required:!0,otherRule:(0,k.getPasswordOtherRule)("password")},a),A({name:"phone",label:t("Phone"),type:"phone",required:!0,validator:k.phoneNumberValidate},a),A({name:"confirmPassword",label:t("Confirm Password"),type:"input-password",required:!0,dependencies:["password"],otherRule:(0,k.getPasswordOtherRule)("confirmPassword")},a),r,A({name:"enabled",label:t("Status"),type:"radio",optionType:"default",options:M.statusTypes,required:!0},a),A({name:"description",label:t("Description"),type:"textarea"},a),A(A({name:"real_name",label:t("Real Name"),type:"input",required:!0},a),{},{maxLength:30}),{type:"divider"},{name:"more",label:t("Advanced Options"),type:"more"},{name:"select_project",label:t("Select Project"),type:"transfer",leftTableColumns:this.leftProjectTable,rightTableColumns:this.rightProjectTable,dataSource:this.projects,showSearch:!0,hidden:!e,onChange:this.onChangeProject,filterOption:M.transferFilterOption,loading:this.projectStore.list.isLoading},{name:"select_user_group",label:t("Select User Group"),type:"transfer",leftTableColumns:this.leftUserGroupTable,rightTableColumns:this.rightUserGroupTable,dataSource:this.userGroupList,showSearch:!0,hidden:!e,filterOption:M.transferFilterOption,loading:this.userGroupStore.list.isLoading}]}}a.Create=G,(0,C.default)(G,"id","user-create"),(0,C.default)(G,"title",t("Create User")),(0,C.default)(G,"path","/identity/user-admin/create"),(0,C.default)(G,"policy",["identity:create_user","identity:update_user","identity:list_roles"]),(0,C.default)(G,"allowed",(()=>b.default.resolve(!0)));a.default=(0,x.inject)("rootStore")((0,x.observer)(G))},36979:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=void 0;var n=i(r(77879)),o=r(60615),u=i(r(61362));class s extends o.ConfirmAction{constructor(){super(...arguments),(0,n.default)(this,"policy","identity:delete_user"),(0,n.default)(this,"onSubmit",(e=>{var{id:t}=e;return u.default.delete({id:t})}))}get id(){return"delete"}get title(){return t("Delete User")}get isDanger(){return!0}get buttonText(){return t("Delete")}get actionName(){return t("delete user")}}a.default=s},38800:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=void 0;var n=i(r(77879)),o=r(60615),u=i(r(35613));class s extends o.ConfirmAction{constructor(){super(...arguments),(0,n.default)(this,"policy","identity:update_domain"),(0,n.default)(this,"allowedCheckFunc",(e=>!e||this.isEnable(e))),(0,n.default)(this,"onSubmit",(()=>{var{id:e}=this.item;return u.default.enable({id:e})}))}get id(){return"Enable"}get title(){return t("Enable Domain")}get buttonText(){return t("Enable")}get actionName(){return t("Enable Domain")}isEnable(e){return!0!==e.enabled}}a.default=s},42009:(e,a,r)=>{"use strict";var l=r(18565),i=r(13696),n=r(3787),o=r(10732),u=r(32462),s=r(10819),d=r(22338),c=r(33950),f=r(48924);c(a,"__esModule",{value:!0}),a.default=a.ManageUserGroup=void 0;var m=f(r(89195)),p=f(r(32462)),h=f(r(18565)),v=f(r(29672)),g=f(r(24836)),b=f(r(68982)),y=f(r(58239)),j=f(r(1839));r(23153);var _=f(r(47983)),D=f(r(77879)),C=f(r(23872)),S=r(87067),x=(r(77800),f(r(52740))),R=r(53884),I=f(r(77969)),w=r(60615),P=r(64562),U=r(80726);function N(e,t){var a=l(e);if(i){var r=i(e);t&&(r=n(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?u(a=N(Object(l),!0)).call(a,(function(t){(0,D.default)(e,t,l[t])})):s?d(e,s(l)):u(r=N(Object(l))).call(r,(function(t){c(e,t,o(l,t))}))}return e}class M extends w.ModalAction{constructor(){var e;super(...arguments),e=this,(0,D.default)(this,"groupRolesList",(e=>{var t;return(0,m.default)(t=this.projectRoleList).call(t,(t=>({label:t.name,value:t.id,key:t.id,groupId:e})))})),(0,D.default)(this,"defaultRoles",(e=>{var t,{groups:a}=this.item;return a[e]?(0,m.default)(t=a[e]).call(t,(e=>e.id)):[this.projectRoleList[0].id]})),(0,D.default)(this,"onClickSelect",(e=>{e&&e.stopPropagation&&e.stopPropagation()})),(0,D.default)(this,"renderSelect",(e=>C.default.createElement(_.default,{size:"small",mode:"multiple",options:this.groupRolesList(e),defaultValue:this.defaultRoles(e),filterOption:U.roleFilterOption,onChange:(t,a)=>{this.onSubChange(t,a,e)},onClick:this.onClickSelect}))),(0,D.default)(this,"onSubChange",((e,t,a)=>{var{groupRoles:r}=this.state;e.length&&t.length?r[a]=e:r[a]=[],this.setState({groupRoles:r},(()=>{this.formRef.current.validateFields()}))})),(0,D.default)(this,"onChangeUserGroup",(e=>{var t,a,{groupRoles:r}=this.state;(0,p.default)(t=e||[]).call(t,(e=>{r[e]||(r[e]=this.defaultRoles(e))})),(0,p.default)(a=(0,h.default)(r)).call(a,(t=>{var a;(0,v.default)(a=e||[]).call(a,t)||delete r[t]})),this.setState(r)})),(0,D.default)(this,"validateGroup",(()=>{var e,{groupRoles:a}=this.state;return a&&(0,b.default)(e=(0,h.default)(a)).call(e,(e=>!a[e].length))?g.default.reject(t("Please set at least one role!")):g.default.resolve()})),(0,D.default)(this,"onSubmit",(0,j.default)((function*(){var t,a,{groupRoles:r={}}=e.state,{id:l}=e.item,i=e.getInitRoleMap(),n=[];return(0,p.default)(t=(0,h.default)(i)).call(t,(e=>{var t;(0,p.default)(t=i[e]||[]).call(t,(t=>{var a=r[e]||[];(0,v.default)(a).call(a,t)||n.push(x.default.removeGroupRole({id:l,groupId:e,roleId:t}))}))})),(0,p.default)(a=(0,h.default)(r)).call(a,(e=>{var t,a=i[e]||[];(0,p.default)(t=r[e]).call(t,(t=>{(0,v.default)(a).call(a,t)||n.push(x.default.assignGroupRole({id:l,groupId:e,roleId:t}))}))})),yield g.default.all(n)})))}init(){var e=this;return(0,j.default)((function*(){e.state.groupRoles=e.getInitRoleMap(),e.userGroupStore=new R.GroupStore,e.store=I.default,e.getRoleList(),e.getGroupGroup()}))()}get name(){return t("Manage user group")}getInitRoleMap(){var e,{groups:t={}}=this.item;return(0,y.default)(e=(0,h.default)(t)).call(e,((e,a)=>{var r;return e[a]=(0,m.default)(r=t[a]).call(r,(e=>e.id)),e}),{})}getGroupGroup(){this.userGroupStore.fetchList()}getRoleList(){this.store.fetchList()}static get modalSize(){return"large"}getModalSize(){return"large"}get labelCol(){return{xs:{span:4},sm:{span:2}}}get wrapperCol(){return{xs:{span:20},sm:{span:20}}}get groupList(){var e;return(0,m.default)(e=this.userGroupStore.list.data||[]).call(e,(e=>k(k({},e),{},{key:e.id})))}get projectRoleList(){return this.store.list.data||[]}get leftGroupGroupTable(){return P.groupDomainColumns}get rightGroupGroupTable(){return[...P.groupDomainColumns,{title:t("Select Project Role"),dataIndex:"id",render:e=>this.renderSelect(e)}]}get defaultValue(){var{name:e,domainName:t}=this.item;return{name:e,domain:t}}get formItems(){var{groups:e}=this.item;return[{name:"name",type:"label",label:t("Name"),iconType:"project"},{name:"domain",type:"label",label:t("Domain")},{name:"select_group",label:t("User Group"),type:"transfer",leftTableColumns:this.leftGroupGroupTable,rightTableColumns:this.rightGroupGroupTable,dataSource:this.groupList,disabled:!1,showSearch:!0,oriTargetKeys:e?(0,h.default)(e):[],filterOption:P.transferFilterOption,onChange:this.onChangeUserGroup,wrapperCol:this.wrapperCol,loading:this.userGroupStore.list.isLoading,validator:this.validateGroup}]}}a.ManageUserGroup=M,(0,D.default)(M,"id","manage-group-group"),(0,D.default)(M,"title",t("Manage User Group")),(0,D.default)(M,"policy",["identity:create_grant","identity:revoke_grant"]),(0,D.default)(M,"allowed",(()=>g.default.resolve(!0)));a.default=(0,S.inject)("rootStore")((0,S.observer)(M))},42315:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.DomainDetail=void 0;var n=r(87067),o=r(35613),u=i(r(19585)),s=r(64562),d=i(r(47104)),c=i(r(12578)),f=i(r(18672)),m=i(r(74117));class p extends u.default{get name(){return t("domain")}get policy(){return"identity:get_domain"}get listUrl(){return this.getRoutePath("domain")}get actionConfigs(){return m.default}get detailInfos(){return[{title:t("Domain Name"),dataIndex:"name"},s.enabledColumn,{title:t("Project Num"),dataIndex:"projectCount"},{title:t("User Num"),dataIndex:"userCount"},{title:t("User Group Num"),dataIndex:"groupCount"},{title:t("Description"),dataIndex:"description"}]}get tabs(){return[{title:t("Projects"),key:"project",component:f.default},{title:t("Users"),key:"user",component:d.default},{title:t("User Groups"),key:"userGroup",component:c.default}]}init(){this.store=new o.DomainStore}}a.DomainDetail=p;a.default=(0,n.inject)("rootStore")((0,n.observer)(p))},43087:(e,t,a)=>{"use strict";var r=a(71742),l=a(33950),i=a(10732),n=a(48924);l(t,"__esModule",{value:!0}),t.default=t.Quota=void 0;var o=n(a(24836)),u=n(a(1839)),s=n(a(77879)),d=function(e,t){if("function"==typeof r)var a=new r,n=new r;return function(e,t){if(!t&&e&&e.__esModule)return e;var r,o,u={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return u;if(r=t?n:a){if(r.has(e))return r.get(e);r.set(e,u)}for(var s in e)"default"!==s&&{}.hasOwnProperty.call(e,s)&&((o=(r=l)&&i(e,s))&&(o.get||o.set)?r(u,s,o):u[s]=e[s]);return u}(e,t)}(a(23872)),c=a(87067),f=n(a(23653)),m=a(12941),p=a(52740),h=n(a(21841));class v extends d.Component{constructor(e){var t;super(e),t=this,(0,s.default)(this,"getData",(0,u.default)((function*(){var{id:e}=t.props.match.params,a=[t.projectStore.fetchProjectQuota({project_id:e})];return t.enableCinder&&a.push(t.volumeTypeStore.fetchProjectVolumeTypes(e)),o.default.all(a)}))),this.projectStore=new p.ProjectStore,this.volumeTypeStore=new m.VolumeTypeStore}get enableCinder(){return this.props.rootStore.checkEndpoint("cinder")}get volumeTypeData(){return this.enableCinder?this.volumeTypeStore.projectVolumeTypes:[]}render(){return d.default.createElement("div",{className:h.default.wrapper},d.default.createElement(f.default,{getData:this.getData,projectStore:this.projectStore,volumeTypeStore:this.volumeTypeStore,volumeTypeData:this.volumeTypeData}))}}t.Quota=v;t.default=(0,c.inject)("rootStore")((0,c.observer)(v))},47104:(e,a,r)=>{"use strict";var l=r(18565),i=r(13696),n=r(3787),o=r(10732),u=r(32462),s=r(10819),d=r(22338),c=r(33950),f=r(71742),m=r(48924);c(a,"__esModule",{value:!0}),a.default=a.User=void 0;var p=m(r(29672)),h=m(r(89195)),v=m(r(32099)),g=m(r(3787)),b=m(r(77879)),y=m(r(23872)),j=r(87067),_=m(r(54017)),D=function(e,t){if("function"==typeof f)var a=new f,r=new f;return function(e,t){if(!t&&e&&e.__esModule)return e;var l,i,n={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return n;if(l=t?r:a){if(l.has(e))return l.get(e);l.set(e,n)}for(var u in e)"default"!==u&&{}.hasOwnProperty.call(e,u)&&((i=(l=c)&&o(e,u))&&(i.get||i.set)?l(n,u,i):n[u]=e[u]);return n}(e,t)}(r(61362)),C=r(53434),S=r(64562),x=m(r(15228));function R(e,t){var a=l(e);if(i){var r=i(e);t&&(r=n(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}class I extends _.default{constructor(){super(...arguments),(0,b.default)(this,"updateFetchParams",(e=>{var{match:t}=this.props,{id:a}=t.params||{},r=function(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?u(a=R(Object(l),!0)).call(a,(function(t){(0,b.default)(e,t,l[t])})):s?d(e,s(l)):u(r=R(Object(l))).call(r,(function(t){c(e,t,o(l,t))}))}return e}({},e);return this.inUserGroupDetail?(r.groupId=a,r.withProjectRole=!1,r.withSystemRole=!0,r.withDefaultProject=!0):this.inDomainDetail?(r.domain_id=a,r.withProjectRole=!1,r.withSystemRole=!0,r.withDefaultProject=!0):this.inProjectDetail?(r.projectId=a,r.withProjectRole=!0,r.withSystemRole=!0):this.inRoleDetail?(r.roleId=a,r.withProjectRole=!0,r.withSystemRole=!0):this.inDetailPage||(r.withProjectRole=!1,r.withSystemRole=!0,r.withDefaultProject=!0),r}))}init(){this.store=this.inDetailPage?new D.UserStore:D.default}get policy(){return"identity:list_users"}get name(){return t("users")}get inDomainDetail(){var e;return this.inDetailPage&&(0,p.default)(e=this.path).call(e,"domain-admin/detail")}get inProjectDetail(){var e;return this.inDetailPage&&(0,p.default)(e=this.path).call(e,"project-admin/detail")}get inUserGroupDetail(){var e;return this.inDetailPage&&(0,p.default)(e=this.path).call(e,"identity/user-group")}get inRoleDetail(){var e;return this.inDetailPage&&(0,p.default)(e=this.path).call(e,"identity/role-admin")}getBaseColumns(){return[{title:t("User ID/Name"),dataIndex:"name",routeName:"userDetailAdmin"},{title:t("Real Name"),dataIndex:"real_name",isHideable:!0},{title:t("Default Project ID/Name"),dataIndex:"defaultProject",isHideable:!0,routeName:"projectDetailAdmin",isLink:!0,idKey:"default_project_id"},{title:t("Roles"),dataIndex:"projectRoles",isHideable:!0,render:(e,t)=>{var a,{projects:r}=t;return(0,h.default)(a=(0,v.default)(r)).call(a,(e=>{var{roles:t=[]}=e||{};return(0,h.default)(t).call(t,(e=>y.default.createElement("div",{key:e.id},e.name)))}))},stringify:(e,t)=>{var a,{projects:r}=t;return(0,h.default)(a=(0,v.default)(r)).call(a,(e=>{var{roles:t=[]}=e||{};return(0,h.default)(t).call(t,(e=>e.name)).join(", ")}))}},{title:t("Project Scope"),dataIndex:"projects",isHideable:!0,render:e=>{var t;return(0,h.default)(t=(0,v.default)(e)).call(t,(e=>{var{project:{id:t,name:a}}=e,r=this.getLinkRender("projectDetail",a,{id:t});return y.default.createElement("div",{key:t},r)}))},stringify:e=>{var t;return(0,h.default)(t=(0,v.default)(e)).call(t,(e=>{var{project:t}=e;return t.name})).join("; ")}},{title:t("Affiliated Domain ID/Name"),dataIndex:"domainName",isHideable:!0,routeName:"domainDetailAdmin",isLink:!0,idKey:"domain_id"},{title:t("System Roles"),dataIndex:"systemRoles",render:e=>{var t;return(0,h.default)(t=e||[]).call(t,(e=>y.default.createElement("div",{key:e.id},e.name)))},stringify:e=>{var t;return(0,h.default)(t=e||[]).call(t,(e=>e.name)).join("; ")}},{title:t("Email"),dataIndex:"email",isHideable:!0},{title:t("phone"),dataIndex:"phone",isHideable:!0},S.enabledColumn]}getColumns(){var e=this.getBaseColumns();return!this.inDetailPage||this.inUserGroupDetail?(0,g.default)(e).call(e,(e=>{var t;return!(0,p.default)(t=["projectRoles","projects"]).call(t,e.dataIndex)})):this.inDomainDetail?(0,g.default)(e).call(e,(e=>{var t;return!(0,p.default)(t=["domainName","projects","projectRoles"]).call(t,e.dataIndex)})):this.inRoleDetail?(0,g.default)(e).call(e,(e=>{var t;return!(0,p.default)(t=["projectRoles"]).call(t,e.dataIndex)})):this.inProjectDetail?(0,g.default)(e).call(e,(e=>{var t;return!(0,p.default)(t=["projects"]).call(t,e.dataIndex)})):e}get actionConfigs(){return this.inDetailPage?C.emptyActionConfig:x.default}get searchFilters(){var e=this.inDomainDetail?[]:[{label:t("Domain Name"),name:"domainName"}];return[{label:t("User Name"),name:"name"},{label:t("Real Name"),name:"real_name"},{label:t("Enabled"),name:"enabled",options:C.yesNoOptions},...e]}}a.User=I;a.default=(0,j.inject)("rootStore")((0,j.observer)(I))},51355:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=void 0;var n=i(r(89195)),o=i(r(77879)),u=i(r(20173)),s=r(60615),d=i(r(61362));class c extends s.ConfirmAction{constructor(){super(...arguments),(0,o.default)(this,"policy","identity:update_user"),(0,o.default)(this,"allowedCheckFunc",(e=>!e||this.isForbidden(e))),(0,o.default)(this,"confirmContext",(e=>{var a=(0,u.default)(e)?(0,n.default)(e).call(e,(e=>e.name)).join(","):e.name;return t("Are you sure to forbidden user { name }? Forbidden the user will not allow login in ",{name:a})})),(0,o.default)(this,"onSubmit",(()=>{var{id:e}=this.item;return d.default.forbidden({id:e})}))}get id(){return"Forbidden"}get title(){return t("Forbidden User")}get buttonText(){return t("Forbidden")}get isDanger(){return!0}get actionName(){return t("Forbidden User")}isForbidden(e){return!!e.enabled}}a.default=c},52083:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.RoleDetail=void 0;var n=r(87067),o=r(77969),u=i(r(19585)),s=i(r(47104)),d=i(r(12578)),c=i(r(15523)),f=i(r(28237));class m extends u.default{get name(){return t("role")}get policy(){return["identity:get_role","identity:list_role_assignments"]}get listUrl(){return this.getRoutePath("role")}get actionConfigs(){return f.default}init(){this.store=new o.RoleStore}get detailInfos(){return[{title:t("Role Name"),dataIndex:"name"},{title:t("Description"),dataIndex:"description"}]}get tabs(){return[{title:t("Base Info"),key:"base",component:c.default},{title:t("Binding Users"),key:"user",component:s.default},{title:t("Binding Groups"),key:"group",component:d.default}]}}a.RoleDetail=m;a.default=(0,n.inject)("rootStore")((0,n.observer)(m))},64562:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.userDomainColumns=a.transferFilterOption=a.statusTypes=a.projectDomainColumns=a.groupDomainColumns=a.getDomainOptions=a.getDomainFormItem=a.getCheckedOptions=a.enabledColumn=a.domainColumn=void 0,r(84464);var n=i(r(590)),o=i(r(3787)),u=i(r(60147)),s=i(r(89195)),d=i(r(29672)),c=i(r(23872)),f=(r(77800),r(40293)),m=i(r(35613)),p=i(r(77186)),h=(a.statusTypes=[{label:t("Enable"),value:!0},{label:t("Forbidden"),value:!1}],e=>{var t,{baseDomains:a}=p.default,{domains:r}=m.default,l=(0,o.default)(t=r||[]).call(t,(t=>(-1===(0,u.default)(a).call(a,t.name)||t.id===(e.item||{}).domain_id)&&!!t.enabled));return(0,s.default)(l).call(l,(e=>({label:e.name,value:e.id,key:e.id})))});a.getDomainOptions=h;var v=()=>{var e,{domains:t}=m.default;return(0,s.default)(e=t||[]).call(e,(e=>({label:e.name,value:e.id,key:e.id})))};a.getCheckedOptions=v;a.getDomainFormItem=e=>({name:"domain_id",label:t("Affiliated Domain"),type:"select",checkOptions:v(),checkBoxInfo:t("Show All Domain"),options:h(e),allowClear:!1,onChange:t=>{e.setState({domain:t})},required:!0});a.enabledColumn={title:t("Enabled"),dataIndex:"enabled",isHideable:!0,render:e=>!0===e?c.default.createElement(n.default,{color:"green",text:t("Yes")}):c.default.createElement(n.default,{color:"red",text:t("No")}),stringify:e=>e?t("Yes"):t("No")};var g=a.domainColumn={dataIndex:"domainName",title:t("Domain ID/Name"),render:(e,t)=>c.default.createElement(c.default.Fragment,null,c.default.createElement("div",null,(0,f.getIdRender)(t.domain_id,!0,!1)),c.default.createElement("div",null,e))};a.projectDomainColumns=[{dataIndex:"name",title:t("Project ID/Name"),render:(e,t)=>c.default.createElement(c.default.Fragment,null,c.default.createElement("div",null,(0,f.getIdRender)(t.id,!0,!1)),c.default.createElement("div",null,e))},g],a.userDomainColumns=[{dataIndex:"name",title:t("User ID/Name"),render:(e,t)=>c.default.createElement(c.default.Fragment,null,c.default.createElement("div",null,(0,f.getIdRender)(t.id,!0,!1)),c.default.createElement("div",null,e))},g],a.groupDomainColumns=[{dataIndex:"name",title:t("User Group ID/Name"),render:(e,t)=>c.default.createElement(c.default.Fragment,null,c.default.createElement("div",null,(0,f.getIdRender)(t.id,!0,!1)),c.default.createElement("div",null,e))},g];a.transferFilterOption=(e,t)=>{var{domainName:a,name:r,id:l}=t;return(0,d.default)(l).call(l,e)||(0,d.default)(r).call(r,e)||(0,d.default)(a).call(a,e)}},64893:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.SystemRole=void 0;var n=i(r(89195)),o=i(r(32462)),u=i(r(29672)),s=i(r(24836)),d=i(r(60147)),c=i(r(1839)),f=i(r(77879)),m=r(87067),p=r(60615),h=r(61362),v=i(r(77969));class g extends p.ModalAction{constructor(){var e;super(...arguments),e=this,(0,f.default)(this,"onSubmit",function(){var t=(0,c.default)((function*(t){var{role:a}=t,{systemRoles:r,id:l}=e.item,i=[],d=a?[a]:[],c=(0,n.default)(r).call(r,(e=>e.id));return(0,o.default)(r).call(r,(t=>{var{id:a}=t;(0,u.default)(d).call(d,a)||i.push(e.store.deleteSystemRole({id:l,roleId:a}))})),(0,o.default)(d).call(d,(t=>{(0,u.default)(c).call(c,t)||i.push(e.store.assignSystemRole({id:l,roleId:t}))})),yield s.default.all(i)}));return function(e){return t.apply(this,arguments)}}())}init(){this.store=new h.UserStore,this.roleStore=v.default,this.getRoleList()}getRoleList(){this.roleStore.fetchSystemRoles()}get name(){return t("edit system permission")}get rolesList(){var e;return(0,n.default)(e=this.roleStore.systemRoles.data||[]).call(e,(e=>({label:e.name,value:e.id})))}get defaultValue(){var{name:e,systemRoles:t=[]}=this.item,a=(0,n.default)(t).call(t,(e=>e.id))[0];return a?{name:e,role:a}:{name:e}}static allowed(e,t){var{match:{path:a=""}={}}=t||{};return(0,d.default)(a).call(a,"domain-admin/detail")>=0?s.default.resolve(!1):s.default.resolve(!0)}get formItems(){return[{name:"name",label:t("User"),type:"label",iconType:"user"},{name:"role",label:t("Role"),type:"select",options:this.rolesList,loading:this.roleStore.systemRoles.isLoading}]}}a.SystemRole=g,(0,f.default)(g,"id","edit-system-permission"),(0,f.default)(g,"title",t("Edit System Permission")),(0,f.default)(g,"policy","identity:list_roles");a.default=(0,m.inject)("rootStore")((0,m.observer)(g))},66413:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.Create=void 0;var n=i(r(68982)),o=i(r(24836)),u=i(r(77879)),s=r(87067),d=i(r(35613)),c=r(60615),f=r(64562),m=r(27567);class p extends c.ModalAction{constructor(){super(...arguments),(0,u.default)(this,"nameValidator",((e,a)=>{var r=(0,m.toJS)(this.currentList);return(0,n.default)(r).call(r,(e=>e.name===a))?o.default.reject(new Error(t("Invalid: Domain name cannot be duplicated"))):o.default.resolve(!0)})),(0,u.default)(this,"onSubmit",(e=>(e.enabled=e.enabled.value,this.store.create(e))))}init(){this.store=d.default}static allowed(){return o.default.resolve(!0)}get name(){return t("Create Domain")}get defaultValue(){return{enabled:f.statusTypes[0]}}get currentList(){var{list:{data:e=[]}={}}=this.store;return e}get formItems(){return[{name:"name",label:t("Name"),type:"input",placeholder:t("Please input name"),required:!0,validator:this.nameValidator},{name:"description",label:t("Description"),type:"textarea"},{name:"enabled",label:t("Status"),type:"radio",optionType:"default",options:f.statusTypes,required:!0,isWrappedValue:!0,help:t("Forbidden the domain will have a negative impact, all project and user in domain will be forbidden")}]}}a.Create=p,(0,u.default)(p,"id","domain-create"),(0,u.default)(p,"title",t("Create Domain")),(0,u.default)(p,"policy","identity:create_domain");a.default=(0,s.inject)("rootStore")((0,s.observer)(p))},72097:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.Create=void 0;var n=i(r(24836)),o=i(r(68982)),u=i(r(77879)),s=r(87067),d=r(60615),c=i(r(35613)),f=i(r(53884)),m=r(64562);class p extends d.ModalAction{constructor(){super(...arguments),(0,u.default)(this,"checkName",((e,a)=>{if(!a)return n.default.reject(t("Please input"));var r=this.formRef.current.getFieldValue("domain_id");if(!r)return n.default.resolve();var{list:{data:l=[]}={}}=this.store;return(0,o.default)(l).call(l,(e=>e.name===a&&e.domain_id===r))?n.default.reject(t("Invalid: User Group names in the domain can not be repeated")):n.default.resolve()})),(0,u.default)(this,"onSubmit",(e=>this.store.create(e)))}init(){this.store=f.default,this.domainStore=c.default,this.domainStore.fetchDomain()}static allowed(){return n.default.resolve(!0)}get name(){return t("Create User Group")}get defaultValue(){return{domain_id:"default"}}get formItems(){var e=(0,m.getDomainFormItem)(this);return[{name:"name",label:t("User Group Name"),type:"input",placeholder:t("Please input name"),required:!0,validator:this.checkName,extra:t("User Groups")+t("Name can not be duplicated"),maxLength:30,dependencies:["domain_id"]},e,{name:"description",label:t("Description"),type:"textarea"}]}}a.Create=p,(0,u.default)(p,"id","user-group-create"),(0,u.default)(p,"title",t("Create User Group")),(0,u.default)(p,"policy","identity:create_group");a.default=(0,s.inject)("rootStore")((0,s.observer)(p))},74117:(e,t,a)=>{"use strict";var r=a(33950),l=a(48924);r(t,"__esModule",{value:!0}),t.default=void 0;var i=l(a(66413)),n=l(a(20156)),o=l(a(35373)),u=l(a(38800)),s=l(a(96882)),d={rowActions:{firstAction:o.default,moreActions:[{action:n.default},{action:u.default},{action:s.default}]},batchActions:[n.default],primaryActions:[i.default]};t.default=d},75198:(e,t,a)=>{"use strict";var r=a(33950),l=a(48924);r(t,"__esModule",{value:!0}),t.default=void 0;var i=l(a(65512)),n=l(a(23032));t.default=e=>(0,i.default)(n.default,e)},77969:(e,t,a)=>{"use strict";var r=a(18565),l=a(13696),i=a(3787),n=a(10732),o=a(32462),u=a(10819),s=a(22338),d=a(33950),c=a(48924);d(t,"__esModule",{value:!0}),t.default=t.RoleStore=void 0;var f,m,p,h=c(a(3787)),v=c(a(10732)),g=c(a(1839)),b=c(a(37187)),y=c(a(77879)),j=c(a(33301)),_=(c(a(55041)),a(27567)),D=c(a(92621)),C=c(a(81891)),S=c(a(31440));function x(e,t){var a=r(e);if(l){var o=l(e);t&&(o=i(o).call(o,(function(t){return n(e,t).enumerable}))),a.push.apply(a,o)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?o(a=x(Object(l),!0)).call(a,(function(t){(0,y.default)(e,t,l[t])})):u?s(e,u(l)):o(r=x(Object(l))).call(r,(function(t){d(e,t,n(l,t))}))}return e}var I=new(t.RoleStore=(f=class extends C.default{constructor(){super(...arguments),(0,b.default)(this,"implyRoles",m,this),(0,b.default)(this,"systemRoles",p,this),(0,y.default)(this,"checkSystemRole",(e=>"admin"===e.name||"reader"===e.name))}get client(){return D.default.keystone.roles}detailDidFetch(e){var t=this;return(0,g.default)((function*(){var{id:a}=e,{role_inference:{implies:r=[]}={}}=yield t.client.implies.list(a);return R(R({},e),{},{implies:r})}))()}fetchSystemRoles(){var e=this;return(0,g.default)((function*(){e.systemRoles.isLoading=!0;var t=yield e.client.list(),{roles:a=[]}=t,r=(0,h.default)(a).call(a,(t=>e.checkSystemRole(t)));return e.systemRoles.data=r,e.systemRoles.isLoading=!1,r}))()}update(e,t){var{id:a}=e,r={};return r[this.responseKey]=t,this.submitting(this.client.patch(a,r))}},m=(0,j.default)(f.prototype,"implyRoles",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),p=(0,j.default)(f.prototype,"systemRoles",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new S.default}}),(0,j.default)(f.prototype,"fetchSystemRoles",[_.action],(0,v.default)(f.prototype,"fetchSystemRoles"),f.prototype),(0,j.default)(f.prototype,"update",[_.action],(0,v.default)(f.prototype,"update"),f.prototype),f));t.default=I},80357:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.Edit=void 0;var n=i(r(24836)),o=i(r(1839)),u=i(r(77879)),s=r(87067),d=r(60615),c=i(r(77969)),f=r(80726);class m extends d.ModalAction{constructor(){var e;super(...arguments),e=this,(0,u.default)(this,"onSubmit",function(){var t=(0,o.default)((function*(t){var{id:a}=e.item;return e.store.update({id:a},t)}));return function(e){return t.apply(this,arguments)}}())}init(){this.store=c.default}get defaultValue(){var{name:e,description:t}=this.item;return{name:e,description:t}}get formItems(){return[{name:"name",label:t("Name"),type:"input",required:!0},{name:"description",label:t("Description"),type:"textarea"}]}}a.Edit=m,(0,u.default)(m,"id","role-edit"),(0,u.default)(m,"title",t("Edit Role")),(0,u.default)(m,"buttonText",t("Edit")),(0,u.default)(m,"policy","identity:update_role"),(0,u.default)(m,"allowed",(e=>n.default.resolve((0,f.editable)(e))));a.default=(0,s.inject)("rootStore")((0,s.observer)(m))},80726:(e,t,a)=>{"use strict";var r=a(33950),l=a(48924);r(t,"__esModule",{value:!0}),t.roleFilterOption=t.editable=void 0;var i=l(a(29672));t.editable=e=>{var{options:{immutable:t}={}}=e||{};return!t&&"true"!==t&&"True"!==t};t.roleFilterOption=(e,t)=>{var a,{label:r=""}=t;return(0,i.default)(a=r.toLowerCase()).call(a,(e||"").toLowerCase())}},83247:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.ModifyTags=void 0;var n=i(r(24836)),o=i(r(75613)),u=i(r(29672)),s=i(r(77879)),d=i(r(36936)),c=i(r(23872)),f=r(87067),m=r(60615),p=i(r(15348)),h=i(r(22185));class v extends m.ModalAction{constructor(){super(...arguments),(0,s.default)(this,"onSubmit",(e=>h.default.update({project_id:this.props.item.id},e)))}get name(){return t("modify project tags")}init(){this.state={tags:this.props.item.tags}}get formItems(){var{tags:e}=this.state;return[{name:"tags",label:t("Tags"),component:c.default.createElement(p.default,{tags:e}),validator:(e,a)=>{var r=this.props.item.tags||[];if((0,d.default)(a,r))return n.default.resolve(!0);var l="";return(0,o.default)(a).call(a,(e=>{var t=(0,u.default)(e).call(e,"/")||(0,u.default)(e).call(e,",");return t&&(l=e),t}))?n.default.reject(new Error(t("Invalid Tag Value: {tag}",{tag:l}))):(0,o.default)(r).call(r,(function(e){return(0,o.default)(a).call(a,(t=>{var a=e!==t&&t.toLowerCase()===e.toLowerCase();return a&&(l=t),a}))}))?n.default.reject(new Error(t("Duplicate tag name: {tag}",{tag:l}))):n.default.resolve(!0)},extra:c.default.createElement("div",null,c.default.createElement("div",null,"1. ",t("Tags are not case sensitive")),c.default.createElement("div",null,"2. ",t("Forward Slash ‘/’ is not allowed to be in a tag name")),c.default.createElement("div",null,"3."," ",t("Commas ‘,’ are not allowed to be in a tag name in order to simplify requests that specify lists of tags")))}]}}a.ModifyTags=v,(0,s.default)(v,"id","modify-project-tags"),(0,s.default)(v,"title",t("Modify Project Tags")),(0,s.default)(v,"buttonText",t("Modify Project Tags")),(0,s.default)(v,"policy","identity:update_project_tags"),(0,s.default)(v,"allowed",(()=>n.default.resolve(!0)));a.default=(0,f.inject)("rootStore")((0,f.observer)(v))},84939:(e,t,a)=>{var r=a(29891);"string"==typeof r&&(r=[[e.id,r,""]]);var l={hmr:!0,transform:undefined,insertInto:void 0};a(53027)(r,l);r.locals&&(e.exports=r.locals)},87361:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.EditForm=void 0;var n=i(r(24836)),o=i(r(68982)),u=i(r(77879)),s=r(87067),d=r(60615),c=i(r(53884));class f extends d.ModalAction{constructor(){super(...arguments),(0,u.default)(this,"checkName",((e,a)=>{if(!a)return n.default.reject(t("Please input"));var{list:{data:r}}=this.store,{id:l}=this.item;return(0,o.default)(r).call(r,(e=>e.name===a&&e.id!==l&&e.domain_id===this.item.domain_id))?n.default.reject(t("Invalid: User Group names in the domain can not be repeated")):n.default.resolve()})),(0,u.default)(this,"onSubmit",(e=>{var{description:t,name:a}=e,{id:r}=this.item;return c.default.edit({id:r,description:t,name:a})}))}init(){this.store=c.default}static allowed(){return n.default.resolve(!0)}get defaultValue(){var{name:e,description:t}=this.item;return{name:e,description:t}}get formItems(){return[{name:"name",label:t("User Group Name"),type:"input",placeholder:t("Please input name"),required:!0,validator:this.checkName,extra:t("User Groups")+t("Name can not be duplicated")},{name:"description",label:t("Description"),type:"textarea"}]}}a.EditForm=f,(0,u.default)(f,"id","user-group-edit"),(0,u.default)(f,"title",t("Edit")),(0,u.default)(f,"policy","identity:update_group");a.default=(0,s.inject)("rootStore")((0,s.observer)(f))},87777:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.Role=void 0;var n=i(r(77879)),o=r(87067),u=i(r(54017)),s=i(r(77969)),d=i(r(28237));class c extends u.default{constructor(){super(...arguments),(0,n.default)(this,"getColumns",(()=>[{title:t("Role Name"),dataIndex:"name",routeName:"roleDetailAdmin",withoutId:!0},{title:t("ID"),dataIndex:"id",isHideable:!0,copyable:!0},{title:t("Description"),dataIndex:"description",isHideable:!0}]))}init(){this.store=s.default}get policy(){return"identity:list_roles"}get name(){return t("roles")}get isFilterByBackend(){return!1}get actionConfigs(){return d.default}get searchFilters(){return[{label:t("Role Name"),name:"name"}]}}a.Role=c;a.default=(0,o.inject)("rootStore")((0,o.observer)(c))},92322:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.SetDefaultProject=void 0;var n=i(r(24836)),o=i(r(77879)),u=r(87067),s=r(60615);class d extends s.FormAction{static allowed(){return n.default.resolve(!0)}get name(){return t("Set Default Project")}}a.SetDefaultProject=d,(0,o.default)(d,"id","set-default-project"),(0,o.default)(d,"title",t("Set Default Project")),(0,o.default)(d,"path",(e=>"/identity/user-admin/detail/".concat(e.id,"?tab=project")));a.default=(0,u.inject)("rootStore")((0,u.observer)(d))},93682:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=a.SetDefaultProject=void 0;var n=i(r(24836)),o=i(r(77879)),u=r(87067),s=r(60615),d=i(r(61362));class c extends s.ModalAction{constructor(){super(...arguments),(0,o.default)(this,"onSubmit",((e,t)=>{var{detail:{id:a}}=t;return d.default.setDefaultProject(a,this.item.id)}))}get name(){return t("Set default project for user")}get formItems(){return[{name:"name",type:"label",content:t("Are you sure set the project { project } as the default project? User login is automatically logged into the default project.",{project:this.item.name}),wrapperCol:{xs:{span:24},sm:{span:24}}}]}}a.SetDefaultProject=c,(0,o.default)(c,"id","set-default-project"),(0,o.default)(c,"title",t("Set Default Project")),(0,o.default)(c,"policy","identity:update_user"),(0,o.default)(c,"policy","identity:update_user"),(0,o.default)(c,"allowed",((e,t)=>{var{detail:a}=t||{},{default_project_id:r}=a;return n.default.resolve(r!==e.id)}));a.default=(0,u.inject)("rootStore")((0,u.observer)(c))},94042:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=void 0;var n=i(r(77879)),o=r(60615),u=i(r(77969)),s=r(80726);class d extends o.ConfirmAction{constructor(){super(...arguments),(0,n.default)(this,"policy","identity:delete_role"),(0,n.default)(this,"allowedCheckFunc",(e=>(0,s.editable)(e))),(0,n.default)(this,"onSubmit",(e=>{var{id:t}=e;return u.default.delete({id:t})}))}get id(){return"delete"}get title(){return t("Delete Role")}get isDanger(){return!0}get buttonText(){return t("Delete")}get actionName(){return t("delete role")}}a.default=d},94092:(e,t,a)=>{"use strict";var r=a(33950),l=a(48924);r(t,"__esModule",{value:!0}),t.default=t.actionConfigsInUserDetail=void 0;var i=l(a(17987)),n=l(a(10922)),o=l(a(95655)),u=l(a(30667)),s=l(a(33846)),d=l(a(4418)),c=l(a(42009)),f=l(a(29031)),m=l(a(83247)),p=l(a(93682)),h=l(a(30200)),v={rowActions:{firstAction:n.default,moreActions:[{action:i.default},{action:f.default},{action:d.default},{action:c.default},{action:o.default},{action:u.default},{action:m.default}]},batchActions:[i.default],primaryActions:[s.default]};t.actionConfigsInUserDetail={rowActions:{firstAction:null,moreActions:[{action:p.default}]},primaryActions:[h.default]},t.default=v},95655:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=void 0;var n=i(r(77879)),o=r(60615),u=i(r(52740));class s extends o.ConfirmAction{constructor(){super(...arguments),(0,n.default)(this,"policy","identity:update_project"),(0,n.default)(this,"allowedCheckFunc",(e=>!e||this.isEnable(e))),(0,n.default)(this,"onSubmit",(()=>{var{id:e}=this.item;return u.default.enable({id:e})}))}get id(){return"Enable"}get title(){return t("Enable Project")}get buttonText(){return t("Enable")}get actionName(){return t("Enable Project")}isEnable(e){return!0!==e.enabled}}a.default=s},96882:(e,a,r)=>{"use strict";var l=r(33950),i=r(48924);l(a,"__esModule",{value:!0}),a.default=void 0;var n=i(r(89195)),o=i(r(77879)),u=i(r(20173)),s=r(60615),d=i(r(35613));class c extends s.ConfirmAction{constructor(){super(...arguments),(0,o.default)(this,"policy","identity:update_domain"),(0,o.default)(this,"allowedCheckFunc",(e=>!e||this.isForbidden(e))),(0,o.default)(this,"confirmContext",(e=>{var a=(0,u.default)(e)?(0,n.default)(e).call(e,(e=>e.name)).join(","):e.name;return t("Are you sure to forbidden domain { name }? Forbidden the domain will have negative effect, and users associated with the domain will not be able to log in if they are only assigned to the domain",{name:a})})),(0,o.default)(this,"onSubmit",(()=>{var{id:e}=this.item;return d.default.forbidden({id:e})}))}get id(){return"Forbidden"}get title(){return t("Forbidden Domain")}get buttonText(){return t("Forbidden")}get actionName(){return t("Forbidden Domain")}get isDanger(){return!0}isForbidden(e){return!1!==e.enabled}}a.default=c}}]);