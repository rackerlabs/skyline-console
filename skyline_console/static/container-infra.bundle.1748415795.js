"use strict";(self.webpackChunkskyline_console=self.webpackChunkskyline_console||[]).push([[845],{1031:(e,a,r)=>{r(33950)(a,"__esModule",{value:!0}),a.healthStatus=a.defaultTip=a.clusterStatus=void 0;a.clusterStatus={CREATE_IN_PROGRESS:t("CREATE IN PROGRESS"),CREATE_COMPLETE:t("CREATE COMPLETE"),CREATE_FAILED:t("CREATE FAILED"),UPDATE_IN_PROGRESS:t("UPDATE IN PROGRESS"),UPDATE_COMPLETE:t("UPDATE COMPLETE"),UPDATE_FAILED:t("UPDATE FAILED"),DELETE_IN_PROGRESS:t("DELETE_IN PROGRESS"),DELETE_COMPLETE:t("DELETE COMPLETE"),DELETE_FAILED:t("DELETE FAILED"),RESUME_COMPLETE:t("RESUME COMPLETE"),RESUME_FAILED:t("RESUME FAILED"),RESTORE_COMPLETE:t("RESTORE COMPLETE"),ROLLBACK_IN_PROGRESS:t("ROLLBACK IN PROGRESS"),ROLLBACK_COMPLETE:t("ROLLBACK COMPLETE"),ROLLBACK_FAILED:t("ROLLBACK FAILED"),SNAPSHOT_COMPLETE:t("SNAPSHOT COMPLETE"),CHECK_COMPLETE:t("CHECK COMPLETE"),ADOPT_COMPLETE:t("ADOPT COMPLETE")},a.healthStatus={HEALTHY:t("HEALTHY"),UNHEALTHY:t("UNHEALTHY"),UNKNOWN:t("UNKNOWN")},a.defaultTip=t("If itâ€™s not set, the value of this in the template will be used.")},5128:(e,a,r)=>{var l=r(33950),n=r(48924);l(a,"__esModule",{value:!0}),a.default=a.StepLabel=void 0;var i=n(r(89195)),o=n(r(18565)),s=n(r(78711)),d=r(87067),u=n(r(62731));class c extends s.default{get title(){return t("Labels")}get name(){return t("Labels")}get defaultValue(){var e,t={},{context:{clusterTemplate:a={}}={}}=this.props,{selectedRows:r=[]}=a,{labels:l={}}=r[0]||{};return t.additionalLabels=(0,i.default)(e=(0,o.default)(l||{})).call(e,(e=>({value:{key:e,value:l[e]}}))),t}get formItems(){return[{name:"additionalLabels",label:t("Additional Labels"),type:"add-select",itemComponent:u.default,addText:t("Add Label"),onChange:e=>{this.updateContext({additionalLabels:e})}}]}}a.StepLabel=c;a.default=(0,d.inject)("rootStore")((0,d.observer)(c))},8009:(e,a,r)=>{var l=r(33950),n=r(48924);l(a,"__esModule",{value:!0}),a.default=a.BaseDetail=void 0;var i=n(r(19989)),o=n(r(89195)),s=n(r(77481)),d=n(r(71573)),u=n(r(42181)),c=r(87067),f=n(r(23872));class m extends u.default{get leftCards(){return[this.templateCard,this.networkCard,this.miscellaneousCard]}get rightCards(){return[this.nodesCard,this.labelCard,this.stackCard]}get templateCard(){var{template:e={}}=this.detailData,a=null!=e&&e.name?this.getLinkRender("containerInfraClusterTemplateDetail",e.name,{id:e.uuid}):"-",r=[{label:t("Name"),dataIndex:"template.name",content:a},{label:t("COE"),dataIndex:"template.coe"}];return{title:t("Cluster Template"),options:r,labelCol:6,contentCol:18}}get networkCard(){var e,a,{fixed_network:r,original_fixed_network:l,fixedNetwork:{name:n}={},fixed_subnet:o,original_fixed_subnet:s,fixedSubnet:{name:d}={}}=this.detailData||{},u=l?(0,i.default)(e="".concat(l," (")).call(e,t("The resource has been deleted"),")"):r?this.getLinkRender("networkDetail",n||r,{id:r}):"-",c=s?(0,i.default)(a="".concat(s," (")).call(a,t("The resource has been deleted"),")"):r&&o?this.getLinkRender("subnetDetail",d||o,{networkId:r,id:o}):"-",f=[{label:t("Fixed Network"),content:u},{label:t("Fixed Subnet"),content:c}];return{title:t("Network"),options:f}}get miscellaneousCard(){var e,{original_keypair:a,keypair:r}=this.detailData,l=a?(0,i.default)(e="".concat(a," (")).call(e,t("The resource has been deleted"),")"):r?this.getLinkRender("keypairDetail",r,{id:r}):"-",n=[{label:t("Discovery URL"),dataIndex:"discovery_url",render:e=>e?f.default.createElement("a",{href:e,target:"blank"},e):"-"},{label:t("Timeout(Minute)"),dataIndex:"create_timeout"},{label:t("Keypair"),content:l,hidden:this.isAdminPage},{label:t("Docker Volume Size (GiB)"),dataIndex:"docker_volume_size"},{label:t("COE Version"),dataIndex:"coe_version"},{label:t("Container Version"),dataIndex:"container_version"}];return{title:t("Miscellaneous"),options:n,labelCol:12,contentCol:12}}get nodesCard(){var e,a,{master_flavor_id:r,original_master_flavor_id:l,masterFlavor:{name:n}={},flavor_id:s,original_flavor_id:d,flavor:{name:u}={}}=this.detailData,c=l?(0,i.default)(e="".concat(l," (")).call(e,t("The resource has been deleted"),")"):r?this.getLinkRender("flavorDetail",n||r,{id:r}):"-",m=d?(0,i.default)(a="".concat(d," (")).call(a,t("The resource has been deleted"),")"):s?this.getLinkRender("flavorDetail",u||s,{id:s}):"-",p=[{label:t("Master Node Flavor"),content:c},{label:t("Number of Master Nodes"),dataIndex:"master_count"},{label:t("Node Flavor"),content:m},{label:t("Number of Nodes"),dataIndex:"node_count"},{label:t("API Address"),dataIndex:"api_address"},{label:t("Master Node Addresses"),dataIndex:"master_addresses",render:e=>e&&e.length?(0,o.default)(e).call(e,(e=>f.default.createElement("div",null,e))):"-"},{label:t("Node Addresses"),dataIndex:"node_addresses",render:e=>e&&e.length?(0,o.default)(e).call(e,(e=>f.default.createElement("div",null,e))):"-"}];return{title:t("Nodes"),labelCol:3,options:p}}get labelCard(){var e=[{label:t("Labels"),dataIndex:"labels",render:e=>{var t;return(0,d.default)(e)?"-":f.default.createElement("ul",null,(0,o.default)(t=(0,s.default)(e)).call(t,(e=>{var[t,a]=e;return f.default.createElement("li",{key:t},t," : ",a)})))}}];return{title:t("Additional Labels"),labelCol:2,options:e}}get stackCard(){var{stack:{id:e,stack_name:a}={}}=this.detailData||{},r=e?this.getLinkRender("stackDetail",e,{id:e,name:a}):"-",l=[{label:t("Stack ID"),dataIndex:"stack_id",content:r},{label:t("Stack Faults"),dataIndex:"faults",render:e=>{var t;return(0,d.default)(e)?"-":f.default.createElement("ul",null,(0,o.default)(t=(0,s.default)(e)).call(t,(e=>{var[t,a]=e;return f.default.createElement("li",{key:t},t," : ",a)})))}}];return{title:t("Stack"),labelCol:2,options:l}}get healthCard(){var e,{health_status_reason:a={}}=this.detailData||{},r=(0,d.default)(a)?"-":f.default.createElement("ul",null,(0,o.default)(e=(0,s.default)(a)).call(e,(e=>{var[t,a]=e;return f.default.createElement("li",{key:t},t," : ",a)}))),l=[{label:t("Log"),content:r}];return{title:t("Health Checking Log"),labelCol:2,options:l}}}a.BaseDetail=m;a.default=(0,c.inject)("rootStore")((0,c.observer)(m))},8545:(e,a,r)=>{var l=r(18565),n=r(13696),i=r(3787),o=r(10732),s=r(32462),d=r(10819),u=r(22338),c=r(33950),f=r(48924);c(a,"__esModule",{value:!0}),a.default=a.StepCreate=void 0;var m=f(r(32462)),p=f(r(24836)),v=f(r(68982));r(98368);var h=f(r(6174)),g=f(r(1839)),_=f(r(49849)),b=f(r(77879)),k=r(87067),S=r(27567),y=r(60615),w=f(r(13389)),x=f(r(52740)),C=f(r(64391)),N=r(83575),E=(r(77800),f(r(31346))),I=f(r(76451)),L=f(r(33235)),T=f(r(91499)),R=f(r(5128)),D=["additionalLabels","clusterTemplate","keypair","auto_healing_enabled","auto_scaling_enabled","newNetwork","fixedNetwork","fixedSubnet","flavor","masterFlavor"];function P(e,t){var a=l(e);if(n){var r=n(e);t&&(r=i(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?s(a=P(Object(l),!0)).call(a,(function(t){(0,b.default)(e,t,l[t])})):d?u(e,d(l)):s(r=P(Object(l))).call(r,(function(t){c(e,t,o(l,t))}))}return e}class F extends y.StepAction{constructor(){super(...arguments),(0,b.default)(this,"onSubmit",(e=>{var{additionalLabels:t,clusterTemplate:a,keypair:r,auto_healing_enabled:l,auto_scaling_enabled:n,newNetwork:i,fixedNetwork:o,fixedSubnet:s,flavor:d,masterFlavor:u}=e,c=(0,_.default)(e,D),f={};t&&(0,m.default)(t).call(t,(e=>{var t=e.value.key,a=e.value.value;f[t]=a}));var p=A(A({},c),{},{name:e.name,labels:A(A({},f),{},{auto_healing_enabled:"".concat(!!l),auto_scaling_enabled:"".concat(!!n)}),cluster_template_id:a.selectedRowKeys[0],keypair:r&&r.selectedRowKeys[0]||null,master_flavor_id:u&&u.selectedRowKeys[0]||null,flavor_id:d&&d.selectedRowKeys[0]||null,fixed_network:!i&&o.selectedRowKeys[0]||null,fixed_subnet:!i&&s.selectedRowKeys[0]||null});return this.store.create(p)}))}init(){this.store=w.default,this.projectStore=x.default,this.state.quotaLoading=!0,this.getQuota(),this.errorMsg=""}static allowed(){return p.default.resolve(!0)}get name(){return t("Create Cluster")}get listUrl(){return this.getRoutePath("containerInfraClusters")}get hasConfirmStep(){return!1}get steps(){return[{title:t("Cluster Info"),component:E.default},{title:t("Node Spec"),component:I.default},{title:t("Network Setting"),component:L.default},{title:t("Management"),component:T.default},{title:t("Additional Labels"),component:R.default}]}get enableCinder(){return this.props.rootStore.checkEndpoint("cinder")}get flavors(){return(0,S.toJS)(C.default.list.data)||[]}get showQuota(){return!0}getQuota(){var e=this;return(0,g.default)((function*(){e.setState({quotaLoading:!0}),yield p.default.all([e.projectStore.fetchProjectNovaQuota(),e.projectStore.fetchProjectMagnumQuota(),e.enableCinder?e.projectStore.fetchProjectCinderQuota():null]),e.setState({quotaLoading:!1})}))()}get disableNext(){return!!this.errorMsg}get disableSubmit(){return!!this.errorMsg}get quotaInfo(){var{quotaLoading:e}=this.state;if(e)return[];var a=this.checkQuotaInput(),{magnum_cluster:r={}}=(0,S.toJS)(this.projectStore.magnumQuota)||{},l=A(A({},r),{},{add:a?0:1,name:"cluster",title:t("Clusters")}),{newNodes:n}=this.getNodesInput(),{instances:i={},cores:o={},ram:s={}}=(0,S.toJS)(this.projectStore.novaQuota)||{},d=A(A({},i),{},{add:a?0:n,name:"instance",title:t("Instance"),type:"line"}),{newCPU:u,newRam:c}=this.getFlavorInput(),f=A(A({},o),{},{add:a?0:u,name:"cpu",title:t("CPU"),type:"line"}),m=A(A({},s),{},{add:a?0:c,name:"ram",title:t("Memory (GiB)"),type:"line"}),{volumes:p}=(0,S.toJS)(this.projectStore.cinderQuota)||{};return[l,d,f,m,A(A({},p),{},{add:a?0:n,name:"volume",title:t("Volume"),type:"line"})]}checkClusterQuota(){var{quotaLoading:e}=this.state;if(e)return"";var{magnum_cluster:a={}}=(0,S.toJS)(this.projectStore.magnumQuota)||{},{left:r=0}=a;return 0===r?this.getQuotaMessage(1,a,t("Clusters")):""}getNodesInput(){var{data:e={}}=this.state,{node_count:t=0,master_count:a=0}=e;return{newNodes:t+a}}checkInstanceQuota(){var{quotaLoading:e}=this.state;if(e)return"";var{newNodes:a}=this.getNodesInput(),{instances:r={}}=this.projectStore.novaQuota||{},{left:l=0}=r;return-1!==l&&l<a?this.getQuotaMessage(a,r,t("Instance")):""}get templateFlavor(){var e,t,{data:a={}}=this.state,{clusterTemplate:{selectedRows:r=[]}={}}=a,{master_flavor_id:l,flavor_id:n}=r[0]||{};return{masterTemplateFlavor:(0,v.default)(e=this.flavors).call(e,(e=>e.id===l)),workTemplateFlavor:(0,v.default)(t=this.flavors).call(t,(e=>e.id===n))}}getFlavorInput(){var{data:e={}}=this.state,{flavor:{selectedRows:t=[]}={},node_count:a=1,masterFlavor:{selectedRows:r=[]}={},master_count:l=1}=e,{vcpus:n=0,ram:i=0}=t[0]||this.templateFlavor.workTemplateFlavor||{},o=(0,N.getGiBValue)(i),{vcpus:s=0,ram:d=0}=r[0]||this.templateFlavor.masterTemplateFlavor||{};return{newCPU:n*a+s*l,newRam:o*a+(0,N.getGiBValue)(d)*l}}checkFlavorQuota(){var{newCPU:e,newRam:a}=this.getFlavorInput(),{cores:r={},ram:l={}}=this.projectStore.novaQuota||{},{left:n=0}=r||{},{left:i=0}=l||{};return-1!==n&&n<e?this.getQuotaMessage(e,r,t("CPU")):-1!==i&&i<a?this.getQuotaMessage(a,l,t("Memory")):""}checkVolumeQuota(){var{quotaLoading:e}=this.state;if(e)return"";var{newNodes:a}=this.getNodesInput(),{volumes:r}=(0,S.toJS)(this.projectStore.cinderQuota)||{},{left:l=0}=r;return-1!==l&&l<a?this.getQuotaMessage(a,r,t("Volume")):""}checkQuotaInput(){var e=this.checkClusterQuota(),t=this.checkInstanceQuota(),a=this.checkFlavorQuota(),r=this.checkVolumeQuota(),l=e||t||a||r;return l?(this.status="error",this.errorMsg!==l&&h.default.error(l),this.errorMsg=l,l):(this.status="success",this.errorMsg="","")}getQuotaMessage(e,a,r){var{left:l=0}=a||{};return-1===l?"":e>l?t("Insufficient {name} quota to create resources (left { quota }, input { input }).",{name:r,quota:l,input:e}):""}}a.StepCreate=F,(0,b.default)(F,"id","create-cluster"),(0,b.default)(F,"title",t("Create Cluster")),(0,b.default)(F,"path","/container-infra/clusters/create"),(0,b.default)(F,"policy","cluster:create");a.default=(0,k.inject)("rootStore")((0,k.observer)(F))},11052:(e,t,a)=>{var r=a(33950),l=a(48924);r(t,"__esModule",{value:!0}),t.default=void 0;var n=l(a(21888)),i=l(a(30916)),o=l(a(16300)),s=l(a(52296)),d=l(a(38930)),u=l(a(25382)),c=l(a(8545)),f=l(a(60239)),m=l(a(64584)),p="/container-infra";t.default=[{path:p,component:n.default,routes:[{path:"".concat(p,"/clusters"),component:o.default,exact:!0},{path:"".concat(p,"/clusters/detail/:id"),component:s.default,exact:!0},{path:"".concat(p,"/clusters/create"),component:c.default,exact:!0},{path:"".concat(p,"/clusters-admin"),component:o.default,exact:!0},{path:"".concat(p,"/clusters-admin/detail/:id"),component:s.default,exact:!0},{path:"".concat(p,"/cluster-template"),component:d.default,exact:!0},{path:"".concat(p,"/cluster-template/detail/:id"),component:u.default,exact:!0},{path:"".concat(p,"/cluster-template/create"),component:f.default,exact:!0},{path:"".concat(p,"/cluster-template/update/:id"),component:m.default,exact:!0},{path:"".concat(p,"/cluster-template-admin"),component:d.default,exact:!0},{path:"".concat(p,"/cluster-template-admin/detail/:id"),component:u.default,exact:!0},{path:"*",component:i.default}]}]},11964:(e,a,r)=>{var l=r(33950),n=r(48924);l(a,"__esModule",{value:!0}),a.default=a.BaseDetail=void 0;var i=n(r(19989)),o=n(r(89195)),s=n(r(77481)),d=n(r(71573)),u=n(r(23872)),c=n(r(42181)),f=r(87067);class m extends c.default{get leftCards(){return[this.baseInfoCard,this.networkCard]}get leftCardsStyle(){return{flex:1}}get rightCards(){return[this.specCard,this.labelCard]}get baseInfoCard(){var e=[{label:t("COE"),dataIndex:"coe"},{label:t("Cluster Distro"),dataIndex:"cluster_distro"},{label:t("Server Type"),dataIndex:"server_type"},{label:t("Public"),dataIndex:"public",valueRender:"yesNo"},{label:t("Registry Enabled"),dataIndex:"registry_enabled",valueRender:"yesNo"},{label:t("TLS Disabled"),dataIndex:"tls_disabled",valueRender:"yesNo"}];return{title:t("Cluster Type"),options:e}}get networkCard(){var e,a,r,{external_network_id:l,original_external_network_id:n,externalNetwork:{name:o}={},fixed_network:s,original_fixed_network:d,fixedNetwork:{name:u}={},fixed_subnet:c,original_fixed_subnet:f,fixedSubnet:{name:m}={}}=this.detailData||{},p=n?(0,i.default)(e="".concat(n," (")).call(e,t("The resource has been deleted"),")"):l?this.getLinkRender("networkDetail",o||l,{id:l}):"-",v=d?(0,i.default)(a="".concat(d," (")).call(a,t("The resource has been deleted"),")"):s?this.getLinkRender("networkDetail",u||s,{id:s}):"-",h=f?(0,i.default)(r="".concat(f," (")).call(r,t("The resource has been deleted"),")"):s&&c?this.getLinkRender("subnetDetail",m||c,{networkId:s,id:c}):"-",g=[{label:t("Network Driver"),dataIndex:"network_driver"},{label:t("HTTP Proxy"),dataIndex:"http_proxy"},{label:t("HTTPS Proxy"),dataIndex:"https_proxy"},{label:t("No Proxy"),dataIndex:"no_proxy"},{label:t("External Network"),content:p},{label:t("Fixed Network"),content:v},{label:t("Fixed Subnet"),content:h},{label:t("DNS"),dataIndex:"dns_nameserver"},{label:t("Master Node LB Enabled"),dataIndex:"master_lb_enabled",valueRender:"yesNo"},{label:t("Floating IP Enabled"),dataIndex:"floating_ip_enabled",valueRender:"yesNo"}];return{title:t("Network"),options:g}}get specCard(){var e,a,r,l,{image_id:n,original_image_id:o,image:{name:s}={},keypair_id:d,original_keypair_id:u,flavor_id:c,original_flavor_id:f,flavor:{name:m}={},master_flavor_id:p,original_master_flavor_id:v,masterFlavor:{name:h}={}}=this.detailData,g=o?(0,i.default)(e="".concat(o," (")).call(e,t("The resource has been deleted"),")"):n?this.getLinkRender("imageDetail",s||n,{id:n}):"-",_=u?(0,i.default)(a="".concat(u," (")).call(a,t("The resource has been deleted"),")"):d?this.getLinkRender("keypairDetail",d,{id:d}):"-",b=f?(0,i.default)(r="".concat(f," (")).call(r,t("The resource has been deleted"),")"):c?this.getLinkRender("flavorDetail",m||c,{id:c}):"-",k=v?(0,i.default)(l="".concat(v," (")).call(l,t("The resource has been deleted"),")"):p?this.getLinkRender("flavorDetail",h||p,{id:p}):"-",S=[{label:t("Image"),content:g},{label:t("Keypair"),content:_,hidden:this.isAdminPage},{label:t("Node Flavor"),content:b},{label:t("Master Node Flavor"),content:k},{label:t("Volume Driver"),dataIndex:"volume_driver"},{label:t("Docker Storage Driver"),dataIndex:"docker_storage_driver"},{label:t("Docker Volume Size (GiB)"),dataIndex:"docker_volume_size"},{label:t("Insecure Registry"),dataIndex:"insecure_registry"}];return{title:t("Node Spec"),options:S}}get labelCard(){var e=[{label:t("labels"),dataIndex:"labels",render:e=>{var t;return(0,d.default)(e)?"-":u.default.createElement("ul",null,(0,o.default)(t=(0,s.default)(e)).call(t,(e=>{var[t,a]=e;return u.default.createElement("li",{key:t},t," : ",a)})))}}];return{title:t("Additional Labels"),labelCol:2,options:e}}}a.BaseDetail=m;a.default=(0,f.inject)("rootStore")((0,f.observer)(m))},13389:(e,t,a)=>{var r=a(18565),l=a(13696),n=a(3787),i=a(10732),o=a(32462),s=a(10819),d=a(22338),u=a(33950),c=a(48924);u(t,"__esModule",{value:!0}),t.default=t.ClustersStore=void 0;var f,m=c(a(89195)),p=c(a(68982)),v=c(a(10732)),h=c(a(77879)),g=c(a(1839)),_=c(a(33301)),b=c(a(81891)),k=c(a(92621)),S=a(27567),y=a(83575);function w(e,t){var a=r(e);if(l){var o=l(e);t&&(o=n(o).call(o,(function(t){return i(e,t).enumerable}))),a.push.apply(a,o)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?o(a=w(Object(l),!0)).call(a,(function(t){(0,h.default)(e,t,l[t])})):s?d(e,s(l)):o(r=w(Object(l))).call(r,(function(t){u(e,t,i(l,t))}))}return e}var C=new(t.ClustersStore=(f=class extends b.default{get client(){return k.default.magnum.clusters}get templateClient(){return k.default.magnum.clusterTemplates}get flavorClient(){return k.default.nova.flavors}get networkClient(){return k.default.neutron.networks}get subnetClient(){return k.default.neutron.subnets}get stackClient(){return k.default.heat.stacks}get listWithDetail(){return!0}create(e){var t=this;return(0,g.default)((function*(){return t.submitting(t.client.create(e))}))()}delete(e){var t=this;return(0,g.default)((function*(){var{id:a}=e;return t.client.delete(a)}))()}resize(e,t){var a=this;return(0,g.default)((function*(){var{id:r}=e;return a.client.resize(r,t,null,{headers:{"OpenStack-API-Version":"container-infra latest"}})}))()}upgrade(e,t){var a=this;return(0,g.default)((function*(){var{id:r}=e;return a.client.upgrade(r,t)}))()}listDidFetch(e,t,a){var r=this;return(0,g.default)((function*(){if(!e.length)return e;var{shouldFetchProject:t}=a,l=yield r.listDidFetchProject(e,{all_projects:t}),{keypairs:n=[]}=(yield k.default.nova.keypairs.list())||{};return(0,m.default)(l).call(l,(e=>((0,p.default)(n).call(n,(t=>{var a;return(null==t||null===(a=t.keypair)||void 0===a?void 0:a.name)===e.keypair}))||(e.original_keypair=e.keypair,e.keypair=null),e)))}))()}detailDidFetch(e){var t=this;return(0,g.default)((function*(){var a=(yield t.templateClient.show(e.cluster_template_id))||{};e.template=a;var{flavor_id:r,master_flavor_id:l,fixed_network:n,fixed_subnet:i}=a,o=e.flavor_id||r,s=e.master_flavor_id||l,d=e.fixed_network||n,u=e.fixed_subnet||i,[c={},f={},m={},v={},h={},g]=yield(0,y.allSettled)([k.default.nova.keypairs.list(),o?t.flavorClient.show(o):{},s?t.flavorClient.show(s):{},d?t.networkClient.show(d):{},u?t.subnetClient.show(u):{},e.stack_id?t.stackClient.list({id:e.stack_id}):{}]);if("fulfilled"===c.status){var{keypairs:_=[]}=c.value;(0,p.default)(_).call(_,(t=>{var a;return(null==t||null===(a=t.keypair)||void 0===a?void 0:a.name)===e.keypair}))||(e.original_keypair=e.keypair,e.keypair=null)}if("fulfilled"===f.status){var{flavor:b}=f.value;e.flavor=b}else e.original_flavor_id=e.flavor_id,e.flavor_id=null;if("fulfilled"===m.status){var{flavor:S}=m.value;e.masterFlavor=S}else e.original_master_flavor_id=e.master_flavor_id,e.master_flavor_id=null;if("fulfilled"===v.status){var{network:w}=v.value;e.fixedNetwork=w}else e.original_fixed_network=e.fixed_network,e.fixed_network=null;if("fulfilled"===h.status){var{subnet:x}=h.value;e.fixedSubnet=x}else e.original_fixed_subnet=e.fixed_subnet,e.fixed_subnet=null;if("fulfilled"===g.status){var{stacks:C=[]}=g.value;C[0]&&(e.stack=C[0])}return e}))()}get mapper(){return e=>x(x({},e),{},{id:e.uuid})}},(0,_.default)(f.prototype,"create",[S.action],(0,v.default)(f.prototype,"create"),f.prototype),(0,_.default)(f.prototype,"delete",[S.action],(0,v.default)(f.prototype,"delete"),f.prototype),(0,_.default)(f.prototype,"resize",[S.action],(0,v.default)(f.prototype,"resize"),f.prototype),f));t.default=C},14805:(e,a,r)=>{var l=r(33950),n=r(48924);l(a,"__esModule",{value:!0}),a.default=a.StepNodeSpec=void 0;var i=n(r(29672)),o=n(r(3787)),s=n(r(24836)),d=n(r(1839)),u=r(87067),c=r(27567),f=n(r(78711)),m=r(41832),p=n(r(65304)),v=r(64391),h=r(93651),g=r(70591),_=r(71495),b=r(83575);class k extends f.default{init(){this.imageStore=new m.ImageStore,this.keyPairStore=p.default,this.flavorStore=new v.FlavorStore,this.masterFlavorStore=new v.FlavorStore,this.getAllInitFunctions()}get title(){return t("Node Spec")}get name(){return t("Node Spec")}get isStep(){return!0}get isEdit(){return!!this.props.extra}getAllInitFunctions(){var e=this;return(0,d.default)((function*(){yield(0,b.allSettled)([e.getImageList(),e.getKeypairs(),e.getFlavors(),e.getMasterFlavors()]),e.updateDefaultValue()}))()}getImageList(){return this.imageStore.fetchList({all_projects:this.hasAdminRole})}getKeypairs(){return this.keyPairStore.fetchList()}get keypairs(){return this.keyPairStore.list.data||[]}getFlavors(){return this.flavorStore.fetchList()}getMasterFlavors(){return this.masterFlavorStore.fetchList()}get flavors(){return(0,c.toJS)(this.flavorStore.list.data)||[]}get masterFlavors(){return(0,c.toJS)(this.masterFlavorStore.list.data)||[]}get acceptedImageOs(){var e,{context:{coe:t=""}={}}=this.props;return"kubernetes"===t?["fedora-coreos"]:(0,i.default)(e=["swarm","swarm-mode"]).call(e,t)?["fedora-atomic"]:["ubuntu"]}get imageColumns(){return(0,h.getImageColumns)(this)}get imageList(){var e;return(0,o.default)(e=this.imageStore.list.data||[]).call(e,(e=>{var t,{originData:{os_distro:a}={}}=e;return(0,i.default)(t=this.acceptedImageOs).call(t,a)}))}get volumeDrivers(){var e,{context:{coe:t=""}={}}=this.props,a=[];return"kubernetes"===t?a=[{value:"cinder",label:"Cinder"}]:(0,i.default)(e=["swarm","mesos"]).call(e,t)&&(a=[{value:"rexray",label:"Rexray"}]),a}get defaultValue(){var e={};if(this.isEdit){var t,a,{extra:{image_id:r,keypair_id:l,flavor_id:n,master_flavor_id:i,volume_driver:s,docker_storage_driver:d,docker_volume_size:u}={}}=this.props;if(e={volume_driver:s,docker_storage_driver:d,docker_volume_size:u},n)e.flavor={selectedRowKeys:[n],selectedRows:(0,o.default)(t=this.flavors).call(t,(e=>e.id===n))};if(i)e.masterFlavor={selectedRowKeys:[i],selectedRows:(0,o.default)(a=this.masterFlavors).call(a,(e=>e.id===i))};r&&(e.images={selectedRowKeys:[r]}),l&&(e.keypair={selectedRowKeys:[l]})}return e}get minVolumeSize(){var{docker_storage_driver:e}=this.state;return"devicemapper"===e?3:1}get nameForStateUpdate(){return["docker_storage_driver"]}get formItems(){var{initKeyPair:e}=this.state;return[{name:"images",label:t("Image"),type:"select-table",data:this.imageList,required:!0,isLoading:this.imageStore.list.isLoading,filterParams:[{label:t("Name"),name:"name"}],columns:this.imageColumns},{name:"keypair",label:t("Keypair"),type:"select-table",data:this.keypairs,initValue:e,isLoading:this.keyPairStore.list.isLoading,header:(0,g.getKeyPairHeader)(this),tip:t("The SSH key is a way to remotely log in to the cluster instance. The cloud platform only helps to keep the public key. Please keep your private key properly."),filterParams:[{label:t("Name"),name:"name"}],columns:[{title:t("Name"),dataIndex:"name"},{title:t("Fingerprint"),dataIndex:"fingerprint"}]},{name:"flavor",label:t("Flavor of Nodes"),type:"select-table",data:this.flavors,columns:(0,_.getBaseSimpleFlavorColumns)(this),isLoading:this.flavorStore.list.isLoading,filterParams:[{label:t("Name"),name:"name"}]},{name:"masterFlavor",label:t("Flavor of Master Nodes"),type:"select-table",data:this.masterFlavors,columns:(0,_.getBaseSimpleFlavorColumns)(this),isLoading:this.masterFlavorStore.list.isLoading,filterParams:[{label:t("Name"),name:"name"}]},{name:"volume_driver",label:t("Volume Driver"),type:"select",options:this.volumeDrivers},{name:"docker_storage_driver",label:t("Docker Storage Driver"),type:"select",options:[{label:t("Devicemapper"),value:"devicemapper"},{label:t("Overlay"),value:"overlay"},{label:t("Overlay2"),value:"overlay2"}],onChange:()=>{this.resetFormValue(["docker_volume_size"])}},{name:"docker_volume_size",label:t("Docker Volume Size (GiB)"),type:"input-int",min:this.minVolumeSize,required:3===this.minVolumeSize,placeholder:t("Spec"),validator:(e,a)=>3===this.minVolumeSize&&(!a||a<this.minVolumeSize)?s.default.reject(new Error(t("The min size is {size} GiB",{size:this.minVolumeSize}))):s.default.resolve()}]}}a.StepNodeSpec=k;a.default=(0,u.inject)("rootStore")((0,u.observer)(k))},14932:(e,t,a)=>{var r=a(33950),l=a(48924);r(t,"__esModule",{value:!0}),t.default=t.CreateCluster=void 0;var n=a(87067),i=l(a(8545));class o extends i.default{static path(e){return"/container-infra/clusters/create?template=".concat(e.id)}}t.CreateCluster=o;t.default=(0,n.inject)("rootStore")((0,n.observer)(o))},16300:(e,a,r)=>{var l=r(18565),n=r(13696),i=r(3787),o=r(10732),s=r(32462),d=r(10819),u=r(22338),c=r(33950),f=r(48924);c(a,"__esModule",{value:!0}),a.default=a.Clusters=void 0;var m=f(r(77879)),p=f(r(54017)),v=r(87067),h=r(83575),g=r(1031),_=r(13389),b=r(35835),k=f(r(91128));function S(e,t){var a=l(e);if(n){var r=n(e);t&&(r=i(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?s(a=S(Object(l),!0)).call(a,(function(t){(0,m.default)(e,t,l[t])})):d?u(e,d(l)):s(r=S(Object(l))).call(r,(function(t){c(e,t,o(l,t))}))}return e}class w extends p.default{constructor(){super(...arguments),(0,m.default)(this,"updateFetchParams",(e=>y(y({},e),{},{shouldFetchProject:this.isAdminPage})))}init(){this.isAdminPage?this.store=new b.ClustersAdminStore:this.store=new _.ClustersStore}get name(){return t("clusters")}get policy(){return"cluster:get_all"}get fetchDataByAllProjects(){return!1}get actionConfigs(){return this.isAdminPage?k.default.actionConfigsAdmin:k.default.actionConfigs}getColumns(){return[{title:t("ID/Name"),dataIndex:"name",routeName:this.getRouteName("containerInfraClusterDetail")},{title:t("Status"),isHideable:!0,dataIndex:"status",valueMap:g.clusterStatus},{title:t("Health Status"),isHideable:!0,dataIndex:"health_status",render:e=>g.healthStatus[e]||e||"-",isStatus:!1},{title:t("Keypair"),isHideable:!0,dataIndex:"keypair",hidden:this.isAdminPage,render:e=>e?this.getLinkRender("keypairDetail",e,{id:e}):"-"}]}get searchFilters(){return[{label:t("Name"),name:"name"},{label:t("Status"),name:"status",options:(0,h.getOptions)(g.clusterStatus)},{label:t("Health Status"),name:"health_status",options:(0,h.getOptions)(g.healthStatus)}]}}a.Clusters=w;a.default=(0,v.inject)("rootStore")((0,v.observer)(w))},23226:(e,a,r)=>{var l=r(33950),n=r(48924);l(a,"__esModule",{value:!0}),a.default=a.StepNetwork=void 0;var i=n(r(3787)),o=n(r(29672)),s=n(r(1839)),d=n(r(23872)),u=n(r(78711)),c=r(87067),f=r(88274),m=r(15363),p=r(13479),v=r(12903);class h extends u.default{init(){var e=this;return(0,s.default)((function*(){e.externalNetworkStore=new f.NetworkStore,e.privateNetworkStore=new f.NetworkStore,e.subnetNetworkStore=new m.SubnetStore,e.getSubnetList()}))()}get title(){return t("Network")}get name(){return t("Network")}get isStep(){return!0}get isEdit(){return!!this.props.extra}getSubnetList(){var e=this;return(0,s.default)((function*(){yield e.subnetNetworkStore.fetchList(),e.updateDefaultValue()}))()}get subnetList(){var e,t,a=(null===(e=this.props.context)||void 0===e||null===(e=e.fixedNetwork)||void 0===e?void 0:e.selectedRowKeys)||[];return(0,i.default)(t=this.subnetNetworkStore.list.data||[]).call(t,(e=>a[0]===e.network_id))}get networkDrivers(){var e,t,{context:{coe:a=""}={}}=this.props,r=[];return"kubernetes"===a?r=[{value:"calico",label:"Calico"},{value:"flannel",label:"Flannel"}]:(0,o.default)(e=["swarm","swarm-mode"]).call(e,a)?r=[{value:"docker",label:"Docker"},{value:"flannel",label:"Flannel"}]:(0,o.default)(t=["mesos","dcos"]).call(t,a)&&(r=[{value:"docker",label:"Docker"}]),r}get defaultValue(){var e={};if(this.isEdit){var{extra:{network_driver:t,http_proxy:a,https_proxy:r,no_proxy:l,external_network_id:n,externalNetwork:i,fixed_network:o,fixedNetwork:s,fixed_subnet:d,fixedSubnet:u,dns_nameserver:c,master_lb_enabled:f,floating_ip_enabled:m}={},context:{fixedNetwork:p,fixedSubnet:v}}=this.props;e={network_driver:t,http_proxy:a,https_proxy:r,no_proxy:l,dns_nameserver:c,master_lb_enabled:f,floating_ip_enabled:m},n&&(e.externalNetwork={selectedRowKeys:[n],selectedRows:[i]}),o&&(e.fixedNetwork=p||{selectedRowKeys:[o],selectedRows:[s]}),d&&(e.fixedSubnet=v||{selectedRowKeys:[d],selectedRows:[u]})}return e}get formItems(){var{extra:{network_driver:e,fixed_subnet:a,fixedSubnet:r}={},context:{fixedSubnet:l}}=this.props,n=l||{selectedRowKeys:a?[a]:[],selectedRows:r?[r]:[]};return[{name:"network_driver",label:t("Network Driver"),placeholder:t("Choose a Network Driver"),type:"select",options:this.networkDrivers,disabled:e&&this.isEdit},{name:"http_proxy",label:t("HTTP Proxy"),placeholder:t("The http_proxy address to use for nodes in cluster"),type:"input"},{name:"https_proxy",label:t("HTTPS Proxy"),placeholder:t("The https_proxy address to use for nodes in cluster"),type:"input"},{name:"no_proxy",label:t("No Proxy"),placeholder:t("The no_proxy address to use for nodes in cluster"),type:"input"},{name:"externalNetwork",label:t("External Network"),type:"select-table",backendPageStore:this.externalNetworkStore,extraParams:{"router:external":!0},required:!0,loading:this.externalNetworkStore.list.isLoading,filterParams:[{label:t("Name"),name:"name"}],columns:(0,v.networkColumns)(this)},{name:"fixedNetwork",label:t("Fixed Network"),type:"select-table",backendPageStore:this.privateNetworkStore,extraParams:{"router:external":!1,project_id:this.currentProjectId},loading:this.privateNetworkStore.list.isLoading,header:d.default.createElement("div",null,t(" You can go to the console to "),(0,p.getLinkRender)({key:"network",value:"".concat(t("create a new network/subnet")," > ")})),filterParams:[{label:t("Name"),name:"name"}],columns:(0,v.networkColumns)(this),onChange:e=>{this.updateContext({fixedNetwork:e,fixedSubnet:{selectedRowKeys:[],selectedRows:[]}})}},{name:"fixedSubnet",label:t("Fixed Subnet"),type:"select-table",data:this.subnetList,filterParams:[{label:t("Name"),name:"name"}],columns:v.subnetColumns,initValue:n,onChange:e=>{this.updateContext({fixedSubnet:e})}},{name:"dns_nameserver",label:t("DNS"),placeholder:t("The DNS nameserver to use for this cluster template"),type:"input"},{name:"master_lb_enabled",label:t("Enable Load Balancer"),type:"check",content:t("Enabled Load Balancer for Master Nodes")},{name:"floating_ip_enabled",label:t("Enable Floating IP"),type:"check",tip:t("Whether enable or not using the floating IP of cloud provider.")}]}}a.StepNetwork=h;a.default=(0,c.inject)("rootStore")((0,c.observer)(h))},25382:(e,a,r)=>{var l=r(33950),n=r(48924);l(a,"__esModule",{value:!0}),a.default=a.ClusterTemplateDetail=void 0;var i=r(87067),o=n(r(19585)),s=n(r(83919)),d=n(r(11964)),u=n(r(65146));class c extends o.default{init(){this.store=s.default}get name(){return t("Cluster Template Detail")}get listUrl(){return this.getRoutePath("clusterTemplate")}get policy(){return"clustertemplate:detail"}get actionConfigs(){return this.isAdminPage?u.default.actionConfigsAdmin:u.default.actionConfigs}get detailInfos(){return[{title:t("Name"),dataIndex:"name"},{title:t("Created At"),dataIndex:"created_at",valueRender:"toLocalTime"},{title:t("Updated At"),dataIndex:"updated_at",valueRender:"toLocalTime"},{title:t("Project ID"),dataIndex:"project_id",hidden:!this.isAdminPage}]}get tabs(){return[{title:t("Detail"),key:"general_info",component:d.default}]}}a.ClusterTemplateDetail=c;a.default=(0,i.inject)("rootStore")((0,i.observer)(c))},30725:(e,a,r)=>{var l=r(33950),n=r(48924);l(a,"__esModule",{value:!0}),a.default=a.StepLabel=void 0;var i=n(r(89195)),o=n(r(18565)),s=n(r(78711)),d=r(87067),u=n(r(62731));class c extends s.default{get title(){return t("Labels")}get name(){return t("Labels")}get isStep(){return!0}get isEdit(){return!!this.props.extra}get defaultValue(){var e={};if(this.isEdit){var t,{extra:{labels:a}}=this.props;e.additionalLabels=(0,i.default)(t=(0,o.default)(a||{})).call(t,(e=>({value:{key:e,value:a[e]}})))}return e}get formItems(){return[{name:"additionalLabels",label:t("Additional Labels"),type:"add-select",itemComponent:u.default,addText:t("Add Label")}]}}a.StepLabel=c;a.default=(0,d.inject)("rootStore")((0,d.observer)(c))},31346:(e,a,r)=>{var l=r(33950),n=r(48924);l(a,"__esModule",{value:!0}),a.default=a.StepInfo=void 0;var i=n(r(24836)),o=n(r(3787)),s=n(r(1839)),d=n(r(77879)),u=n(r(78711)),c=r(87067),f=n(r(83919)),m=r(71495);class p extends u.default{constructor(){super(...arguments),(0,d.default)(this,"clusterNameValidator",((e,a)=>a?/^[a-zA-Z][a-zA-Z0-9_.-]*$/.test(a)?i.default.resolve():i.default.reject(t('The name should start with upper letter or lower letter, characters can only contain "0-9, a-z, A-Z, -, _, ."')):i.default.reject("")))}init(){this.getClustertemplates()}get title(){return t("Info")}get name(){return t("Info")}getClustertemplates(){var e=this;return(0,s.default)((function*(){yield f.default.fetchList(),e.updateDefaultValue()}))()}get clusterTemplates(){var e=f.default.list.data||[],{template:t}=this.locationParams;return t?(0,o.default)(e).call(e,(e=>e.uuid===t)):e}get defaultValue(){var e={},{template:t}=this.locationParams;return t&&(e.clusterTemplate={selectedRowKeys:[t],selectedRows:this.clusterTemplates}),e}get formItems(){return[{name:"name",label:t("Cluster Name"),type:"input",placeholder:t("Please input cluster name"),required:!0,validator:this.clusterNameValidator},{name:"clusterTemplate",label:t("Cluster Template"),type:"select-table",data:this.clusterTemplates,isLoading:f.default.list.isLoading,required:!0,filterParams:[{label:t("Name"),name:"name"}],columns:(0,m.getBaseTemplateColumns)(this),onChange:e=>{this.updateContext({clusterTemplate:e})}}]}}a.StepInfo=p;a.default=(0,c.inject)("rootStore")((0,c.observer)(p))},33235:(e,a,r)=>{var l=r(33950),n=r(48924);l(a,"__esModule",{value:!0}),a.default=a.StepNetworks=void 0;var i=n(r(24836)),o=n(r(3787)),s=n(r(1839)),d=n(r(77879)),u=n(r(23872)),c=n(r(78711)),f=r(27567),m=r(87067),p=r(1031),v=r(88274),h=r(15363),g=r(83919),_=r(12903),b=r(13479),k=r(83575);class S extends c.default{constructor(){super(...arguments),(0,d.default)(this,"allowed",(()=>i.default.resolve()))}init(){this.templateStore=new g.ClusterTemplatesStore,this.networkStore=new v.NetworkStore,this.subnetStore=new h.SubnetStore,this.getAllInitFunctions()}get title(){return t("Cluster Network")}get name(){return t("Cluster Network")}getAllInitFunctions(){var e=this;return(0,s.default)((function*(){yield(0,k.allSettled)([e.subnetStore.fetchList(),e.getTemplateDetail()]);var{fixed_network:t,fixed_subnet:a}=e.templateDetail;yield(0,k.allSettled)([t?e.networkStore.fetchDetail({id:t}):null,a?e.subnetStore.fetchDetail({id:a}):null]),e.updateDefaultValue()}))()}getTemplateDetail(){var{context:{clusterTemplate:e={}}={}}=this.props,{selectedRowKeys:t=[]}=e,a=t[0];if(a)return this.templateStore.fetchDetail({id:a})}get network(){return(0,f.toJS)(this.networkStore.detail)||{}}get subnet(){return(0,f.toJS)(this.subnetStore.detail)||{}}get subnetList(){var e,{context:{fixedNetwork:{selectedRowKeys:t=[]}={}}}=this.props,{fixed_network:a}=this.templateDetail,r=t[0]||a;return(0,o.default)(e=(0,f.toJS)(this.subnetStore.list.data||[])).call(e,(e=>r===e.network_id))}get templateDetail(){return(0,f.toJS)(this.templateStore.detail)||{}}get defaultValue(){var{context:{fixedNetwork:e,fixedSubnet:t}={}}=this.props,{fixed_network:a,fixed_subnet:r}=this.templateDetail;return{newNetwork:!0,fixedNetwork:e||{selectedRowKeys:a?[a]:[],selectedRows:a?[this.network]:[]},fixedSubnet:t||{selectedRowKeys:r?[r]:[],selectedRows:r?[this.subnet]:[]}}}get nameForStateUpdate(){return["newNetwork"]}get formItems(){var{newNetwork:e}=this.state,{context:{fixedNetwork:a,fixedSubnet:r}={}}=this.props,{fixed_network:l,fixed_subnet:n}=this.templateDetail,i=a||{selectedRowKeys:l?[l]:[],selectedRows:l?[this.network]:[]},o=r||{selectedRowKeys:n?[n]:[],selectedRows:n?[this.subnet]:[]};return[{name:"master_lb_enabled",label:t("Enable Load Balancer"),type:"check",content:t("Enabled Load Balancer for Master Nodes"),tip:p.defaultTip},{name:"newNetwork",label:t("Enabled Network"),type:"check",content:t("Create New Network")},{name:"fixedNetwork",label:t("Fixed Network"),type:"select-table",hidden:e,backendPageStore:this.networkStore,extraParams:{"router:external":!1,project_id:this.currentProjectId},loading:this.networkStore.list.isLoading,header:u.default.createElement("div",null,t(" You can go to the console to "),(0,b.getLinkRender)({key:"network",value:"".concat(t("create a new network/subnet")," > "),extra:{target:"_blank"}})),filterParams:[{label:t("Name"),name:"name"}],columns:(0,_.networkColumns)(this),onChange:e=>{this.updateContext({fixedNetwork:e,fixedSubnet:{selectedRowKeys:[],selectedRows:[]}})},initValue:i},{name:"fixedSubnet",label:t("Fixed Subnet"),type:"select-table",hidden:e,data:this.subnetList,filterParams:[{label:t("Name"),name:"name"}],columns:_.subnetColumns,onChange:e=>{this.updateContext({fixedSubnet:e})},initValue:o},{type:"divider"},{name:"floating_ip_enabled",label:t("Enable Floating IP"),type:"check",tip:p.defaultTip}]}}a.StepNetworks=S;a.default=(0,m.inject)("rootStore")((0,m.observer)(S))},35835:(e,t,a)=>{a(33950)(t,"__esModule",{value:!0}),t.default=t.ClustersAdminStore=void 0;var r=a(13389);class l extends r.ClustersStore{get listWithDetail(){return!1}}t.ClustersAdminStore=l;var n=new l;t.default=n},38930:(e,a,r)=>{var l=r(18565),n=r(13696),i=r(3787),o=r(10732),s=r(32462),d=r(10819),u=r(22338),c=r(33950),f=r(48924);c(a,"__esModule",{value:!0}),a.default=a.ClusterTemplates=void 0;var m=f(r(77879)),p=f(r(54017)),v=r(87067),h=r(83919),g=r(86580),_=r(71495),b=f(r(65146));function k(e,t){var a=l(e);if(n){var r=n(e);t&&(r=i(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?s(a=k(Object(l),!0)).call(a,(function(t){(0,m.default)(e,t,l[t])})):d?u(e,d(l)):s(r=k(Object(l))).call(r,(function(t){c(e,t,o(l,t))}))}return e}class y extends p.default{constructor(){super(...arguments),(0,m.default)(this,"updateFetchParams",(e=>S(S({},e),{},{shouldFetchProject:this.isAdminPage})))}init(){this.isAdminPage?this.store=new g.ClusterTemplatesAdminStore:this.store=new h.ClusterTemplatesStore}get name(){return t("clustertemplates")}get policy(){return"clustertemplate:get_all"}get fetchDataByAllProjects(){return!1}get actionConfigs(){return this.isAdminPage?b.default.actionConfigsAdmin:b.default.actionConfigs}getColumns(){return(0,_.getBaseTemplateColumns)(this)}get searchFilters(){return[{label:t("Name"),name:"name"}]}}a.ClusterTemplates=y;a.default=(0,v.inject)("rootStore")((0,v.observer)(y))},40944:(e,a,r)=>{var l=r(33950),n=r(48924);l(a,"__esModule",{value:!0}),a.default=a.StepInfo=void 0;var i=n(r(78711)),o=r(87067);class s extends i.default{get title(){return t("Info")}get name(){return t("Info")}get isEdit(){return!!this.props.extra}get isStep(){return!0}get defaultValue(){var e={};if(this.isEdit){var{extra:{name:t,coe:a,public:r,hidden:l,registry_enabled:n,tls_disabled:i}={}}=this.props;e={name:t,coe:a,public:r,hidden:l,registry_enabled:n,tls_disabled:i}}return e}get formItems(){return[{name:"name",label:t("Cluster Template Name"),type:"input",placeholder:t("Please input cluster template name"),required:!0},{name:"coe",label:t("COE"),type:"select",options:[{label:t("Kubernetes"),value:"kubernetes"},{label:t("Docker Swarm"),value:"swarm"},{label:t("Docker Swarm Mode"),value:"swarm-mode"},{label:t("Mesos"),value:"mesos"},{label:t("DC/OS"),value:"dcos"}],required:!0},{name:"public",label:t("Public"),type:"check"},{name:"hidden",label:t("Hidden"),type:"check"},{name:"registry_enabled",label:t("Enable Registry"),type:"check"},{name:"tls_disabled",label:t("Disable TLS"),type:"check"}]}}a.StepInfo=s;a.default=(0,o.inject)("rootStore")((0,o.observer)(s))},50114:(e,t,a)=>{var r=a(33950),l=a(48924);r(t,"__esModule",{value:!0}),t.default=void 0;var n=l(a(65512)),i=l(a(11052));t.default=e=>(0,n.default)(i.default,e)},51871:(e,a,r)=>{var l=r(33950),n=r(48924);l(a,"__esModule",{value:!0}),a.default=void 0;var i=n(r(77879)),o=r(60615),s=n(r(13389));class d extends o.ConfirmAction{constructor(){super(...arguments),(0,i.default)(this,"policy","cluster:delete"),(0,i.default)(this,"allowedCheckFunc",(e=>{var{stack_id:t,status:a}=e;return!("DELETE_IN_PROGRESS"===a||"CREATE_IN_PROGRESS"===a&&!t)})),(0,i.default)(this,"onSubmit",(e=>s.default.delete({id:e.id})))}get id(){return"delete"}get title(){return t("Delete Cluster")}get actionName(){return t("Delete Cluster")}get buttonText(){return t("Delete")}get isDanger(){return!0}}a.default=d},52296:(e,a,r)=>{var l=r(33950),n=r(48924);l(a,"__esModule",{value:!0}),a.default=a.ClustersDetail=void 0;var i=r(87067),o=n(r(19585)),s=r(1031),d=n(r(13389)),u=n(r(8009)),c=n(r(91128));class f extends o.default{init(){this.store=d.default}get name(){return t("Cluster Detail")}get listUrl(){return this.getRoutePath("containerInfraClusters")}get policy(){return"cluster:detail"}get actionConfigs(){return this.isAdminPage?c.default.actionConfigsAdmin:c.default.actionConfigs}get detailInfos(){return[{title:t("Name"),dataIndex:"name"},{title:t("Created At"),dataIndex:"created_at",valueRender:"toLocalTime"},{title:t("Updated At"),dataIndex:"updated_at",valueRender:"toLocalTime"},{title:t("Status"),dataIndex:"status",valueMap:s.clusterStatus},{title:t("Status Reason"),dataIndex:"status_reason"},{title:t("Health Status"),dataIndex:"health_status",render:e=>s.healthStatus[e]||e||"-"}]}get tabs(){return[{title:t("Detail"),key:"general_info",component:u.default}]}}a.ClustersDetail=f;a.default=(0,i.inject)("rootStore")((0,i.observer)(f))},56753:(e,a,r)=>{var l=r(33950),n=r(48924);l(a,"__esModule",{value:!0}),a.default=void 0;var i=n(r(77879)),o=r(60615),s=n(r(83919));class d extends o.ConfirmAction{constructor(){super(...arguments),(0,i.default)(this,"policy","clustertemplate:delete"),(0,i.default)(this,"allowedCheckFunc",(()=>!0)),(0,i.default)(this,"onSubmit",(e=>s.default.delete({id:e.uuid})))}get id(){return"delete"}get title(){return t("Delete Cluster Template")}get actionName(){return t("Delete Cluster Template")}get isDanger(){return!0}get buttonText(){return t("Delete")}}a.default=d},60239:(e,a,r)=>{var l=r(18565),n=r(13696),i=r(3787),o=r(10732),s=r(32462),d=r(10819),u=r(22338),c=r(33950),f=r(48924);c(a,"__esModule",{value:!0}),a.default=a.StepCreate=void 0;var m=f(r(32462)),p=f(r(24836)),v=f(r(29672)),h=f(r(1839)),g=f(r(49849)),_=f(r(77879)),b=r(87067),k=r(60615),S=f(r(83919)),y=r(27567),w=f(r(40944)),x=f(r(14805)),C=f(r(23226)),N=f(r(30725)),E=["flavor","masterFlavor","additionalLabels","images","keypair","externalNetwork","fixedNetwork","fixedSubnet"];function I(e,t){var a=l(e);if(n){var r=n(e);t&&(r=i(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?s(a=I(Object(l),!0)).call(a,(function(t){(0,_.default)(e,t,l[t])})):d?u(e,d(l)):s(r=I(Object(l))).call(r,(function(t){c(e,t,o(l,t))}))}return e}class T extends k.StepAction{constructor(){super(...arguments),(0,_.default)(this,"onSubmit",(e=>{var{flavor:t,masterFlavor:a,additionalLabels:r,images:l,keypair:n,externalNetwork:i,fixedNetwork:o,fixedSubnet:s}=e,d=(0,g.default)(e,E),u={};r&&(0,m.default)(r).call(r,(e=>{var t=e.value.key,a=e.value.value;u[t]=a}));var c=L(L({},d),{},{labels:u,external_network_id:i.selectedRowKeys[0],fixed_network:o&&o.selectedRowKeys[0]||null,fixed_subnet:s&&s.selectedRowKeys[0]||null,flavor_id:t&&t.selectedRowKeys[0]||null,master_flavor_id:a&&a.selectedRowKeys[0]||null,image_id:l&&l.selectedRowKeys[0]||null,keypair_id:n&&n.selectedRowKeys[0]||null});return this.isEdit?this.store.update({id:this.params.id},c):this.store.create(c)}))}init(){this.store=S.default,this.getDetail()}static allowed(){return p.default.resolve(!0)}get name(){return t("Create Cluster Template")}get listUrl(){return this.getRoutePath("clusterTemplate")}get isEdit(){var e;return(0,v.default)(e=this.path).call(e,"update")}get hasExtraProps(){return this.isEdit}get hasConfirmStep(){return!1}get params(){var{id:e}=this.props.match.params;return{id:e}}getDetail(){var e=this;return(0,h.default)((function*(){if(e.isEdit){var t=yield S.default.fetchDetail(e.params);e.setState({extra:(0,y.toJS)(t)})}}))()}get steps(){return[{title:t("Cluster Info"),component:w.default},{title:t("Node Spec"),component:x.default},{title:t("Network Setting"),component:C.default},{title:t("Additional Labels"),component:N.default}]}}a.StepCreate=T,(0,_.default)(T,"id","create-cluster-template"),(0,_.default)(T,"title",t("Create Cluster Template")),(0,_.default)(T,"path","/container-infra/cluster-template/create"),(0,_.default)(T,"policy","clustertemplate:create");a.default=(0,b.inject)("rootStore")((0,b.observer)(T))},64584:(e,a,r)=>{var l=r(33950),n=r(48924);l(a,"__esModule",{value:!0}),a.default=a.Edit=void 0;var i=n(r(24836)),o=n(r(77879)),s=r(87067),d=r(13479),u=r(60239);class c extends u.StepCreate{get name(){return t("Update Cluster Template")}get listUrl(){return this.getRoutePath("clusterTemplate")}static allowed(){return i.default.resolve(!0)}}a.Edit=c,(0,o.default)(c,"id","update-cluster-template"),(0,o.default)(c,"title",t("Edit")),(0,o.default)(c,"policy","clustertemplate:update"),(0,o.default)(c,"path",(e=>{var{id:t}=e;return(0,d.getPath)({key:"containerInfraUpdateClusterTemplate",params:{id:t}})}));a.default=(0,s.inject)("rootStore")((0,s.observer)(c))},65146:(e,t,a)=>{var r=a(33950),l=a(48924);r(t,"__esModule",{value:!0}),t.default=void 0;var n=l(a(60239)),i=l(a(56753)),o=l(a(64584)),s=l(a(14932)),d={rowActions:{firstAction:i.default,moreActions:[{action:o.default},{action:s.default}]},batchActions:[i.default],primaryActions:[n.default]},u={rowActions:{firstAction:i.default,moreActions:[]},batchActions:[i.default],primaryActions:[]};t.default={actionConfigs:d,actionConfigsAdmin:u}},71495:(e,a,r)=>{r(33950)(a,"__esModule",{value:!0}),a.getBaseTemplateColumns=a.getBaseSimpleFlavorColumns=void 0;var l=r(78452),n=r(83575);a.getBaseTemplateColumns=e=>[{title:t("ID/Name"),dataIndex:"name",routeName:e.getRouteName("containerInfraClusterTemplateDetail")},{title:t("Project ID/Name"),dataIndex:"project_name",isHideable:!0,hidden:!e.isAdminPage},{title:t("COE"),isHideable:!0,dataIndex:"coe"},{title:t("Network Driver"),isHideable:!0,dataIndex:"network_driver"},{title:t("Keypair"),isHideable:!0,dataIndex:"keypair_id",hidden:e.isAdminPage,render:t=>t?e.getLinkRender("keypairDetail",t,{id:t}):t||"-"}];a.getBaseSimpleFlavorColumns=e=>[{title:t("ID/Name"),dataIndex:"name",routeName:e?e.getRouteName("flavorDetail"):""},{title:t("Architecture"),dataIndex:"architecture",valueMap:l.flavorArchitectures},{title:t("Category"),dataIndex:"category",render:e=>l.flavorCategoryList[e]||e||"-"},{title:t("CPU"),dataIndex:"vcpus",isHideable:!0},{title:t("Memory"),dataIndex:"ram",isHideable:!0,render:e=>(0,n.formatSize)(e,2)}]},76451:(e,a,r)=>{var l=r(33950),n=r(48924);l(a,"__esModule",{value:!0}),a.default=a.StepNodeSpec=void 0;var i=n(r(24836)),o=n(r(3787)),s=n(r(1839)),d=n(r(77879)),u=r(87067),c=r(27567),f=n(r(78711)),m=n(r(65304)),p=r(64391),v=r(83919),h=r(1031),g=r(70591),_=r(71495),b=r(83575);class k extends f.default{constructor(){super(...arguments),(0,d.default)(this,"allowed",(()=>i.default.resolve()))}init(){this.keyPairStore=m.default,this.flavorStore=new p.FlavorStore,this.masterFlavorStore=new p.FlavorStore,this.templateStore=new v.ClusterTemplatesStore,this.getAllInitFunctions()}get title(){return t("Node Spec")}get name(){return t("Node Spec")}getAllInitFunctions(){var e=this;return(0,s.default)((function*(){yield(0,b.allSettled)([e.getKeypairs(),e.getFlavors(),e.getMasterFlavors(),e.getTemplateDetail()]),e.updateDefaultValue()}))()}getKeypairs(){return this.keyPairStore.fetchList()}get keypairs(){return this.keyPairStore.list.data||[]}getFlavors(){return this.flavorStore.fetchList()}getMasterFlavors(){return this.masterFlavorStore.fetchList()}get flavors(){return(0,c.toJS)(this.flavorStore.list.data)||[]}get masterFlavors(){return(0,c.toJS)(this.masterFlavorStore.list.data)||[]}getTemplateDetail(){var{context:{clusterTemplate:e={}}={}}=this.props,{selectedRowKeys:t=[]}=e,a=t[0];if(a)return this.templateStore.fetchDetail({id:a})}get templateDetail(){return(0,c.toJS)(this.templateStore.detail)||{}}get defaultValue(){var e,t,a,{context:{keypair:r,masterFlavor:l,flavor:n,master_count:i,node_count:s}={}}=this.props,{master_flavor_id:d,flavor_id:u,keypair_id:c}=this.templateDetail;return{master_count:i||1,node_count:s||1,masterFlavor:l||{selectedRowKeys:d?[d]:[],selectedRows:(0,o.default)(e=this.masterFlavors).call(e,(e=>e.id===d))},flavor:n||{selectedRowKeys:u?[u]:[],selectedRows:(0,o.default)(t=this.flavors).call(t,(e=>e.id===u))},keypair:r||{selectedRowKeys:c?[c]:[],selectedRows:(0,o.default)(a=this.keypairs).call(a,(e=>e.id===c))}}}get formItems(){var e,a,r,{context:{clusterTemplate:l={},keypair:n,masterFlavor:i,flavor:s}={}}=this.props,{selectedRows:d=[]}=l,{master_flavor_id:u,flavor_id:c,keypair_id:f}=d[0]||{},{initKeyPair:m=n}=this.state,p={selectedRowKeys:f?[f]:[],selectedRows:(0,o.default)(e=this.keypairs).call(e,(e=>e.id===f))},v=s||{selectedRowKeys:c?[c]:[],selectedRows:(0,o.default)(a=this.flavors).call(a,(e=>e.id===c))},b=i||{selectedRowKeys:u?[u]:[],selectedRows:(0,o.default)(r=this.masterFlavors).call(r,(e=>e.id===u))};return[{name:"keypair",label:t("Keypair"),type:"select-table",required:!0,data:this.keypairs,initValue:m||p,isLoading:this.keyPairStore.list.isLoading,header:(0,g.getKeyPairHeader)(this),tip:t("The SSH key is a way to remotely log in to the cluster instance. If itâ€™s not set, the value of this in the template will be used."),filterParams:[{label:t("Name"),name:"name"}],columns:[{title:t("Name"),dataIndex:"name"},{title:t("Fingerprint"),dataIndex:"fingerprint"}]},{name:"master_count",label:t("Number of Master Nodes"),type:"input-int",min:1,required:!0,onChange:e=>{this.updateContext({master_count:e})}},{name:"masterFlavor",label:t("Flavor of Master Nodes"),type:"select-table",required:!0,tip:h.defaultTip,data:this.masterFlavors,initValue:b,columns:(0,_.getBaseSimpleFlavorColumns)(this),isLoading:this.masterFlavorStore.list.isLoading,filterParams:[{label:t("Name"),name:"name"}],onChange:e=>{this.updateContext({masterFlavor:e})}},{type:"divider"},{name:"node_count",label:t("Number of Nodes"),type:"input-int",min:1,required:!0,onChange:e=>{this.updateContext({node_count:e})}},{name:"flavor",label:t("Flavor of Nodes"),type:"select-table",required:!0,tip:h.defaultTip,data:this.flavors,initValue:v,columns:(0,_.getBaseSimpleFlavorColumns)(this),isLoading:this.flavorStore.list.isLoading,filterParams:[{label:t("Name"),name:"name"}],onChange:e=>{this.updateContext({flavor:e})}}]}}a.StepNodeSpec=k;a.default=(0,u.inject)("rootStore")((0,u.observer)(k))},83919:(e,t,a)=>{var r=a(18565),l=a(13696),n=a(3787),i=a(10732),o=a(32462),s=a(10819),d=a(22338),u=a(33950),c=a(48924);u(t,"__esModule",{value:!0}),t.default=t.ClusterTemplatesStore=void 0;var f,m=c(a(89195)),p=c(a(3787)),v=c(a(18565)),h=c(a(29672)),g=c(a(77861)),_=c(a(68982)),b=c(a(10732)),k=c(a(77879)),S=c(a(1839)),y=c(a(33301)),w=c(a(34488)),x=c(a(81891)),C=c(a(92621)),N=a(27567),E=a(83575);function I(e,t){var a=r(e);if(l){var o=l(e);t&&(o=n(o).call(o,(function(t){return i(e,t).enumerable}))),a.push.apply(a,o)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?o(a=I(Object(l),!0)).call(a,(function(t){(0,k.default)(e,t,l[t])})):s?d(e,s(l)):o(r=I(Object(l))).call(r,(function(t){u(e,t,i(l,t))}))}return e}var T=new(t.ClusterTemplatesStore=(f=class extends x.default{get client(){return C.default.magnum.clusterTemplates}get flavorClient(){return C.default.nova.flavors}get networkClient(){return C.default.neutron.networks}get subnetClient(){return C.default.neutron.subnets}get imageClient(){return C.default.glance.images}get listWithDetail(){return!0}create(e){var t=this;return(0,S.default)((function*(){return t.submitting(t.client.create(e))}))()}delete(e){var t=this;return(0,S.default)((function*(){var{id:a}=e;return t.client.delete(a)}))()}update(e,t){var a=this;return(0,S.default)((function*(){var r,l,{id:n}=e,i=(0,m.default)(r=(0,p.default)(l=(0,v.default)(t)).call(l,(e=>{var a;return!((0,h.default)(a=["network_driver","external_network_id"]).call(a,e)&&!t[e])}))).call(r,(e=>{var a;return{path:"/".concat(e),value:"labels"===e?(0,g.default)(t[e]||{}):(0,w.default)(t[e])?"".concat(t[e]):t[e],op:(0,h.default)(a=[null,void 0,""]).call(a,t[e])?"remove":"replace"}}));return a.submitting(a.client.patch(n,i))}))()}get mapper(){return e=>L(L({},e),{},{id:e.uuid})}listDidFetch(e,t,a){var r=this;return(0,S.default)((function*(){if(!e.length)return e;var{shouldFetchProject:t}=a,l=yield r.listDidFetchProject(e,{all_projects:t}),{keypairs:n=[]}=(yield C.default.nova.keypairs.list())||{};return(0,m.default)(l).call(l,(e=>((0,_.default)(n).call(n,(t=>{var a;return(null==t||null===(a=t.keypair)||void 0===a?void 0:a.name)===e.keypair_id}))||(e.original_keypair_id=e.keypair_id,e.keypair_id=null),e)))}))()}detailDidFetch(e){var t=this;return(0,S.default)((function*(){var[a={},r={},l={},n={},i={},o={},s]=yield(0,E.allSettled)([C.default.nova.keypairs.list(),e.flavor_id?t.flavorClient.show(e.flavor_id):{},e.master_flavor_id?t.flavorClient.show(e.master_flavor_id):{},e.external_network_id?t.networkClient.show(e.external_network_id):{},e.fixed_network?t.networkClient.show(e.fixed_network):{},e.fixed_subnet?t.subnetClient.show(e.fixed_subnet):{},e.image_id?t.imageClient.show(e.image_id):{}]);if("fulfilled"===a.status){var{keypairs:d=[]}=a.value;(0,_.default)(d).call(d,(t=>{var a;return(null==t||null===(a=t.keypair)||void 0===a?void 0:a.name)===e.keypair_id}))||(e.original_keypair_id=e.keypair_id,e.keypair_id=null)}if("fulfilled"===r.status){var{flavor:u}=r.value;e.flavor=u}else e.original_flavor_id=e.flavor_id,e.flavor_id=null;if("fulfilled"===l.status){var{flavor:c}=l.value;e.masterFlavor=c}else e.original_master_flavor_id=e.master_flavor_id,e.master_flavor_id=null;if("fulfilled"===n.status){var{network:f}=n.value;e.externalNetwork=f}else e.original_external_network_id=e.external_network_id,e.external_network_id=null;if("fulfilled"===i.status){var{network:m}=i.value;e.fixedNetwork=m}else e.original_fixed_network=e.fixed_network,e.fixed_network=null;if("fulfilled"===o.status){var{subnet:p}=o.value;e.fixedSubnet=p}else e.original_fixed_subnet=e.fixed_subnet,e.fixed_subnet=null;return"fulfilled"===s.status?e.image=s.value:(e.original_image_id=e.image_id,e.image_id=null),e}))()}},(0,y.default)(f.prototype,"create",[N.action],(0,b.default)(f.prototype,"create"),f.prototype),(0,y.default)(f.prototype,"delete",[N.action],(0,b.default)(f.prototype,"delete"),f.prototype),(0,y.default)(f.prototype,"update",[N.action],(0,b.default)(f.prototype,"update"),f.prototype),f));t.default=T},86580:(e,t,a)=>{a(33950)(t,"__esModule",{value:!0}),t.default=t.ClusterTemplatesAdminStore=void 0;var r=a(83919);class l extends r.ClusterTemplatesStore{get listWithDetail(){return!1}}t.ClusterTemplatesAdminStore=l;var n=new l;t.default=n},91128:(e,t,a)=>{var r=a(33950),l=a(48924);r(t,"__esModule",{value:!0}),t.default=void 0;var n=l(a(51871)),i=l(a(95366)),o=l(a(8545)),s={rowActions:{firstAction:n.default,moreActions:[{action:i.default}]},batchActions:[n.default],primaryActions:[o.default]},d={rowActions:{firstAction:n.default,moreActions:[]},batchActions:[n.default],primaryActions:[]};t.default={actionConfigs:s,actionConfigsAdmin:d}},91499:(e,a,r)=>{var l=r(33950),n=r(48924);l(a,"__esModule",{value:!0}),a.default=a.StepManagement=void 0;var i=n(r(78711)),o=r(87067);class s extends i.default{get title(){return t("Cluster Management")}get name(){return t("Cluster Management")}get defaultValue(){return{create_timeout:60}}get formItems(){return[{name:"auto_healing_enabled",label:t("Auto Healing"),type:"check",content:t("Automatically repair unhealhty nodes")},{type:"divider"},{name:"auto_scaling_enabled",label:t("Auto Scaling"),type:"check",content:t("Auto scaling feature will be enabled")},{type:"divider"},{name:"create_timeout",label:t("Timeout(Minute)"),type:"input-int",min:1,tip:t("The timeout for cluster creation in minutes.")}]}}a.StepManagement=s;a.default=(0,o.inject)("rootStore")((0,o.observer)(s))},95366:(e,a,r)=>{var l=r(18565),n=r(13696),i=r(3787),o=r(10732),s=r(32462),d=r(10819),u=r(22338),c=r(33950),f=r(48924);c(a,"__esModule",{value:!0}),a.default=a.Resize=void 0;var m=f(r(24836)),p=f(r(29672)),v=f(r(1839)),h=f(r(77879)),g=r(87067),_=r(27567),b=r(60615),k=f(r(13389)),S=f(r(52740));function y(e,t){var a=l(e);if(n){var r=n(e);t&&(r=i(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a,r,l=null!=arguments[t]?arguments[t]:{};t%2?s(a=y(Object(l),!0)).call(a,(function(t){(0,h.default)(e,t,l[t])})):d?u(e,d(l)):s(r=y(Object(l))).call(r,(function(t){c(e,t,o(l,t))}))}return e}class x extends b.ModalAction{constructor(){super(...arguments),(0,h.default)(this,"onSubmit",(e=>{var{changed_node_count:t,nodes_to_remove:a}=e,r={node_count:t,nodes_to_remove:[]};return a&&(r.nodes_to_remove=a.split(",")),this.store.resize({id:this.item.id},r)}))}init(){this.store=k.default,this.projectStore=S.default,this.state.quotaLoading=!0,this.getQuota()}static get modalSize(){return"middle"}getModalSize(){return"middle"}static allowed(e){var{status:t}=e;return m.default.resolve((0,p.default)(t).call(t,"COMPLETE"))}get name(){return t("Resize Cluster")}get maxSize(){var{node_count:e=0}=this.item,{instances:{left:t=0}={}}=(0,_.toJS)(this.projectStore.novaQuota)||{};return-1===t?null:t+e}get showQuota(){return!0}getQuota(){var e=this;return(0,v.default)((function*(){e.setState({quotaLoading:!0}),yield e.projectStore.fetchProjectNovaQuota(),e.setState({quotaLoading:!1})}))()}get quotaInfo(){var{quotaLoading:e}=this.state;if(e)return[];var{newNodes:a}=this.getNodesInput(),{instances:r={}}=(0,_.toJS)(this.projectStore.novaQuota)||{},{left:l}=r;return[w(w({},r),{},{add:0===l?0:a,name:"instance",title:t("Instance")})]}getNodesInput(){var{node_count:e=0}=this.item,{changed_node_count:t=0}=this.state,a=t-e;return{newNodes:a>0?a:0}}get defaultValue(){var{node_count:e=0,master_count:t=0}=this.item;return{current_master_node_count:t,current_node_count:e,changed_node_count:e+1}}get nameForStateUpdate(){return["changed_node_count"]}get formItems(){var{changed_node_count:e}=this.state,{node_count:a=0}=this.item;return[{name:"current_master_node_count",label:t("Current Master Node Count"),type:"label"},{name:"current_node_count",label:t("Current Node Count"),type:"label"},{name:"changed_node_count",label:t("Changed Node Count"),type:"input-int",min:1,max:this.maxSize,required:!0,validator:(e,r)=>r===a?m.default.reject(new Error(t("The changed node count can not be equal to the current value"))):m.default.resolve()},{name:"nodes_to_remove",label:t("Nodes To Remove"),type:"textarea",placeholder:t('Please enter the server id to be reduced, and separate different id with ","'),validator:(e,a)=>a&&!/^[0-9a-zA-Z]+([0-9a-zA-Z,-][0-9a-zA-Z]+)*$/.test(a)?m.default.reject(new Error(t("Please enter the correct id"))):m.default.resolve(),display:e<a}]}}a.Resize=x,(0,h.default)(x,"id","resize-cluster"),(0,h.default)(x,"title",t("Resize Cluster")),(0,h.default)(x,"policy","cluster:resize");a.default=(0,g.inject)("rootStore")((0,g.observer)(x))}}]);