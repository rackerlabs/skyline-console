"use strict";(self.webpackChunkskyline_console=self.webpackChunkskyline_console||[]).push([[238],{12775:(e,t,a)=>{var r=a(633950),n=a(548924);r(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(121888)),i=n(a(130916)),o=n(a(581340)),s=n(a(20299)),u=n(a(807042)),d=n(a(155704)),c=n(a(223333)),f=n(a(525302)),p=n(a(841521)),m="/ha";t.default=[{path:m,component:l.default,routes:[{path:"".concat(m,"/segments-admin"),component:o.default,exact:!0},{path:"".concat(m,"/segments-admin/create-step-admin"),component:p.default,exact:!0},{path:"".concat(m,"/segments-admin/detail/:id"),component:d.default,exact:!0},{path:"".concat(m,"/hosts-admin"),component:s.default,exact:!0},{path:"".concat(m,"/hosts-admin/detail/:id"),component:c.default,exact:!0},{path:"".concat(m,"/notifications-admin"),component:u.default,exact:!0},{path:"".concat(m,"/notifications-admin/detail/:id"),component:f.default,exact:!0},{path:"*",component:i.default}]}]},20299:(e,a,r)=>{var n=r(471742),l=r(633950),i=r(810732),o=r(548924);l(a,"__esModule",{value:!0}),a.default=a.Hosts=void 0;var s=o(r(877879)),u=o(r(823872)),d=r(87067),c=o(r(654017)),f=function(e,t){if("function"==typeof n)var a=new n,r=new n;return function(e,t){if(!t&&e&&e.__esModule)return e;var n,o,s={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return s;if(n=t?r:a){if(n.has(e))return n.get(e);n.set(e,s)}for(var u in e)"default"!==u&&{}.hasOwnProperty.call(e,u)&&((o=(n=l)&&i(e,u))&&(o.get||o.set)?n(s,u,o):s[u]=e[u]);return s}(e,t)}(r(614617)),p=r(403002),m=r(365468),h=o(r(840139));class v extends c.default{constructor(){super(...arguments),(0,s.default)(this,"getColumns",(()=>[{title:t("Name"),dataIndex:"name",render:(e,t)=>{var a=this.getRoutePath("masakariHostDetail",{id:t.failover_segment_id},{uuid:t.uuid});return u.default.createElement(p.Link,{to:a},e)}},{title:t("UUID"),dataIndex:"uuid",isHideable:!0},{title:t("Reserved"),dataIndex:"reserved",isHideable:!0,valueRender:"yesNo"},{title:t("Type"),dataIndex:"type",isHideable:!0},{title:t("Control Attribute"),dataIndex:"control_attributes",isHideable:!0},{title:t("On Maintenance"),dataIndex:"on_maintenance",isHideable:!0,valueRender:"yesNo"},{title:t("Failover Segment"),dataIndex:"failover_segment",isHideable:!0,render:(e,t)=>u.default.createElement(p.Link,{to:this.getRoutePath("masakariSegmentDetail",{id:t.failover_segment_id})},t.failover_segment.name)}]))}init(){this.store=f.default,this.downloadStore=new f.HostStore}get endpoint(){return(0,m.masakariEndpoint)()}get checkEndpoint(){return!0}get policy(){return this.isAdminPage?"os_compute_api:servers:index:get_all_tenants":"os_compute_api:servers:index"}get name(){return t("hosts")}get defaultSortKey(){return"updated_at"}get actionConfigs(){return h.default}get rowKey(){return"uuid"}get searchFilters(){return[{label:t("Segment ID"),name:"id"},{label:t("Type"),name:"type"},{label:t("On Maintenance"),name:"on_maintenance"},{label:t("Reserved"),name:"reserved"},...this.isAdminPage?[{label:t("Project Name"),name:"project_name"}]:[]]}}a.Hosts=v;a.default=(0,d.inject)("rootStore")((0,d.observer)(v))},52857:(e,a,r)=>{var n=r(818565),l=r(213696),i=r(303787),o=r(810732),s=r(532462),u=r(110819),d=r(722338),c=r(633950),f=r(548924);c(a,"__esModule",{value:!0}),a.default=a.Update=void 0;var p=f(r(424836)),m=f(r(877879)),h=r(87067),v=r(860615),g=f(r(995786));function _(e,t){var a=n(e);if(l){var r=l(e);t&&(r=i(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}class y extends v.ModalAction{constructor(){super(...arguments),(0,m.default)(this,"onSubmit",(e=>this.store.update(this.item.uuid,{segment:e})))}init(){this.store=g.default}get name(){return t("Update Segment")}get defaultValue(){return function(e){for(var t=1;t<arguments.length;t++){var a,r,n=null!=arguments[t]?arguments[t]:{};t%2?s(a=_(Object(n),!0)).call(a,(function(t){(0,m.default)(e,t,n[t])})):u?d(e,u(n)):s(r=_(Object(n))).call(r,(function(t){c(e,t,o(n,t))}))}return e}({},this.item)}get formItems(){return[{name:"name",label:t("Segment Name"),type:"input",required:!0},{name:"recovery_method",label:t("Recovery Method"),type:"select",options:[{label:t("auto"),value:"auto"},{label:t("auto_priority"),value:"auto_priority"},{label:t("reserved_host"),value:"reserved_host"},{label:t("rh_priority"),value:"rh_priority"}],required:!0},{name:"description",label:t("Description"),type:"textarea",rows:4}]}}a.Update=y,(0,m.default)(y,"id","UpdateSegment"),(0,m.default)(y,"title",t("Update")),(0,m.default)(y,"policy","baremetal:port:Update"),(0,m.default)(y,"allowed",(()=>p.default.resolve(!0)));a.default=(0,h.inject)("rootStore")((0,h.observer)(y))},155704:(e,a,r)=>{var n=r(633950),l=r(548924);n(a,"__esModule",{value:!0}),a.default=a.SegmentsDetail=void 0;var i=r(87067),o=l(r(119585)),s=r(995786),u=l(r(791142)),d=l(r(687432)),c=l(r(20299));class f extends o.default{init(){this.store=new s.SegmentStore}get name(){return t("Segment Detail")}get listUrl(){return this.getRoutePath("masakariSegments")}get policy(){return"capsule:get_one_all_projects"}get actionConfigs(){return d.default}get detailInfos(){return[{title:t("Name"),dataIndex:"name"},{title:t("Description"),dataIndex:"description"}]}get tabs(){return[{title:t("Detail"),key:"general_info",component:u.default},{title:t("Hosts"),key:"host",component:c.default}]}}a.SegmentsDetail=f;a.default=(0,i.inject)("rootStore")((0,i.observer)(f))},193466:(e,t,a)=>{var r=a(633950),n=a(548924);r(t,"__esModule",{value:!0}),t.default=t.NotificationStore=void 0;var l,i=n(a(810732)),o=n(a(601839)),s=n(a(533301)),u=n(a(381891)),d=n(a(892621)),c=a(127567),f=new(t.NotificationStore=(l=class extends u.default{get client(){return d.default.masakari.notifications}create(e){var t=this;return(0,o.default)((function*(){return t.client.create(e)}))()}delete(e,t){var a=this;return(0,o.default)((function*(){var{params:r}=e;return a.client.delete(r,t)}))()}},(0,s.default)(l.prototype,"create",[c.action],(0,i.default)(l.prototype,"create"),l.prototype),(0,s.default)(l.prototype,"delete",[c.action],(0,i.default)(l.prototype,"delete"),l.prototype),l));t.default=f},223333:(e,a,r)=>{var n=r(633950),l=r(548924);n(a,"__esModule",{value:!0}),a.default=a.HostsDetail=void 0;var i=l(r(342279)),o=l(r(877879)),s=r(189961),u=r(87067),d=l(r(119585)),c=l(r(614617)),f=l(r(544541)),p=l(r(840139));class m extends d.default{constructor(){super(...arguments),(0,o.default)(this,"updateFetchParams",(e=>{var t,a=(0,s.parse)((0,i.default)(t=this.routing.location.search).call(t,1));return{id:e.id,uuid:a.uuid}}))}init(){this.store=c.default}get name(){return t("Host Detail")}get listUrl(){return this.getRoutePath("masakariHosts")}get policy(){return"capsule:get_one_all_projects"}get actionConfigs(){return p.default}get titleValue(){var e;return(0,s.parse)((0,i.default)(e=this.routing.location.search).call(e,1)).uuid}get detailInfos(){return[{title:t("Name"),dataIndex:"name"}]}get tabs(){return[{title:t("Detail"),key:"general_info",component:f.default}]}}a.HostsDetail=m;a.default=(0,u.inject)("rootStore")((0,u.observer)(m))},516140:(e,a,r)=>{var n=r(633950),l=r(548924);n(a,"__esModule",{value:!0}),a.default=a.BaseDetail=void 0;var i=l(r(742181)),o=r(87067);class s extends i.default{get leftCards(){return[this.baseInfoCard,this.payloadCard]}get baseInfoCard(){var e=[{label:t("ID"),dataIndex:"id"},{label:t("Host"),dataIndex:"source_host_uuid",copyable:!0},{label:t("Generated Time"),dataIndex:"generated_time",valueRender:"toLocalTime"},{label:t("Created At"),dataIndex:"created_at",valueRender:"toLocalTime"},{label:t("Updated At"),dataIndex:"updated_at",valueRender:"toLocalTime"}];return{title:t("Notification Detail"),options:e}}get payloadCard(){var e=[{label:t("Event"),dataIndex:"event"},{label:t("Instance UUID"),dataIndex:"instance_uuid"},{label:t("VIR Domain Event"),dataIndex:"vir_domain_event"}];return{title:t("Payload"),sourceData:this.detailData.payload,options:e}}}a.BaseDetail=s;a.default=(0,o.inject)("rootStore")((0,o.observer)(s))},525302:(e,a,r)=>{var n=r(633950),l=r(548924);n(a,"__esModule",{value:!0}),a.default=a.NotificationsDetail=void 0;var i=r(87067),o=l(r(119585)),s=l(r(193466)),u=l(r(516140));class d extends o.default{init(){this.store=s.default}get name(){return t("Host Detail")}get listUrl(){return this.getRoutePath("masakariNotifications")}get policy(){return"capsule:get_one_all_projects"}get detailInfos(){return[{title:t("Type"),dataIndex:"type"},{title:t("Status"),dataIndex:"status"}]}get tabs(){return[{title:t("Detail"),key:"baseDetail",component:u.default}]}}a.NotificationsDetail=d;a.default=(0,i.inject)("rootStore")((0,i.observer)(d))},544541:(e,a,r)=>{var n=r(633950),l=r(548924);n(a,"__esModule",{value:!0}),a.default=a.BaseDetail=void 0;var i=l(r(823872)),o=l(r(742181)),s=r(87067),u=r(403002);class d extends o.default{get leftCards(){return[this.baseInfoCard]}get baseInfoCard(){var e=[{label:t("UUID"),dataIndex:"uuid"},{label:t("Failover Segment"),dataIndex:"failover_segment_id",render:(e,t)=>i.default.createElement(u.Link,{to:this.getRoutePath("masakariSegmentDetail",{id:t.failover_segment_id})},t.failover_segment.name)},{label:t("Reserved"),dataIndex:"reserved",valueRender:"yesNo"},{label:t("On Maintenance"),dataIndex:"on_maintenance",valueRender:"yesNo"},{label:t("Type"),dataIndex:"type"},{label:t("Control Attribute"),dataIndex:"control_attributes"}];return{title:t("Host Detail"),options:e}}}a.BaseDetail=d;a.default=(0,s.inject)("rootStore")((0,s.observer)(d))},552584:(e,a,r)=>{var n=r(633950),l=r(548924);n(a,"__esModule",{value:!0}),a.default=a.StepSegment=void 0;var i=l(r(424836)),o=l(r(877879)),s=r(87067),u=l(r(978711));class d extends u.default{constructor(){super(...arguments),(0,o.default)(this,"allowed",(()=>i.default.resolve()))}get title(){return"StepSegment"}get name(){return"StepSegment"}get isStep(){return!0}get defaultValue(){return{recovery_method:"auto",service_type:"compute"}}get formItems(){return[{name:"segment_name",label:t("Segment Name"),type:"input",required:!0},{name:"recovery_method",label:t("Recovery Method"),type:"select",options:[{label:t("auto"),value:"auto"},{label:t("auto_priority"),value:"auto_priority"},{label:t("reserved_host"),value:"reserved_host"},{label:t("rh_priority"),value:"rh_priority"}],required:!0},{name:"service_type",label:t("Service Type"),type:"input",required:!0,disabled:!0},{name:"description",label:t("Description"),type:"textarea",rows:4}]}}a.StepSegment=d;a.default=(0,s.inject)("rootStore")((0,s.observer)(d))},581340:(e,a,r)=>{var n=r(471742),l=r(633950),i=r(810732),o=r(548924);l(a,"__esModule",{value:!0}),a.default=a.Segments=void 0;var s=o(r(877879)),u=r(87067),d=o(r(654017)),c=function(e,t){if("function"==typeof n)var a=new n,r=new n;return function(e,t){if(!t&&e&&e.__esModule)return e;var n,o,s={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return s;if(n=t?r:a){if(n.has(e))return n.get(e);n.set(e,s)}for(var u in e)"default"!==u&&{}.hasOwnProperty.call(e,u)&&((o=(n=l)&&i(e,u))&&(o.get||o.set)?n(s,u,o):s[u]=e[u]);return s}(e,t)}(r(995786)),f=r(365468),p=o(r(687432));class m extends d.default{constructor(){super(...arguments),(0,s.default)(this,"getColumns",(()=>[{title:t("Name"),dataIndex:"name",routeName:this.getRouteName("masakariSegmentDetail")},{title:t("UUID"),dataIndex:"uuid",isHideable:!0},{title:t("Recovery Method"),dataIndex:"recovery_method",isHideable:!0},{title:t("Service Type"),dataIndex:"service_type",isHideable:!0},{title:t("Description"),dataIndex:"description",isHideable:!0}]))}init(){this.store=c.default,this.downloadStore=new c.SegmentStore}get policy(){return this.isAdminPage?"os_compute_api:servers:index:get_all_tenants":"os_compute_api:servers:index"}get endpoint(){return(0,f.masakariEndpoint)()}get checkEndpoint(){return!0}get name(){return t("segments")}get defaultSortKey(){return"updated_at"}get actionConfigs(){return p.default}get searchFilters(){return[{label:t("Recovery Method"),name:"recovery_method"},{label:t("Service Type"),name:"service_type"},...this.isAdminPage?[{label:t("Project Name"),name:"project_name"}]:[]]}get rowKey(){return"uuid"}}a.Segments=m;a.default=(0,u.inject)("rootStore")((0,u.observer)(m))},614617:(e,t,a)=>{var r=a(633950),n=a(548924);r(t,"__esModule",{value:!0}),t.default=t.HostStore=void 0;var l,i,o=n(a(89195)),s=n(a(424836)),u=n(a(532462)),d=n(a(810732)),c=n(a(601839)),f=n(a(337187)),p=(n(a(877879)),n(a(155041)),n(a(533301))),m=n(a(381891)),h=n(a(892621)),v=a(127567),g=new(t.HostStore=(l=class extends m.default{constructor(){super(...arguments),(0,f.default)(this,"delete",i,this)}get client(){return h.default.masakari.segments.hosts}get segmentClient(){return h.default.masakari.segments}get isSubResource(){return!0}detailFetchByClient(e){return this.client.show(e.id,e.uuid)}get paramsFunc(){return e=>{var{id:t}=e;return{segment_id:t}}}listFetchByClient(e){var t=this;return(0,c.default)((function*(){var a=[];return e.segment_id?yield t.client.list(e.segment_id).then((e=>{var t;(0,o.default)(t=e.hosts).call(t,(e=>a.push(e)))})):yield t.segmentClient.list().then(function(){var e=(0,c.default)((function*(e){var r,n=(0,o.default)(r=e.segments).call(r,(e=>t.client.list(e.uuid).then((e=>e.hosts))));yield s.default.all(n).then((e=>{(0,u.default)(e).call(e,(e=>{(0,u.default)(e).call(e,(e=>{a.push(e)}))}))}))}));return function(t){return e.apply(this,arguments)}}()),{hosts:a}}))()}create(e,t){var a=this;return(0,c.default)((function*(){return a.client.create(e,t)}))()}update(e,t,a){return this.submitting(this.client.update(e,t,a))}},(0,p.default)(l.prototype,"create",[v.action],(0,d.default)(l.prototype,"create"),l.prototype),i=(0,p.default)(l.prototype,"delete",[v.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var{segment_id:t,host_id:a}=e;return this.submitting(this.client.delete(t,a))}}}),(0,p.default)(l.prototype,"update",[v.action],(0,d.default)(l.prototype,"update"),l.prototype),l));t.default=g},687432:(e,t,a)=>{var r=a(633950),n=a(548924);r(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(841521)),i=n(a(52857)),o=n(a(731087)),s=n(a(908771)),u={rowActions:{firstAction:i.default,moreActions:[{action:s.default},{action:o.default}]},batchActions:[o.default],primaryActions:[l.default]};t.default=u},731087:(e,a,r)=>{var n=r(633950),l=r(548924);n(a,"__esModule",{value:!0}),a.default=void 0;var i=l(r(877879)),o=r(860615),s=l(r(995786));class u extends o.ConfirmAction{constructor(){super(...arguments),(0,i.default)(this,"policy","os_compute_api:os-deferred-delete:force"),(0,i.default)(this,"allowedCheckFunction",(()=>!0)),(0,i.default)(this,"confirmContext",(e=>{var a=this.getName(e);return t("Are you sure to {action} (Segment: {name})?",{action:this.actionNameDisplay||this.title,name:a})})),(0,i.default)(this,"onSubmit",(e=>{var{uuid:t}=e||this.item,a=t;return s.default.delete({id:a})}))}get id(){return"delete"}get title(){return t("Delete")}get actionName(){return t("delete segments")}get isDanger(){return!0}get isAsyncAction(){return!0}}a.default=u},739409:(e,a,r)=>{var n=r(818565),l=r(213696),i=r(303787),o=r(810732),s=r(532462),u=r(110819),d=r(722338),c=r(633950),f=r(548924);c(a,"__esModule",{value:!0}),a.default=a.StepHost=void 0;var p=f(r(424836)),m=f(r(532462)),h=f(r(708192)),v=f(r(89195));r(244771);var g=f(r(144313));r(877185);var _=f(r(235903)),y=f(r(601839)),b=f(r(877879)),S=f(r(823872)),x=r(87067),I=f(r(978711)),C=f(r(614617)),k=f(r(470805));r(877800);function H(e,t){var a=n(e);if(l){var r=l(e);t&&(r=i(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}class D extends I.default{constructor(){super(...arguments),(0,b.default)(this,"allowed",(()=>p.default.resolve()))}init(){this.store=C.default,this.state=function(e){for(var t=1;t<arguments.length;t++){var a,r,n=null!=arguments[t]?arguments[t]:{};t%2?s(a=H(Object(n),!0)).call(a,(function(t){(0,b.default)(e,t,n[t])})):u?d(e,u(n)):s(r=H(Object(n))).call(r,(function(t){c(e,t,o(n,t))}))}return e}({host:[],hostLoading:!0},this.state),this.getHostList()}get title(){return"StepHost"}get name(){return"StepHost"}get isStep(){return!0}getHostList(){var e=this;return(0,y.default)((function*(){var t,a=yield k.default.fetchList({binary:"nova-compute"}),r=yield C.default.fetchList(),n=!1;r.length<1?e.setState({host:a}):(0,m.default)(a).call(a,(t=>{for(var a=0;a<r.length;a++)r[a].name===t.host&&(n=!0);n||e.setState({host:[...e.state.host,t]}),n=!1}));var l=(0,h.default)((0,v.default)(t=e.state.host).call(t,(e=>[e.id,e])));e.setState({hostMap:l,hostLoading:!1})}))()}get getHostName(){var e;return(0,v.default)(e=this.state.host||[]).call(e,(e=>({value:e.host,label:e.host})))}get formItems(){var e=[{title:t("Name"),dataIndex:"host"},{title:t("Zone"),dataIndex:"zone"},{title:t("Updated"),dataIndex:"updated_at",valueRender:"toLocalTime"},{name:"reserved",title:t("Reserved"),dataIndex:"reserved",required:!0,render:(e,t)=>S.default.createElement(_.default,{checked:e,onChange:e=>{this.setState((a=>{var r=a.hostMap;return r[t.id].reserved=e,{hostMap:r}}))}})},{name:"type",title:t("Type"),dataIndex:"type",required:!0,render:(e,t)=>S.default.createElement(g.default,{required:!0,defaultValue:e,onChange:e=>{var{value:a}=e.target;this.setState((e=>{var r=e.hostMap;return r[t.id].type=a,{hostMap:r}}))}})},{name:"control_attributes",title:t("Control Attributes"),dataIndex:"control_attributes",render:(e,t)=>S.default.createElement(g.default,{defaultValue:e,required:!0,onChange:e=>{var{value:a}=e.target;this.setState((e=>{var r=e.hostMap;return r[t.id].control_attributes=a,{hostMap:r}}))}})},{name:"on_maintenance",title:t("On Maintenance"),dataIndex:"on_maintenance",render:(e,t)=>S.default.createElement(_.default,{checked:e,onChange:e=>{this.setState((a=>{var r=a.hostMap;return r[t.id].on_maintenance=e,{hostMap:r}}))}})}];return[{name:"name",label:t("Host Name"),type:"select-table",required:!0,data:this.state.host,isMulti:!0,onRow:()=>{},columns:e,isLoading:this.state.hostLoading,filterParams:[{label:t("Name"),name:"host"},{label:t("Zone"),name:"zone"}]}]}}a.StepHost=D;a.default=(0,x.inject)("rootStore")((0,x.observer)(D))},791142:(e,a,r)=>{var n=r(633950),l=r(548924);n(a,"__esModule",{value:!0}),a.default=a.BaseDetail=void 0;var i=l(r(742181)),o=r(87067);class s extends i.default{get leftCards(){return[this.baseInfoCard]}get baseInfoCard(){var e=[{label:t("Recovery Method"),dataIndex:"recovery_method"},{label:t("Service Type"),dataIndex:"service_type"},{label:t("Enabled"),dataIndex:"enabled",valueRender:"yesNo"},{label:t("Created At"),dataIndex:"created_at",valueRender:"toLocalTime"},{label:t("Updated At"),dataIndex:"updated_at",valueRender:"toLocalTime"}];return{title:t("Capsule Type"),options:e}}}a.BaseDetail=s;a.default=(0,o.inject)("rootStore")((0,o.observer)(s))},807042:(e,a,r)=>{var n=r(471742),l=r(633950),i=r(810732),o=r(548924);l(a,"__esModule",{value:!0}),a.default=a.Notifications=void 0;var s=o(r(89195)),u=o(r(818565)),d=o(r(877879)),c=o(r(823872)),f=r(87067),p=o(r(654017)),m=function(e,t){if("function"==typeof n)var a=new n,r=new n;return function(e,t){if(!t&&e&&e.__esModule)return e;var n,o,s={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return s;if(n=t?r:a){if(n.has(e))return n.get(e);n.set(e,s)}for(var u in e)"default"!==u&&{}.hasOwnProperty.call(e,u)&&((o=(n=l)&&i(e,u))&&(o.get||o.set)?n(s,u,o):s[u]=e[u]);return s}(e,t)}(r(193466)),h=r(403002),v=r(365468);class g extends p.default{constructor(){super(...arguments),(0,d.default)(this,"getColumns",(()=>[{title:t("UUID"),dataIndex:"notification_uuid",render:e=>{var t=this.getRoutePath("masakariNotificationDetail",{id:e});return c.default.createElement(h.Link,{to:t},e)},isHideable:!0},{title:t("Host"),dataIndex:"source_host_uuid",isHideable:!0},{title:t("Type"),dataIndex:"type",isHideable:!0},{title:t("Status"),dataIndex:"status",isHideable:!0},{title:t("Payload"),dataIndex:"payload",isHideable:!0,render:e=>{var t;return(0,s.default)(t=(0,u.default)(e)).call(t,(t=>c.default.createElement("div",{key:t},t,": ",e[t])))}}]))}init(){this.store=m.default,this.downloadStore=new m.NotificationStore}get policy(){return this.isAdminPage?"os_compute_api:servers:index:get_all_tenants":"os_compute_api:servers:index"}get name(){return t("segments")}get defaultSortKey(){return"updated_at"}get endpoint(){return(0,v.masakariEndpoint)()}get checkEndpoint(){return!0}get searchFilters(){return[{label:t("Host"),name:"source_host_uuid"},{label:t("UUID"),name:"notification_uuid"}]}}a.Notifications=g;a.default=(0,f.inject)("rootStore")((0,f.observer)(g))},840139:(e,t,a)=>{var r=a(633950),n=a(548924);r(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(923336)),i=n(a(973554)),o={rowActions:{firstAction:l.default,moreActions:[{action:i.default}]},batchActions:[i.default]};t.default=o},841521:(e,a,r)=>{var n=r(818565),l=r(213696),i=r(303787),o=r(810732),s=r(532462),u=r(110819),d=r(722338),c=r(633950),f=r(548924);c(a,"__esModule",{value:!0}),a.default=a.StepCreate=void 0,r(573969);var p=f(r(38959)),m=f(r(549849)),h=f(r(424836)),v=f(r(532462)),g=f(r(819989)),_=f(r(68985));r(46630);var y=f(r(308380)),b=f(r(877879)),S=r(87067),x=r(860615),I=f(r(995786)),C=f(r(823872)),k=(r(877800),r(127567)),H=(r(384472),f(r(940740))),D=f(r(614617)),M=f(r(31170)),w=f(r(739409)),N=f(r(552584)),A=["binary","forced_down","host","id","state","status","updated_at","zone"];function R(e,t){var a=n(e);if(l){var r=l(e);t&&(r=i(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a,r,n=null!=arguments[t]?arguments[t]:{};t%2?s(a=R(Object(n),!0)).call(a,(function(t){(0,b.default)(e,t,n[t])})):u?d(e,u(n)):s(r=R(Object(n))).call(r,(function(t){c(e,t,o(n,t))}))}return e}class U extends x.StepAction{constructor(){super(...arguments),(0,b.default)(this,"onClickCancel",(()=>{0!==this.state.current?y.default.confirm({title:"Confirm",icon:C.default.createElement(_.default,{className:H.default.warn}),content:"Segment will be deleted. Are you sure want to cancel this created segment?",okText:"Confirm",cancelText:"Cancel",loading:!0,onOk:()=>I.default.delete({id:this.state.extra.createdSegmentId}).finally((()=>this.routing.push(this.listUrl)))}):this.routing.push(this.listUrl)})),(0,b.default)(this,"onSubmit",(e=>{var t,{name:a}=e;return h.default.resolve((0,v.default)(t=a.selectedRows).call(t,(e=>{var{binary:t,forced_down:a,host:r,id:n,state:l,status:i,updated_at:o,zone:s}=e,u=(0,m.default)(e,A);this.store.create(this.state.extra.createdSegmentId,{host:j({name:r},u)})})))}))}init(){this.store=D.default,this.state=j({btnIsLoading:!1},this.state)}static allowed(){return h.default.resolve(!0)}get name(){return t("Create Segment")}get listUrl(){return this.getRoutePath("masakariSegments")}get hasConfirmStep(){return!1}next(){this.currentRef.current.wrappedInstance.checkFormInput((e=>{if(this.updateData(e),0===this.state.current){this.setState({btnIsLoading:!0});var{segment_name:t,recovery_method:a,service_type:r,description:n}=this.state.data;I.default.create({segment:{name:t,recovery_method:a,service_type:r,description:n}}).then((e=>{this.setState({extra:(0,k.toJS)({createdSegmentId:e.segment.uuid})},(()=>{this.setState((e=>({current:e.current+1})))}))}),(e=>{this.responseError=e;var{response:{data:t}={}}=e;M.default.errorWithDetail(t,this.errorText)})).finally((()=>{this.setState({btnIsLoading:!1})}))}}),(()=>this.setState({btnIsLoading:!1})))}getNextBtn(){var e,{current:a}=this.state;if(a>=this.steps.length-1)return null;var{title:r}=this.steps[a+1];return C.default.createElement(p.default,{type:"primary",onClick:()=>this.next(),loading:this.state.btnIsLoading},(0,g.default)(e="".concat(t("Next"),": ")).call(e,r))}getPrevBtn(){var e,{current:a}=this.state;if(0===a)return null;var r=this.steps[a-1].title;return C.default.createElement(p.default,{style:{margin:"0 8px"},onClick:()=>this.prev()},(0,g.default)(e="".concat(t("Previous"),": ")).call(e,r))}prev(){this.currentRef.current.wrappedInstance.checkFormInput(this.updateDataOnPrev,this.updateDataOnPrev),I.default.delete({id:this.state.extra.createdSegmentId})}get steps(){return[{title:t("Create Segment"),component:N.default},{title:t("Add Host"),component:w.default}]}}a.StepCreate=U,(0,b.default)(U,"id","instance-ha-create"),(0,b.default)(U,"title",t("Create Segment")),(0,b.default)(U,"path","/ha/segments-admin/create-step-admin"),(0,b.default)(U,"policy","get_images");a.default=(0,S.inject)("rootStore")((0,S.observer)(U))},908771:(e,a,r)=>{var n=r(818565),l=r(213696),i=r(303787),o=r(810732),s=r(532462),u=r(110819),d=r(722338),c=r(633950),f=r(548924);c(a,"__esModule",{value:!0}),a.default=a.AddHost=void 0;var p=f(r(532462)),m=f(r(89195)),h=f(r(424836)),v=f(r(601839)),g=f(r(549849)),_=f(r(877879)),y=r(87067),b=r(860615),S=f(r(614617)),x=f(r(470805)),I=["segment_name"];function C(e,t){var a=n(e);if(l){var r=l(e);t&&(r=i(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a,r,n=null!=arguments[t]?arguments[t]:{};t%2?s(a=C(Object(n),!0)).call(a,(function(t){(0,_.default)(e,t,n[t])})):u?d(e,u(n)):s(r=C(Object(n))).call(r,(function(t){c(e,t,o(n,t))}))}return e}class H extends b.ModalAction{constructor(){super(...arguments),(0,_.default)(this,"onSubmit",(e=>{var{segment_name:t}=e,a=(0,g.default)(e,I);return this.store.create(this.item.uuid,{host:k({},a)})}))}init(){this.store=S.default,this.state={host:[]},this.getHostList()}get name(){return t("Add Host")}getHostList(){var e=this;return(0,v.default)((function*(){var t=yield x.default.fetchList({binary:"nova-compute"}),a=yield S.default.fetchList(),r=!1;a.length<1?e.setState({host:t}):(0,p.default)(t).call(t,(t=>{for(var n=0;n<a.length;n++)a[n].name===t.host&&(r=!0);r||e.setState({host:[...e.state.host,t]}),r=!1}))}))()}get getHostName(){var e;return(0,m.default)(e=this.state.host||[]).call(e,(e=>({value:e.host,label:e.host})))}get defaultValue(){return{segment_name:this.item.name,reserved:!1,on_maintenance:!1}}get formItems(){return[{name:"segment_name",label:t("Segment Name"),type:"input",disabled:!0},{name:"name",label:t("Host Name"),type:"select",options:this.getHostName,required:!0},{name:"reserved",label:t("Reserved"),type:"switch",checkedText:"",uncheckedText:""},{name:"type",label:t("Type"),type:"input",required:!0},{name:"control_attributes",label:t("Control Attributes"),type:"input",required:!0},{name:"on_maintenance",label:t("On Maintenance"),type:"switch",checkedText:"",uncheckedText:""}]}}a.AddHost=H,(0,_.default)(H,"id","AddHost"),(0,_.default)(H,"title",t("Add Host")),(0,_.default)(H,"policy","baremetal:port:create"),(0,_.default)(H,"allowed",(()=>h.default.resolve(!0)));a.default=(0,y.inject)("rootStore")((0,y.observer)(H))},923336:(e,a,r)=>{var n=r(818565),l=r(213696),i=r(303787),o=r(810732),s=r(532462),u=r(110819),d=r(722338),c=r(633950),f=r(548924);c(a,"__esModule",{value:!0}),a.default=a.Update=void 0;var p=f(r(424836)),m=f(r(877879)),h=r(87067),v=r(860615),g=f(r(614617));function _(e,t){var a=n(e);if(l){var r=l(e);t&&(r=i(r).call(r,(function(t){return o(e,t).enumerable}))),a.push.apply(a,r)}return a}class y extends v.ModalAction{constructor(){super(...arguments),(0,m.default)(this,"onSubmit",(e=>this.store.update(this.item.failover_segment_id,this.item.uuid,{host:e})))}init(){this.store=g.default}get name(){return t("Update")}get defaultValue(){return function(e){for(var t=1;t<arguments.length;t++){var a,r,n=null!=arguments[t]?arguments[t]:{};t%2?s(a=_(Object(n),!0)).call(a,(function(t){(0,m.default)(e,t,n[t])})):u?d(e,u(n)):s(r=_(Object(n))).call(r,(function(t){c(e,t,o(n,t))}))}return e}({},this.item)}get formItems(){return[{name:"name",label:t("Host Name"),type:"input",disabled:!0,required:!0},{name:"reserved",label:t("Reserved"),type:"switch",checkedText:"",uncheckedText:""},{name:"type",label:t("Type"),type:"input",required:!0},{name:"control_attributes",label:t("Control Attribute"),type:"input",required:!0},{name:"on_maintenance",label:t("On Maintenance"),type:"switch",checkedText:"",uncheckedText:""}]}}a.Update=y,(0,m.default)(y,"id","UpdateHost"),(0,m.default)(y,"title",t("Update")),(0,m.default)(y,"policy","baremetal:port:Update"),(0,m.default)(y,"allowed",(()=>p.default.resolve(!0)));a.default=(0,h.inject)("rootStore")((0,h.observer)(y))},962421:(e,t,a)=>{var r=a(633950),n=a(548924);r(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(765512)),i=n(a(12775));t.default=e=>(0,l.default)(i.default,e)},973554:(e,a,r)=>{var n=r(633950),l=r(548924);n(a,"__esModule",{value:!0}),a.default=void 0;var i=l(r(877879)),o=r(860615),s=l(r(614617));class u extends o.ConfirmAction{constructor(){super(...arguments),(0,i.default)(this,"policy","instance:delete"),(0,i.default)(this,"allowedCheckFunction",(()=>!0)),(0,i.default)(this,"confirmContext",(e=>{var a=this.getName(e);return t("Are you sure to {action} (Host: {name})?",{action:this.actionNameDisplay||this.title,name:a})})),(0,i.default)(this,"onSubmit",(e=>{var{uuid:t,failover_segment_id:a}=e||this.item;return s.default.delete({segment_id:a,host_id:t})}))}get id(){return"delete"}get title(){return t("Delete")}get actionName(){return t("delete host")}get isDanger(){return!0}get isAsyncAction(){return!0}}a.default=u},995786:(e,t,a)=>{var r=a(633950),n=a(548924);r(t,"__esModule",{value:!0}),t.default=t.SegmentStore=void 0;var l,i=n(a(810732)),o=n(a(601839)),s=n(a(533301)),u=n(a(381891)),d=n(a(892621)),c=a(127567),f=new(t.SegmentStore=(l=class extends u.default{get client(){return d.default.masakari.segments}create(e){var t=this;return(0,o.default)((function*(){return t.client.create(e)}))()}delete(e){var t=this;return(0,o.default)((function*(){var{id:a}=e;return t.client.delete(a)}))()}update(e,t){return this.submitting(this.client.update(e,t))}},(0,s.default)(l.prototype,"create",[c.action],(0,i.default)(l.prototype,"create"),l.prototype),(0,s.default)(l.prototype,"delete",[c.action],(0,i.default)(l.prototype,"delete"),l.prototype),(0,s.default)(l.prototype,"update",[c.action],(0,i.default)(l.prototype,"update"),l.prototype),l));t.default=f}}]);